{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.8", "generated_at": "2024-04-01T04:06:26.063146Z", "invocation_id": "d876a1a9-a410-4d28-b6d0-34b3d656d20e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-01T04:06:05.253699Z", "completed_at": "2024-04-01T04:06:05.259590Z"}, {"name": "execute", "started_at": "2024-04-01T04:06:05.260244Z", "completed_at": "2024-04-01T04:06:24.912424Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 19.966233015060425, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw", "compiled": true, "compiled_code": "\nwith source as (\n\n    SELECT\n    ID          ::varchar   as record_id,\n    DATE        ::varchar   as reading_date,\n    ELEMENT     ::varchar   as reading_type,\n    DATA_VALUE  ::numeric   as reading_value,\n    M_FLAG      ::varchar   as measurement_flag,\n    Q_FLAG      ::varchar   as quality_flag,\n    S_FLAG      ::varchar   as source_flag,\n    OBS_TIME    ::varchar   as obs_recorded_at\n\n    from \"dev_database\".\"dev_sode\".\"noaa_ghcn_2022\"\n\n\n    UNION ALL\n\n    SELECT\n\n    ID          ::varchar   as record_id,\n    DATE        ::varchar   as reading_date,\n    ELEMENT     ::varchar   as reading_type,\n    DATA_VALUE  ::numeric   as reading_value,\n    M_FLAG      ::varchar   as measurement_flag,\n    Q_FLAG      ::varchar   as quality_flag,\n    S_FLAG      ::varchar   as source_flag,\n    OBS_TIME    ::varchar   as obs_recorded_at\n\n    from \"dev_database\".\"dev_sode\".\"noaa_ghcn_2023\"\n)\n\nselect * from source", "relation_name": "\"dev_database\".\"dev_sode\".\"stg_daily_climate_parameters_vertical_raw\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-01T04:06:25.225553Z", "completed_at": "2024-04-01T04:06:25.228215Z"}, {"name": "execute", "started_at": "2024-04-01T04:06:25.228788Z", "completed_at": "2024-04-01T04:06:25.257731Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10737729072570801, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.climate_works_dbt.stg_daily_climate_parameters", "compiled": true, "compiled_code": "with source as\n    (\n\n        select\n            record_id ::varchar as record_id,\n            array_slice(reading_date,1,4)::INTEGER as year,\n            array_slice(reading_date, 5,6) ::INTEGER as month,\n            array_slice(reading_date, 7,8) ::INTEGER as day,\n            reading_type,\n            reading_value,\n            measurement_flag,\n            quality_flag,\n            source_flag,\n            obs_recorded_at\n\n    from \"dev_database\".\"dev_sode\".\"stg_daily_climate_parameters_vertical_raw\"\n\n),\n\nfinal as\n(\n\n  select\n        record_id,\n        make_date(year,month,day)::timestamp as reading_date,\n        reading_type,\n        reading_value,\n        measurement_flag,\n        quality_flag,\n        source_flag,\n        obs_recorded_at\n\n     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'\n)\n\nselect *\nfrom final", "relation_name": "\"dev_database\".\"dev_sode\".\"stg_daily_climate_parameters\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-01T04:06:25.336452Z", "completed_at": "2024-04-01T04:06:25.342246Z"}, {"name": "execute", "started_at": "2024-04-01T04:06:25.343115Z", "completed_at": "2024-04-01T04:06:25.361434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10006308555603027, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.climate_works_dbt.int_daily_climate_params_pivoted", "compiled": true, "compiled_code": "\nwith source as (\n\n    SELECT\n      record_id,\n      reading_date,\n      reading_type,\n      reading_value,\n      source_flag,\n      measurement_flag\n\n\n    from \"dev_database\".\"dev_sode\".\"stg_daily_climate_parameters\"\n),\n\npivoted as (\n  select \n    *\n\n    from (\n      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag\n    )\n)\n\n\n\nselect \n    \n    reading_date,\n    source_flag,\n    measurement_flag,\n    PRCP/10 ::DECIMAL as precipitation_mm,\n    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,\n    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,\n    SNWD    ::DECIMAL as snow_depth_mm,\n    SNOW    ::DECIMAL as snow_fall_mm\n\n    \n     from pivoted", "relation_name": "\"dev_database\".\"dev_sode\".\"int_daily_climate_params_pivoted\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-01T04:06:25.438597Z", "completed_at": "2024-04-01T04:06:25.441387Z"}, {"name": "execute", "started_at": "2024-04-01T04:06:25.441998Z", "completed_at": "2024-04-01T04:06:25.927311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6142230033874512, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.climate_works_dbt.fact_daily_climate_parameters", "compiled": true, "compiled_code": "\n\nwith source as (\n    select\n    reading_date,\n    source_flag,\n    measurement_flag,\n    precipitation_mm,\n    daily_max_temperature_celsius,\n    daily_min_temperature_celsius,\n    snow_fall_mm,\n    snow_depth_mm\n\n    from \"dev_database\".\"dev_sode\".\"int_daily_climate_params_pivoted\"\n    order by reading_date desc\n)\n\nselect * from source", "relation_name": "\"dev_database\".\"dev_sode\".\"fact_daily_climate_parameters\""}], "elapsed_time": 20.88223910331726, "args": {"strict_mode": false, "log_file_max_bytes": 10485760, "version_check": true, "profiles_dir": "/Users/raajassode/dev/climate_works_dbt", "printer_width": 80, "introspect": true, "quiet": false, "macro_debugging": false, "project_dir": "/Users/raajassode/dev/climate_works_dbt", "use_colors": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "which": "run", "vars": {}, "log_level_file": "debug", "favor_state": false, "show_resource_report": false, "select": ["+stg_daily_climate_parameters_vertical_raw+"], "use_colors_file": true, "partial_parse": true, "invocation_command": "dbt run --select +stg_daily_climate_parameters_vertical_raw+", "send_anonymous_usage_stats": true, "partial_parse_file_diff": true, "static_parser": true, "log_path": "/Users/raajassode/dev/climate_works_dbt/logs", "enable_legacy_logger": false, "indirect_selection": "eager", "cache_selected_only": false, "print": true, "populate_cache": true, "log_format_file": "debug", "log_level": "info", "log_format": "default", "write_json": true}}