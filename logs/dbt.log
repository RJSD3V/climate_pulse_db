[0m08:12:49.524522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125cbac0>]}


============================== 08:12:49.527055 | 2444d2ac-1d36-4b19-8b35-63a2df7dd840 ==============================
[0m08:12:49.527055 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:12:49.527389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m08:12:49.527765 [info ] [MainThread]: dbt version: 1.7.6
[0m08:12:49.527943 [info ] [MainThread]: python version: 3.10.13
[0m08:12:49.528110 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.10/bin/python3.10
[0m08:12:49.528267 [info ] [MainThread]: os info: macOS-14.1.2-arm64-arm-64bit
[0m08:12:50.249836 [info ] [MainThread]: Using profiles dir at /Users/raajassode/dev/climate_works_dbt
[0m08:12:50.250215 [info ] [MainThread]: Using profiles.yml file at /Users/raajassode/dev/climate_works_dbt/profiles.yml
[0m08:12:50.250448 [info ] [MainThread]: Using dbt_project.yml file at /Users/raajassode/dev/climate_works_dbt/dbt_project.yml
[0m08:12:50.251300 [info ] [MainThread]: adapter type: duckdb
[0m08:12:50.251490 [info ] [MainThread]: adapter version: 1.7.1
[0m08:12:50.319202 [info ] [MainThread]: Configuration:
[0m08:12:50.319549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:12:50.319730 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:12:50.319903 [info ] [MainThread]: Required dependencies:
[0m08:12:50.320151 [debug] [MainThread]: Executing "git --help"
[0m08:12:50.329068 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:12:50.329767 [debug] [MainThread]: STDERR: "b''"
[0m08:12:50.330041 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:12:50.330259 [info ] [MainThread]: Connection:
[0m08:12:50.330499 [info ] [MainThread]:   database: dev_database
[0m08:12:50.330668 [info ] [MainThread]:   schema: dev_sode
[0m08:12:50.330830 [info ] [MainThread]:   path: ./dev_database.duckdb
[0m08:12:50.330986 [info ] [MainThread]:   config_options: None
[0m08:12:50.331143 [info ] [MainThread]:   extensions: None
[0m08:12:50.331304 [info ] [MainThread]:   settings: None
[0m08:12:50.331456 [info ] [MainThread]:   external_root: .
[0m08:12:50.331851 [info ] [MainThread]:   use_credential_provider: None
[0m08:12:50.332083 [info ] [MainThread]:   attach: None
[0m08:12:50.332254 [info ] [MainThread]:   filesystems: None
[0m08:12:50.332412 [info ] [MainThread]:   remote: None
[0m08:12:50.332565 [info ] [MainThread]:   plugins: None
[0m08:12:50.332712 [info ] [MainThread]:   disable_transactions: False
[0m08:12:50.333058 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:12:50.337903 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:12:50.338522 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:12:50.338723 [debug] [MainThread]: On debug: select 1 as id
[0m08:12:50.338901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:50.346850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:12:50.347765 [debug] [MainThread]: On debug: Close
[0m08:12:50.349817 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:12:50.350178 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:12:50.369399 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.888698, "process_user_time": 1.260064, "process_kernel_time": 0.153064, "process_mem_max_rss": "132268032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:12:50.370006 [debug] [MainThread]: Command `dbt debug` succeeded at 08:12:50.369915 after 0.89 seconds
[0m08:12:50.370265 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:12:50.370513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112523910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11255df90>]}
[0m08:12:50.370789 [debug] [MainThread]: Flushing usage events
[0m08:13:54.345733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f86bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513bc10>]}


============================== 08:13:54.347660 | 58d4b08e-991a-4424-9ef6-29bec7ec2fd0 ==============================
[0m08:13:54.347660 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:13:54.347999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:13:54.594740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58d4b08e-991a-4424-9ef6-29bec7ec2fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bac50>]}
[0m08:13:54.668589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58d4b08e-991a-4424-9ef6-29bec7ec2fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105106800>]}
[0m08:13:54.669067 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:13:54.679166 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m08:13:54.694208 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:13:54.694600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '58d4b08e-991a-4424-9ef6-29bec7ec2fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527d750>]}
[0m08:13:55.322376 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/sources.yml @ sources: {'name': 'noaa_ghcn', 'database': 'dev_database', 'schema': 'dev_sode', 'tables': ['noaa_ghcn_2022', 'noaa_ghcn_2023']} - at path ['tables'][0]: 'noaa_ghcn_2022' is not of type 'object'
[0m08:13:55.323546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0162785, "process_user_time": 1.895198, "process_kernel_time": 0.115778, "process_mem_max_rss": "135806976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:13:55.323892 [debug] [MainThread]: Command `dbt run` failed at 08:13:55.323821 after 1.02 seconds
[0m08:13:55.324112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f86bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dd870>]}
[0m08:13:55.324327 [debug] [MainThread]: Flushing usage events
[0m08:16:38.167031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebbd30>]}


============================== 08:16:38.168945 | fab0cfee-a5ac-44ed-81b7-5bba4ee14f19 ==============================
[0m08:16:38.168945 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:16:38.169269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:16:38.351401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f33430>]}
[0m08:16:38.425249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d0070>]}
[0m08:16:38.425740 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:16:38.435805 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m08:16:38.450905 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m08:16:38.451305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffbaf0>]}
[0m08:16:39.214923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dbd00>]}
[0m08:16:39.221729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c69b0>]}
[0m08:16:39.222031 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:16:39.222245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bcdf0>]}
[0m08:16:39.222942 [info ] [MainThread]: 
[0m08:16:39.223374 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:16:39.224071 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m08:16:39.231219 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m08:16:39.231556 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m08:16:39.231750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:39.239507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.240602 [debug] [ThreadPool]: On list_dev_database: Close
[0m08:16:39.242910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m08:16:39.243394 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m08:16:39.247126 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:16:39.247348 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m08:16:39.247520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:39.253794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.254739 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:16:39.254969 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m08:16:39.255186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.255339 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:16:39.255511 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m08:16:39.255763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.256172 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:16:39.256338 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:16:39.256487 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:16:39.256676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.256833 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m08:16:39.260542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m08:16:39.264262 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:16:39.264798 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m08:16:39.265006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:39.271085 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.271397 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:16:39.271603 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m08:16:39.282724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:16:39.287242 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m08:16:39.288104 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m08:16:39.288282 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m08:16:39.299044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107759390>]}
[0m08:16:39.299315 [debug] [MainThread]: Using duckdb connection "master"
[0m08:16:39.299475 [debug] [MainThread]: On master: BEGIN
[0m08:16:39.299632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:16:39.305019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:16:39.305266 [debug] [MainThread]: On master: COMMIT
[0m08:16:39.305430 [debug] [MainThread]: Using duckdb connection "master"
[0m08:16:39.305583 [debug] [MainThread]: On master: COMMIT
[0m08:16:39.305759 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:16:39.305912 [debug] [MainThread]: On master: Close
[0m08:16:39.307440 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m08:16:39.307634 [info ] [MainThread]: 
[0m08:16:39.308885 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:16:39.309183 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters_vertical ..... [RUN]
[0m08:16:39.309578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical)
[0m08:16:39.309799 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:16:39.311925 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:16:39.312568 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (compile): 08:16:39.309926 => 08:16:39.312425
[0m08:16:39.312792 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:16:39.332531 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:16:39.333282 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:16:39.333546 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: BEGIN
[0m08:16:39.333775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:39.339523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:16:39.339840 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:16:39.340068 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" as (
    with source as (

    SELECT
    ID,
    DATE,
    ELEMENT,
    DATA_VALUE,
    M_FLAG,
    Q_FLAG,
    S_FLAG,
    OBS_TIME

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT
    
    ID,
    DATE,
    ELEMENT,
    DATA_VALUE,
    M_FLAG,
    Q_FLAG,
    S_FLAG,
    OBS_TIME

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m08:16:39.350994 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (execute): 08:16:39.312916 => 08:16:39.350769
[0m08:16:39.351313 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: ROLLBACK
[0m08:16:39.354653 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.stg_daily_climate_parameters_vertical'
[0m08:16:39.354914 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: Close
[0m08:16:39.357325 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters_vertical (models/staging/stg_daily_climate_parameters_vertical.sql)
  Catalog Error: Table with name noaa_ghcn_2022 does not exist!
  Did you mean "1820"?
[0m08:16:39.357619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab0cfee-a5ac-44ed-81b7-5bba4ee14f19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775a710>]}
[0m08:16:39.357989 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev_sode.stg_daily_climate_parameters_vertical  [[31mERROR[0m in 0.05s]
[0m08:16:39.358338 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:16:39.359080 [debug] [MainThread]: Using duckdb connection "master"
[0m08:16:39.359253 [debug] [MainThread]: On master: BEGIN
[0m08:16:39.359404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:16:39.365328 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:16:39.365610 [debug] [MainThread]: On master: COMMIT
[0m08:16:39.365780 [debug] [MainThread]: Using duckdb connection "master"
[0m08:16:39.365955 [debug] [MainThread]: On master: COMMIT
[0m08:16:39.366152 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:16:39.366326 [debug] [MainThread]: On master: Close
[0m08:16:39.368145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:39.368408 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical' was properly closed.
[0m08:16:39.368623 [info ] [MainThread]: 
[0m08:16:39.368822 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:16:39.369190 [debug] [MainThread]: Command end result
[0m08:16:39.374287 [info ] [MainThread]: 
[0m08:16:39.374579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:16:39.374760 [info ] [MainThread]: 
[0m08:16:39.374944 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters_vertical (models/staging/stg_daily_climate_parameters_vertical.sql)
  Catalog Error: Table with name noaa_ghcn_2022 does not exist!
  Did you mean "1820"?
[0m08:16:39.375131 [info ] [MainThread]: 
[0m08:16:39.375309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:16:39.376293 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2502042, "process_user_time": 2.178517, "process_kernel_time": 0.129203, "process_mem_max_rss": "187662336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:16:39.376673 [debug] [MainThread]: Command `dbt run` failed at 08:16:39.376605 after 1.25 seconds
[0m08:16:39.376901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107341e70>]}
[0m08:16:39.377127 [debug] [MainThread]: Flushing usage events
[0m08:36:45.353882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b778b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b77cd0>]}


============================== 08:36:45.356438 | 51a40bb2-1285-4bc0-b892-c25a755d0d29 ==============================
[0m08:36:45.356438 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:36:45.356781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'send_anonymous_usage_stats': 'True'}
[0m08:36:45.649174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b779d0>]}
[0m08:36:45.723502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecabc0>]}
[0m08:36:45.724951 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:36:45.735332 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m08:36:45.741422 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:36:45.741750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec8460>]}
[0m08:36:46.486590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e8640>]}
[0m08:36:46.492629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545dfc0>]}
[0m08:36:46.492910 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:36:46.493119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a40bb2-1285-4bc0-b892-c25a755d0d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef53c0>]}
[0m08:36:46.493779 [info ] [MainThread]: 
[0m08:36:46.494187 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:36:46.494744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m08:36:46.501184 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m08:36:46.501514 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m08:36:46.501691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:46.507377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:46.507602 [debug] [MainThread]: Connection 'list_dev_database' was properly closed.
[0m08:36:46.507777 [info ] [MainThread]: 
[0m08:36:46.507968 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m08:36:46.508251 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/raajassode/dev/climate_works_dbt/./dev_database.duckdb": Resource temporarily unavailable
[0m08:36:46.509700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1986603, "process_user_time": 2.022945, "process_kernel_time": 0.151799, "process_mem_max_rss": "142737408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:36:46.510061 [debug] [MainThread]: Command `dbt run` failed at 08:36:46.509985 after 1.20 seconds
[0m08:36:46.510287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef53c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733310>]}
[0m08:36:46.510515 [debug] [MainThread]: Flushing usage events
[0m08:37:12.866536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103842bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0bca0>]}


============================== 08:37:12.869121 | 92001b6a-12fa-4631-9983-43452ca1fa90 ==============================
[0m08:37:12.869121 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:37:12.869462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:37:13.087551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0b9d0>]}
[0m08:37:13.161292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb39d0>]}
[0m08:37:13.162267 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:37:13.172309 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m08:37:13.193798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:13.194077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:13.197854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f740d0>]}
[0m08:37:13.203169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e81ed0>]}
[0m08:37:13.203443 [info ] [MainThread]: Found 3 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:37:13.203654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e81ea0>]}
[0m08:37:13.204383 [info ] [MainThread]: 
[0m08:37:13.204794 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:37:13.205417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m08:37:13.212190 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m08:37:13.212511 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m08:37:13.212735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:13.227633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.229111 [debug] [ThreadPool]: On list_dev_database: Close
[0m08:37:13.231210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m08:37:13.231582 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m08:37:13.235193 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:37:13.235397 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m08:37:13.235569 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:13.241417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.242248 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:37:13.242426 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m08:37:13.242605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.242753 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:37:13.242906 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m08:37:13.243147 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.243534 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:37:13.243697 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:37:13.243848 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:37:13.244037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.244190 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m08:37:13.246959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m08:37:13.250009 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:37:13.250224 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m08:37:13.250414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:13.256311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.256566 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:37:13.256749 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m08:37:13.267481 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:37:13.271795 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m08:37:13.272430 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m08:37:13.272614 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m08:37:13.283536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faf8b0>]}
[0m08:37:13.283797 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:13.283955 [debug] [MainThread]: On master: BEGIN
[0m08:37:13.284104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:13.289901 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:37:13.290141 [debug] [MainThread]: On master: COMMIT
[0m08:37:13.290304 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:13.290460 [debug] [MainThread]: On master: COMMIT
[0m08:37:13.290638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:37:13.290794 [debug] [MainThread]: On master: Close
[0m08:37:13.292341 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m08:37:13.292573 [info ] [MainThread]: 
[0m08:37:13.293840 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:37:13.294118 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters_vertical ..... [RUN]
[0m08:37:13.294488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical)
[0m08:37:13.294695 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:37:13.296644 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.297372 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (compile): 08:37:13.294822 => 08:37:13.297223
[0m08:37:13.297615 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:37:13.317369 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.317996 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.318205 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: BEGIN
[0m08:37:13.318399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:13.324124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:37:13.324393 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.324617 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" as (
    with source as (

    SELECT
    ID,
    DATE,
    ELEMENT,
    DATA_VALUE,
    M_FLAG,
    Q_FLAG,
    S_FLAG,
    OBS_TIME

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT
    
    ID,
    DATE,
    ELEMENT,
    DATA_VALUE,
    M_FLAG,
    Q_FLAG,
    S_FLAG,
    OBS_TIME

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m08:37:13.325056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:37:13.328769 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.329010 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" rename to "stg_daily_climate_parameters_vertical"
[0m08:37:13.329338 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:37:13.336684 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m08:37:13.336907 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.337095 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m08:37:13.337529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:37:13.340069 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:37:13.340299 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_backup" cascade
[0m08:37:13.340567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:37:13.341352 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (execute): 08:37:13.297747 => 08:37:13.341224
[0m08:37:13.341589 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: Close
[0m08:37:13.380431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92001b6a-12fa-4631-9983-43452ca1fa90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fafa60>]}
[0m08:37:13.380907 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical  [[32mOK[0m in 0.09s]
[0m08:37:13.381248 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:37:13.382003 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:13.382194 [debug] [MainThread]: On master: BEGIN
[0m08:37:13.382353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:13.388618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:37:13.388925 [debug] [MainThread]: On master: COMMIT
[0m08:37:13.389094 [debug] [MainThread]: Using duckdb connection "master"
[0m08:37:13.389252 [debug] [MainThread]: On master: COMMIT
[0m08:37:13.389427 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:37:13.389583 [debug] [MainThread]: On master: Close
[0m08:37:13.391380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:13.391552 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical' was properly closed.
[0m08:37:13.391738 [info ] [MainThread]: 
[0m08:37:13.391926 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m08:37:13.392287 [debug] [MainThread]: Command end result
[0m08:37:13.397311 [info ] [MainThread]: 
[0m08:37:13.397652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:37:13.397858 [info ] [MainThread]: 
[0m08:37:13.398071 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:37:13.399678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5732792, "process_user_time": 1.464775, "process_kernel_time": 0.144968, "process_mem_max_rss": "170737664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:37:13.400101 [debug] [MainThread]: Command `dbt run` succeeded at 08:37:13.400034 after 0.57 seconds
[0m08:37:13.400332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103842bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb8d90>]}
[0m08:37:13.400567 [debug] [MainThread]: Flushing usage events
[0m08:44:03.548696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035aabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057738e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105773cd0>]}


============================== 08:44:03.551602 | dd9587fe-4ed6-4089-98ae-6b8414096b95 ==============================
[0m08:44:03.551602 [info ] [MainThread]: Running with dbt=1.7.6
[0m08:44:03.551948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:44:03.741817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105773a00>]}
[0m08:44:03.815654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058208b0>]}
[0m08:44:03.816604 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m08:44:03.825882 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m08:44:03.850269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:44:03.850807 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m08:44:03.851067 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m08:44:03.960800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e85780>]}
[0m08:44:03.966857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bea020>]}
[0m08:44:03.967153 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m08:44:03.967370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be9ff0>]}
[0m08:44:03.968107 [info ] [MainThread]: 
[0m08:44:03.968534 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:44:03.969104 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m08:44:03.976050 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m08:44:03.976402 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m08:44:03.976605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:03.984267 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:03.985433 [debug] [ThreadPool]: On list_dev_database: Close
[0m08:44:03.987872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m08:44:03.988322 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m08:44:04.026530 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:44:04.026860 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m08:44:04.027039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:04.033374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.034253 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:44:04.034480 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m08:44:04.034702 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.034862 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:44:04.035030 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m08:44:04.035236 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.035685 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:44:04.035874 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m08:44:04.036027 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m08:44:04.036220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.036380 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m08:44:04.039311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m08:44:04.042560 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:44:04.042751 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m08:44:04.042973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:44:04.048900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.049144 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m08:44:04.049325 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m08:44:04.060002 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m08:44:04.063910 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m08:44:04.064800 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m08:44:04.064979 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m08:44:04.075850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ecaf50>]}
[0m08:44:04.076149 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:04.076310 [debug] [MainThread]: On master: BEGIN
[0m08:44:04.076461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:04.082035 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:44:04.082277 [debug] [MainThread]: On master: COMMIT
[0m08:44:04.082438 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:04.082590 [debug] [MainThread]: On master: COMMIT
[0m08:44:04.082770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:44:04.082928 [debug] [MainThread]: On master: Close
[0m08:44:04.084598 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m08:44:04.084818 [info ] [MainThread]: 
[0m08:44:04.086094 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:44:04.086389 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters_vertical ..... [RUN]
[0m08:44:04.086782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical)
[0m08:44:04.086986 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:44:04.088925 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.089581 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (compile): 08:44:04.087105 => 08:44:04.089304
[0m08:44:04.089907 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:44:04.108505 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.109166 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.109426 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: BEGIN
[0m08:44:04.109657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:04.116300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.116641 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.116911 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::timestamp as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::timestamp as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT
    
    ID          ::varchar   as record_id,
    DATE        ::timestamp as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::timestamp as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m08:44:04.117467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.122692 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.123047 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical" rename to "stg_daily_climate_parameters_vertical__dbt_backup"
[0m08:44:04.123417 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.125286 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.125512 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" rename to "stg_daily_climate_parameters_vertical"
[0m08:44:04.125791 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.134799 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m08:44:04.135163 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.135378 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m08:44:04.135920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.138862 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m08:44:04.139105 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_backup" cascade
[0m08:44:04.139496 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m08:44:04.140438 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (execute): 08:44:04.090048 => 08:44:04.140305
[0m08:44:04.140685 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: Close
[0m08:44:04.185418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd9587fe-4ed6-4089-98ae-6b8414096b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057738e0>]}
[0m08:44:04.185950 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical  [[32mOK[0m in 0.10s]
[0m08:44:04.186314 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m08:44:04.187081 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:04.187268 [debug] [MainThread]: On master: BEGIN
[0m08:44:04.187420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:44:04.193438 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:44:04.193724 [debug] [MainThread]: On master: COMMIT
[0m08:44:04.193897 [debug] [MainThread]: Using duckdb connection "master"
[0m08:44:04.194059 [debug] [MainThread]: On master: COMMIT
[0m08:44:04.194242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m08:44:04.194416 [debug] [MainThread]: On master: Close
[0m08:44:04.196898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:04.197225 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical' was properly closed.
[0m08:44:04.197493 [info ] [MainThread]: 
[0m08:44:04.197766 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m08:44:04.198205 [debug] [MainThread]: Command end result
[0m08:44:04.203256 [info ] [MainThread]: 
[0m08:44:04.203578 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:04.203769 [info ] [MainThread]: 
[0m08:44:04.203961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:44:04.205845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.701489, "process_user_time": 1.667032, "process_kernel_time": 0.149006, "process_mem_max_rss": "187678720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:44:04.206409 [debug] [MainThread]: Command `dbt run` succeeded at 08:44:04.206325 after 0.70 seconds
[0m08:44:04.206655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035aabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c87220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f444c0>]}
[0m08:44:04.206888 [debug] [MainThread]: Flushing usage events
[0m10:41:04.414150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c46bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e078b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e07ca0>]}


============================== 10:41:04.417351 | 599df960-b3eb-4dba-99d1-d8f1d4f1bbd2 ==============================
[0m10:41:04.417351 [info ] [MainThread]: Running with dbt=1.7.6
[0m10:41:04.417782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select int_daily_climate_parameters_vertical+', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:04.761131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '599df960-b3eb-4dba-99d1-d8f1d4f1bbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e079d0>]}
[0m10:41:04.857903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '599df960-b3eb-4dba-99d1-d8f1d4f1bbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbf9d0>]}
[0m10:41:04.859488 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m10:41:04.870569 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m10:41:04.899827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:04.900195 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:04.905129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '599df960-b3eb-4dba-99d1-d8f1d4f1bbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737c0d0>]}
[0m10:41:04.912421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '599df960-b3eb-4dba-99d1-d8f1d4f1bbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072863b0>]}
[0m10:41:04.912793 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:41:04.913061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '599df960-b3eb-4dba-99d1-d8f1d4f1bbd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107286380>]}
[0m10:41:04.913583 [warn ] [MainThread]: The selection criterion 'int_daily_climate_parameters_vertical+' does not match any nodes
[0m10:41:04.914194 [info ] [MainThread]: 
[0m10:41:04.914425 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:41:04.914762 [debug] [MainThread]: Command end result
[0m10:41:04.921262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5615399, "process_user_time": 1.698666, "process_kernel_time": 0.173691, "process_mem_max_rss": "126992384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:41:04.921875 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:04.921778 after 0.56 seconds
[0m10:41:04.922179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c46bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbf9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107286290>]}
[0m10:41:04.922471 [debug] [MainThread]: Flushing usage events
[0m10:41:31.086223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105202bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c7c10>]}


============================== 10:41:31.088567 | 7d09988e-ee9e-410e-95a9-762831559e55 ==============================
[0m10:41:31.088567 [info ] [MainThread]: Running with dbt=1.7.6
[0m10:41:31.089008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_daily_climate_params_pivoted', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:41:31.322565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107446c50>]}
[0m10:41:31.419427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107392800>]}
[0m10:41:31.420042 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m10:41:31.431036 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m10:41:31.452487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:31.452870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:31.457808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079340d0>]}
[0m10:41:31.464543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107842320>]}
[0m10:41:31.464898 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:41:31.465165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078422f0>]}
[0m10:41:31.466025 [info ] [MainThread]: 
[0m10:41:31.466522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:31.467304 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m10:41:31.476218 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m10:41:31.476634 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m10:41:31.476881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:31.498822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.501248 [debug] [ThreadPool]: On list_dev_database: Close
[0m10:41:31.504924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m10:41:31.505553 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m10:41:31.511193 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:31.511567 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m10:41:31.511802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:31.520030 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.521172 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:31.521425 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m10:41:31.521700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.521908 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:31.522119 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m10:41:31.522465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.523026 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:41:31.523246 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:31.523441 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:41:31.523699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.523902 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m10:41:31.527121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m10:41:31.531098 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:41:31.531388 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m10:41:31.531597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:31.539041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.539345 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:41:31.539585 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m10:41:31.553661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:31.559242 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m10:41:31.559968 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m10:41:31.560187 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m10:41:31.574095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079189a0>]}
[0m10:41:31.574436 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.574651 [debug] [MainThread]: On master: BEGIN
[0m10:41:31.574850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:31.581855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:31.582153 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.582363 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.582562 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.582808 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:31.583026 [debug] [MainThread]: On master: Close
[0m10:41:31.585232 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m10:41:31.585528 [info ] [MainThread]: 
[0m10:41:31.586992 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:31.587366 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m10:41:31.587859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m10:41:31.588128 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:31.590235 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:31.590935 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 10:41:31.588289 => 10:41:31.590775
[0m10:41:31.591197 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:31.615564 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:31.617023 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:31.617398 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m10:41:31.617657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:31.625280 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:41:31.625648 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:31.625940 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (
    select 
    SELECT
        ID,
        DATE,
        ELEMENT,
        DATA_VALUE,
        M_FLAG,
        Q_FLAG,
        S_FLAG,
        OBS_TIME

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical"
)

select * from source
  );

[0m10:41:31.629862 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 10:41:31.591347 => 10:41:31.629588
[0m10:41:31.630254 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m10:41:31.633922 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m10:41:31.634226 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m10:41:31.637144 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "SELECT"
  LINE 7:     SELECT
              ^
[0m10:41:31.637563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d09988e-ee9e-410e-95a9-762831559e55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107951480>]}
[0m10:41:31.638028 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.05s]
[0m10:41:31.638633 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:31.639665 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.639969 [debug] [MainThread]: On master: BEGIN
[0m10:41:31.640188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:31.647838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:31.648219 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.648463 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:31.648679 [debug] [MainThread]: On master: COMMIT
[0m10:41:31.648914 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:31.649127 [debug] [MainThread]: On master: Close
[0m10:41:31.651541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:31.651920 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m10:41:31.652208 [info ] [MainThread]: 
[0m10:41:31.652622 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:41:31.653456 [debug] [MainThread]: Command end result
[0m10:41:31.659075 [info ] [MainThread]: 
[0m10:41:31.659433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:41:31.659656 [info ] [MainThread]: 
[0m10:41:31.659874 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "SELECT"
  LINE 7:     SELECT
              ^
[0m10:41:31.660280 [info ] [MainThread]: 
[0m10:41:31.660682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:41:31.662209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.62532216, "process_user_time": 1.85209, "process_kernel_time": 0.14611, "process_mem_max_rss": "178356224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:41:31.662751 [debug] [MainThread]: Command `dbt run` failed at 10:41:31.662660 after 0.63 seconds
[0m10:41:31.663064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105202bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107392800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078414e0>]}
[0m10:41:31.663345 [debug] [MainThread]: Flushing usage events
[0m10:41:41.615290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090babc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7cf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7cfca0>]}


============================== 10:41:41.618138 | 2336ba9b-3ceb-4501-9912-e65c582238d6 ==============================
[0m10:41:41.618138 [info ] [MainThread]: Running with dbt=1.7.6
[0m10:41:41.618575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_daily_climate_params_pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:41.856744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7cf9d0>]}
[0m10:41:41.953407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca779d0>]}
[0m10:41:41.954624 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m10:41:41.966189 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m10:41:41.992709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:41.993249 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m10:41:42.133731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0dd6f0>]}
[0m10:41:42.140268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd463b0>]}
[0m10:41:42.140611 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:41:42.140882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd46380>]}
[0m10:41:42.141750 [info ] [MainThread]: 
[0m10:41:42.142269 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:41:42.143105 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m10:41:42.151175 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m10:41:42.151544 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m10:41:42.151787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:42.165546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.166760 [debug] [ThreadPool]: On list_dev_database: Close
[0m10:41:42.169500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m10:41:42.170020 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m10:41:42.175421 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:42.175811 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m10:41:42.176040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:42.184093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.216377 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:42.216747 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m10:41:42.217072 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.217273 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:42.217486 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m10:41:42.217778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.218315 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:41:42.218534 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:41:42.218732 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:41:42.218987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.219200 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m10:41:42.222372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m10:41:42.226153 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:41:42.226413 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m10:41:42.226625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:41:42.234136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.234429 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:41:42.234667 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m10:41:42.248107 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:41:42.253107 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m10:41:42.254646 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m10:41:42.254874 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m10:41:42.268729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1270d0>]}
[0m10:41:42.269096 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.269316 [debug] [MainThread]: On master: BEGIN
[0m10:41:42.269522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:42.276048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:42.276342 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.276554 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.276751 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.276982 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:42.277188 [debug] [MainThread]: On master: Close
[0m10:41:42.279234 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m10:41:42.279493 [info ] [MainThread]: 
[0m10:41:42.280962 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:42.281316 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m10:41:42.281797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m10:41:42.282069 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:42.284206 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:42.284805 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 10:41:42.282225 => 10:41:42.284646
[0m10:41:42.285071 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:42.310223 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:42.310967 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:42.311250 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m10:41:42.311506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:41:42.318993 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:41:42.319380 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:41:42.319679 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
        ID,
        DATE,
        ELEMENT,
        DATA_VALUE,
        M_FLAG,
        Q_FLAG,
        S_FLAG,
        OBS_TIME

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical"
)

select * from source
  );

[0m10:41:42.322977 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 10:41:42.285222 => 10:41:42.322758
[0m10:41:42.323331 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m10:41:42.327054 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m10:41:42.327386 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m10:41:42.330216 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "ID" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical.record_id"
[0m10:41:42.330636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2336ba9b-3ceb-4501-9912-e65c582238d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd47eb0>]}
[0m10:41:42.331075 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.05s]
[0m10:41:42.331501 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:41:42.332517 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.332800 [debug] [MainThread]: On master: BEGIN
[0m10:41:42.333013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:42.340464 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:42.340867 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.341100 [debug] [MainThread]: Using duckdb connection "master"
[0m10:41:42.341314 [debug] [MainThread]: On master: COMMIT
[0m10:41:42.341637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:41:42.341869 [debug] [MainThread]: On master: Close
[0m10:41:42.344479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:42.344805 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m10:41:42.345069 [info ] [MainThread]: 
[0m10:41:42.345319 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:41:42.346109 [debug] [MainThread]: Command end result
[0m10:41:42.355398 [info ] [MainThread]: 
[0m10:41:42.355787 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:41:42.356023 [info ] [MainThread]: 
[0m10:41:42.356411 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "ID" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical.record_id"
[0m10:41:42.356695 [info ] [MainThread]: 
[0m10:41:42.356941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:41:42.358512 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7944466, "process_user_time": 2.078324, "process_kernel_time": 0.1603, "process_mem_max_rss": "170803200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:41:42.359004 [debug] [MainThread]: Command `dbt run` failed at 10:41:42.358914 after 0.80 seconds
[0m10:41:42.359296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090babc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac39d0>]}
[0m10:41:42.359575 [debug] [MainThread]: Flushing usage events
[0m10:44:14.385362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104006bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcb8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcbcd0>]}


============================== 10:44:14.388392 | 4920c4c8-44f3-4244-8310-d0c139684462 ==============================
[0m10:44:14.388392 [info ] [MainThread]: Running with dbt=1.7.6
[0m10:44:14.388815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical', 'send_anonymous_usage_stats': 'True'}
[0m10:44:14.680785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcba00>]}
[0m10:44:14.777086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717c8b0>]}
[0m10:44:14.778099 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m10:44:14.788604 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m10:44:14.816364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:44:14.816936 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m10:44:14.956268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092dd7b0>]}
[0m10:44:14.962790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109042410>]}
[0m10:44:14.963154 [info ] [MainThread]: Found 4 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:44:14.963432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090423e0>]}
[0m10:44:14.964292 [info ] [MainThread]: 
[0m10:44:14.964804 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:44:14.965486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m10:44:14.973382 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m10:44:14.973733 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m10:44:14.973965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:44:14.993886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:14.995775 [debug] [ThreadPool]: On list_dev_database: Close
[0m10:44:14.999280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m10:44:14.999838 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m10:44:15.005133 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:44:15.005502 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m10:44:15.005730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:15.013602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.045717 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:44:15.046095 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m10:44:15.046419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.046625 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:44:15.046841 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m10:44:15.047171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.047701 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:44:15.047920 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:44:15.048131 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:44:15.048381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.048592 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m10:44:15.051534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m10:44:15.055275 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:44:15.055523 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m10:44:15.055725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:44:15.062659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.062969 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:44:15.063205 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m10:44:15.077899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:44:15.083438 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m10:44:15.084226 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m10:44:15.084450 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m10:44:15.098269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932b190>]}
[0m10:44:15.098617 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:15.098833 [debug] [MainThread]: On master: BEGIN
[0m10:44:15.099032 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:44:15.105629 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:15.105918 [debug] [MainThread]: On master: COMMIT
[0m10:44:15.106121 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:15.106323 [debug] [MainThread]: On master: COMMIT
[0m10:44:15.106548 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:15.106750 [debug] [MainThread]: On master: Close
[0m10:44:15.108753 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m10:44:15.109018 [info ] [MainThread]: 
[0m10:44:15.110458 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m10:44:15.110804 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters_vertical ..... [RUN]
[0m10:44:15.111278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical)
[0m10:44:15.111543 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m10:44:15.113908 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.114692 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (compile): 10:44:15.111717 => 10:44:15.114529
[0m10:44:15.114963 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m10:44:15.138563 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.139282 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.139587 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: BEGIN
[0m10:44:15.139849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:44:15.147049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.147437 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.147761 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m10:44:15.148779 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.154103 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.154515 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical" rename to "stg_daily_climate_parameters_vertical__dbt_backup"
[0m10:44:15.155251 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.158490 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.158846 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_tmp" rename to "stg_daily_climate_parameters_vertical"
[0m10:44:15.159298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.170974 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m10:44:15.171456 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.171751 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: COMMIT
[0m10:44:15.172439 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.176190 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical"
[0m10:44:15.176502 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical__dbt_backup" cascade
[0m10:44:15.176951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:44:15.177988 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical (execute): 10:44:15.115119 => 10:44:15.177836
[0m10:44:15.178275 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical: Close
[0m10:44:15.227982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4920c4c8-44f3-4244-8310-d0c139684462', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093642b0>]}
[0m10:44:15.228585 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical  [[32mOK[0m in 0.12s]
[0m10:44:15.229019 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical
[0m10:44:15.229907 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:15.230133 [debug] [MainThread]: On master: BEGIN
[0m10:44:15.230332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:44:15.237691 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:15.238029 [debug] [MainThread]: On master: COMMIT
[0m10:44:15.238251 [debug] [MainThread]: Using duckdb connection "master"
[0m10:44:15.238465 [debug] [MainThread]: On master: COMMIT
[0m10:44:15.238722 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:44:15.238939 [debug] [MainThread]: On master: Close
[0m10:44:15.241185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:44:15.241461 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical' was properly closed.
[0m10:44:15.241709 [info ] [MainThread]: 
[0m10:44:15.241957 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m10:44:15.242425 [debug] [MainThread]: Command end result
[0m10:44:15.248234 [info ] [MainThread]: 
[0m10:44:15.248596 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:44:15.248827 [info ] [MainThread]: 
[0m10:44:15.249056 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:44:15.250601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9166283, "process_user_time": 2.076437, "process_kernel_time": 0.183478, "process_mem_max_rss": "166019072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:44:15.251041 [debug] [MainThread]: Command `dbt run` succeeded at 10:44:15.250956 after 0.92 seconds
[0m10:44:15.251321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104006bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109387b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717c8b0>]}
[0m10:44:15.251596 [debug] [MainThread]: Flushing usage events
[0m11:23:33.841703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c72bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3bbb0>]}


============================== 11:23:33.845041 | a9ddddcf-11c4-40c5-ab98-8fd0058cb008 ==============================
[0m11:23:33.845041 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:23:33.845504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m11:23:34.199669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9ddddcf-11c4-40c5-ab98-8fd0058cb008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb6d40>]}
[0m11:23:34.297364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9ddddcf-11c4-40c5-ab98-8fd0058cb008', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd04f0>]}
[0m11:23:34.298837 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:23:34.310075 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:23:34.342121 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:23:34.342627 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m11:23:34.342886 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m11:23:34.343144 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m11:23:34.343387 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:23:34.479201 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_works_dbt.stg_daily_climate_parameters' (models/staging/stg_daily_climate_parameters.sql) depends on a node named 'int_daily_climate_params_vertical' which was not found
[0m11:23:34.486729 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.70049727, "process_user_time": 1.824011, "process_kernel_time": 0.189843, "process_mem_max_rss": "129826816", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:34.487303 [debug] [MainThread]: Command `dbt compile` failed at 11:23:34.487200 after 0.70 seconds
[0m11:23:34.487617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c72bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449ed0>]}
[0m11:23:34.487940 [debug] [MainThread]: Flushing usage events
[0m11:24:13.414034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107712bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcbc10>]}


============================== 11:24:13.416402 | 41f02d33-1b48-4b86-999f-3de888c467fc ==============================
[0m11:24:13.416402 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:24:13.416824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:24:13.659055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f02d33-1b48-4b86-999f-3de888c467fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4ac50>]}
[0m11:24:13.762551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f02d33-1b48-4b86-999f-3de888c467fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b96800>]}
[0m11:24:13.763265 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:24:13.774969 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:24:13.798399 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:24:13.798953 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m11:24:13.799238 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m11:24:13.799539 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m11:24:13.799783 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:24:13.942277 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_works_dbt.int_daily_climate_params_pivoted' (models/Intermediate/int_daily_climate_params_pivoted.sql) depends on a node named 'stg_daily_climate_parameters_vertical' which was not found
[0m11:24:13.943658 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5825386, "process_user_time": 1.860883, "process_kernel_time": 0.120259, "process_mem_max_rss": "130629632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:24:13.944153 [debug] [MainThread]: Command `dbt compile` failed at 11:24:13.944060 after 0.58 seconds
[0m11:24:13.944513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107712bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a537760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4dcee0>]}
[0m11:24:13.944881 [debug] [MainThread]: Flushing usage events
[0m11:29:32.899897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076078b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607c40>]}


============================== 11:29:32.902310 | 7f52bad8-03ec-43fe-9cc5-70c1754d1f83 ==============================
[0m11:29:32.902310 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:29:32.902735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:33.140302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f52bad8-03ec-43fe-9cc5-70c1754d1f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607a90>]}
[0m11:29:33.237795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f52bad8-03ec-43fe-9cc5-70c1754d1f83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c5e0>]}
[0m11:29:33.238391 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:29:33.249057 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:29:33.270231 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:29:33.270747 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m11:29:33.271013 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m11:29:33.271283 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m11:29:33.271538 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:29:33.407796 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.climate_works_dbt.int_daily_climate_params_pivoted' (models/Intermediate/int_daily_climate_params_pivoted.sql) depends on a node named 'stg_daily_climate_parameters_vertical' which was not found
[0m11:29:33.409165 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.5590475, "process_user_time": 1.818253, "process_kernel_time": 0.122079, "process_mem_max_rss": "130908160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:29:33.409668 [debug] [MainThread]: Command `dbt compile` failed at 11:29:33.409574 after 0.56 seconds
[0m11:29:33.409968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107daf760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d25c00>]}
[0m11:29:33.410281 [debug] [MainThread]: Flushing usage events
[0m11:29:53.775779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cbc70>]}


============================== 11:29:53.778166 | 1866525c-b1ce-4474-a866-1d1c699b0a5e ==============================
[0m11:29:53.778166 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:29:53.778586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:54.012959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cb9d0>]}
[0m11:29:54.109158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734a1d0>]}
[0m11:29:54.109737 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:29:54.120482 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:29:54.141536 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m11:29:54.142062 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m11:29:54.142344 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m11:29:54.142617 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical.sql
[0m11:29:54.142865 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:29:54.285825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae1d80>]}
[0m11:29:54.293344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783e5c0>]}
[0m11:29:54.293697 [info ] [MainThread]: Found 5 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:29:54.293965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783e440>]}
[0m11:29:54.295170 [info ] [MainThread]: 
[0m11:29:54.295709 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:29:54.296733 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database_dev_sode'
[0m11:29:54.304236 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:29:54.304587 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:29:54.304813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:54.322531 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:54.322890 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:29:54.323146 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:29:54.344128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:54.381703 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:29:54.382641 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:29:54.382881 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:29:54.397076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1866525c-b1ce-4474-a866-1d1c699b0a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791b190>]}
[0m11:29:54.397672 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:29:54.397928 [info ] [MainThread]: 
[0m11:29:54.399455 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.my_first_dbt_model
[0m11:29:54.399916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.my_first_dbt_model)
[0m11:29:54.400174 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.my_first_dbt_model
[0m11:29:54.402450 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.my_first_dbt_model"
[0m11:29:54.403288 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_first_dbt_model (compile): 11:29:54.400326 => 11:29:54.403126
[0m11:29:54.403554 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.my_first_dbt_model
[0m11:29:54.403854 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_first_dbt_model (execute): 11:29:54.403707 => 11:29:54.403718
[0m11:29:54.404445 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.my_first_dbt_model
[0m11:29:54.404737 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:29:54.405418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.my_first_dbt_model, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:29:54.405832 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:29:54.408051 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:29:54.408689 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:29:54.406005 => 11:29:54.408531
[0m11:29:54.408957 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:29:54.409249 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:29:54.409109 => 11:29:54.409115
[0m11:29:54.409823 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:29:54.410099 [debug] [Thread-1 (]: Began running node seed.climate_works_dbt.2022
[0m11:29:54.410643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now seed.climate_works_dbt.2022)
[0m11:29:54.410885 [debug] [Thread-1 (]: Began compiling node seed.climate_works_dbt.2022
[0m11:29:54.412307 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2022 (compile): 11:29:54.411154 => 11:29:54.412089
[0m11:29:54.412658 [debug] [Thread-1 (]: Began executing node seed.climate_works_dbt.2022
[0m11:29:54.412967 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2022 (execute): 11:29:54.412824 => 11:29:54.412830
[0m11:29:54.413624 [debug] [Thread-1 (]: Finished running node seed.climate_works_dbt.2022
[0m11:29:54.413922 [debug] [Thread-1 (]: Began running node seed.climate_works_dbt.2023
[0m11:29:54.414466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.climate_works_dbt.2022, now seed.climate_works_dbt.2023)
[0m11:29:54.414768 [debug] [Thread-1 (]: Began compiling node seed.climate_works_dbt.2023
[0m11:29:54.416139 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2023 (compile): 11:29:54.414932 => 11:29:54.415968
[0m11:29:54.416430 [debug] [Thread-1 (]: Began executing node seed.climate_works_dbt.2023
[0m11:29:54.416727 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2023 (execute): 11:29:54.416593 => 11:29:54.416598
[0m11:29:54.417310 [debug] [Thread-1 (]: Finished running node seed.climate_works_dbt.2023
[0m11:29:54.417587 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.my_second_dbt_model
[0m11:29:54.418003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.climate_works_dbt.2023, now model.climate_works_dbt.my_second_dbt_model)
[0m11:29:54.418353 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.my_second_dbt_model
[0m11:29:54.420458 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.my_second_dbt_model"
[0m11:29:54.421046 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_second_dbt_model (compile): 11:29:54.418520 => 11:29:54.420897
[0m11:29:54.421302 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.my_second_dbt_model
[0m11:29:54.421586 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_second_dbt_model (execute): 11:29:54.421451 => 11:29:54.421457
[0m11:29:54.422162 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.my_second_dbt_model
[0m11:29:54.422455 [debug] [Thread-1 (]: Began running node test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:54.422874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.my_second_dbt_model, now test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:29:54.423126 [debug] [Thread-1 (]: Began compiling node test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:54.432239 [debug] [Thread-1 (]: Writing injected SQL for node "test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:29:54.433083 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 11:29:54.423277 => 11:29:54.432893
[0m11:29:54.433377 [debug] [Thread-1 (]: Began executing node test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:54.433682 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 11:29:54.433542 => 11:29:54.433549
[0m11:29:54.434288 [debug] [Thread-1 (]: Finished running node test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:29:54.434604 [debug] [Thread-1 (]: Began running node test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:29:54.435070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.climate_works_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m11:29:54.435355 [debug] [Thread-1 (]: Began compiling node test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:29:54.439741 [debug] [Thread-1 (]: Writing injected SQL for node "test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m11:29:54.440278 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 11:29:54.435518 => 11:29:54.440126
[0m11:29:54.440572 [debug] [Thread-1 (]: Began executing node test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:29:54.440877 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 11:29:54.440738 => 11:29:54.440743
[0m11:29:54.441438 [debug] [Thread-1 (]: Finished running node test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321
[0m11:29:54.441723 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:29:54.442127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.climate_works_dbt.unique_my_first_dbt_model_id.16e066b321, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:29:54.442379 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:29:54.444169 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:29:54.444751 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:29:54.442527 => 11:29:54.444575
[0m11:29:54.445052 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:29:54.445348 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:29:54.445209 => 11:29:54.445214
[0m11:29:54.445942 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:29:54.446226 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:29:54.446668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:29:54.446931 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:29:54.448871 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:29:54.449353 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:29:54.447092 => 11:29:54.449206
[0m11:29:54.449604 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:29:54.449891 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:29:54.449753 => 11:29:54.449757
[0m11:29:54.450447 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:29:54.450729 [debug] [Thread-1 (]: Began running node test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:54.451128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m11:29:54.451377 [debug] [Thread-1 (]: Began compiling node test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:54.454172 [debug] [Thread-1 (]: Writing injected SQL for node "test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m11:29:54.454665 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 11:29:54.451522 => 11:29:54.454519
[0m11:29:54.454921 [debug] [Thread-1 (]: Began executing node test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:54.455208 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 11:29:54.455075 => 11:29:54.455079
[0m11:29:54.455755 [debug] [Thread-1 (]: Finished running node test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m11:29:54.456033 [debug] [Thread-1 (]: Began running node test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:54.456473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.climate_works_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:29:54.456719 [debug] [Thread-1 (]: Began compiling node test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:54.459546 [debug] [Thread-1 (]: Writing injected SQL for node "test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:29:54.460025 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 11:29:54.456865 => 11:29:54.459878
[0m11:29:54.460286 [debug] [Thread-1 (]: Began executing node test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:54.460575 [debug] [Thread-1 (]: Timing info for test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 11:29:54.460444 => 11:29:54.460449
[0m11:29:54.461129 [debug] [Thread-1 (]: Finished running node test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m11:29:54.461711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:54.461934 [debug] [MainThread]: Connection 'test.climate_works_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:29:54.463023 [debug] [MainThread]: Command end result
[0m11:29:54.469995 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7440149, "process_user_time": 1.995717, "process_kernel_time": 0.136784, "process_mem_max_rss": "149356544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:29:54.470431 [debug] [MainThread]: Command `dbt compile` succeeded at 11:29:54.470343 after 0.74 seconds
[0m11:29:54.470702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107223eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d9b400>]}
[0m11:29:54.470967 [debug] [MainThread]: Flushing usage events
[0m11:30:16.191327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b8abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cfc10>]}


============================== 11:30:16.193847 | 6de7810b-657e-41f0-947e-e0b3c913144e ==============================
[0m11:30:16.193847 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:30:16.194264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:30:16.425500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146c50>]}
[0m11:30:16.522468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050967d0>]}
[0m11:30:16.523063 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:30:16.533916 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:30:16.555813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:16.556184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:16.561551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060380d0>]}
[0m11:30:16.568351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574e800>]}
[0m11:30:16.568743 [info ] [MainThread]: Found 5 models, 2 seeds, 4 tests, 4 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:30:16.569019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574e7d0>]}
[0m11:30:16.570186 [info ] [MainThread]: 
[0m11:30:16.570727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:30:16.571957 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:30:16.580825 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:30:16.581240 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:30:16.581486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:16.590172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.591523 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:30:16.594385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:30:16.594988 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:30:16.599919 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:16.600305 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:30:16.600542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:16.608812 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.610030 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:16.610297 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:30:16.610580 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.610794 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:16.611006 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:30:16.611303 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.611878 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:30:16.612104 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:16.612302 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:30:16.612569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.612780 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:30:16.616124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:30:16.620177 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:30:16.620478 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:30:16.620697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:16.628706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.629054 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:30:16.629301 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:30:16.642878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.647945 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:30:16.648416 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:30:16.648643 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:30:16.662982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060839a0>]}
[0m11:30:16.663381 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:16.663614 [debug] [MainThread]: On master: BEGIN
[0m11:30:16.663821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:16.670618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:16.670949 [debug] [MainThread]: On master: COMMIT
[0m11:30:16.671163 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:16.671371 [debug] [MainThread]: On master: COMMIT
[0m11:30:16.671600 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:16.671816 [debug] [MainThread]: On master: Close
[0m11:30:16.673894 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:30:16.674186 [info ] [MainThread]: 
[0m11:30:16.675479 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.my_first_dbt_model
[0m11:30:16.675892 [info ] [Thread-1 (]: 1 of 5 START sql table model dev_sode.my_first_dbt_model ....................... [RUN]
[0m11:30:16.676391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.my_first_dbt_model)
[0m11:30:16.676650 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.my_first_dbt_model
[0m11:30:16.678988 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.my_first_dbt_model"
[0m11:30:16.679632 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_first_dbt_model (compile): 11:30:16.676815 => 11:30:16.679466
[0m11:30:16.679910 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.my_first_dbt_model
[0m11:30:16.706087 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.my_first_dbt_model"
[0m11:30:16.706848 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.my_first_dbt_model"
[0m11:30:16.707134 [debug] [Thread-1 (]: On model.climate_works_dbt.my_first_dbt_model: BEGIN
[0m11:30:16.707383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:16.715045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.715449 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.my_first_dbt_model"
[0m11:30:16.715752 [debug] [Thread-1 (]: On model.climate_works_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.my_first_dbt_model"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

select * from "climate_works"."dev_sode"."noaa_ghcn_1750"

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:30:16.721399 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.my_first_dbt_model (execute): 11:30:16.680071 => 11:30:16.721142
[0m11:30:16.721772 [debug] [Thread-1 (]: On model.climate_works_dbt.my_first_dbt_model: ROLLBACK
[0m11:30:16.725994 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.my_first_dbt_model'
[0m11:30:16.726367 [debug] [Thread-1 (]: On model.climate_works_dbt.my_first_dbt_model: Close
[0m11:30:16.729411 [debug] [Thread-1 (]: Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Binder Error: Catalog "climate_works" does not exist!
[0m11:30:16.729862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546b8b0>]}
[0m11:30:16.730315 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dev_sode.my_first_dbt_model .............. [[31mERROR[0m in 0.05s]
[0m11:30:16.730740 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.my_first_dbt_model
[0m11:30:16.731052 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:16.731360 [info ] [Thread-1 (]: 2 of 5 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:30:16.731838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.my_first_dbt_model, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:30:16.732104 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:16.734461 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.735307 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:30:16.732261 => 11:30:16.735112
[0m11:30:16.735592 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:16.749468 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.750138 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.750414 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:30:16.750660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:16.757884 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.758285 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.758685 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:30:16.759380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.764080 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.764482 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.765077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.775542 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:30:16.776006 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.776287 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:30:16.777108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.781165 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:16.781595 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:30:16.782039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.783250 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:30:16.735750 => 11:30:16.783071
[0m11:30:16.783571 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:30:16.835068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e3dc0>]}
[0m11:30:16.835630 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.10s]
[0m11:30:16.836052 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:16.836361 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.my_second_dbt_model
[0m11:30:16.836817 [info ] [Thread-1 (]: 3 of 5 SKIP relation dev_sode.my_second_dbt_model .............................. [[33mSKIP[0m]
[0m11:30:16.837179 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.my_second_dbt_model
[0m11:30:16.837483 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:16.837863 [info ] [Thread-1 (]: 4 of 5 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:30:16.838356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:30:16.838650 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:16.840881 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:16.841566 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:30:16.838813 => 11:30:16.841400
[0m11:30:16.841846 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:16.881536 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:16.882236 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:16.882514 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:30:16.882761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:16.889715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.890103 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:16.890403 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )
)


select * from pivoted
  );

[0m11:30:16.892808 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:30:16.842004 => 11:30:16.892599
[0m11:30:16.893171 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:30:16.894066 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:30:16.894417 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:30:16.897180 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:30:16.897609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c24a0>]}
[0m11:30:16.898052 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.06s]
[0m11:30:16.898491 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:16.898954 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:16.900008 [info ] [Thread-1 (]: 5 of 5 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:30:16.900560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:30:16.900836 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:16.902915 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:16.903579 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:30:16.900997 => 11:30:16.903415
[0m11:30:16.903848 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:16.908296 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:16.908889 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:16.909150 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:30:16.909393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:16.917002 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:16.917385 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:16.917681 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(record_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:30:16.918602 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:30:16.903998 => 11:30:16.918439
[0m11:30:16.918887 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: ROLLBACK
[0m11:30:16.919592 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.stg_daily_climate_parameters'
[0m11:30:16.920044 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:30:16.922699 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: Referenced column "record_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical_raw.record_id"
[0m11:30:16.923072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6de7810b-657e-41f0-947e-e0b3c913144e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c3700>]}
[0m11:30:16.923503 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model dev_sode.stg_daily_climate_parameters ..... [[31mERROR[0m in 0.02s]
[0m11:30:16.924024 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:16.924970 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:16.925297 [debug] [MainThread]: On master: BEGIN
[0m11:30:16.925552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:16.932666 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:16.933046 [debug] [MainThread]: On master: COMMIT
[0m11:30:16.933271 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:16.933477 [debug] [MainThread]: On master: COMMIT
[0m11:30:16.933749 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:16.933958 [debug] [MainThread]: On master: Close
[0m11:30:16.936474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:16.936781 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:30:16.937045 [info ] [MainThread]: 
[0m11:30:16.937292 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:30:16.938006 [debug] [MainThread]: Command end result
[0m11:30:16.943985 [info ] [MainThread]: 
[0m11:30:16.944364 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m11:30:16.944599 [info ] [MainThread]: 
[0m11:30:16.944824 [error] [MainThread]:   Runtime Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  Binder Error: Catalog "climate_works" does not exist!
[0m11:30:16.945047 [info ] [MainThread]: 
[0m11:30:16.945269 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:30:16.945490 [info ] [MainThread]: 
[0m11:30:16.945700 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: Referenced column "record_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical_raw.record_id"
[0m11:30:16.945917 [info ] [MainThread]: 
[0m11:30:16.946143 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=1 TOTAL=5
[0m11:30:16.947313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80775404, "process_user_time": 2.022254, "process_kernel_time": 0.153525, "process_mem_max_rss": "186400768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:16.947709 [debug] [MainThread]: Command `dbt run` failed at 11:30:16.947628 after 0.81 seconds
[0m11:30:16.947981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b8abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050967d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c0c40>]}
[0m11:30:16.948259 [debug] [MainThread]: Flushing usage events
[0m11:30:47.133599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3fbb0>]}


============================== 11:30:47.135989 | 37872c36-d67d-4157-a598-c26e1ead5d21 ==============================
[0m11:30:47.135989 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:30:47.136412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:30:47.376277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbad40>]}
[0m11:30:47.473649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad82e0>]}
[0m11:30:47.474225 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:30:47.484726 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:30:47.505673 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 0 files added, 0 files changed.
[0m11:30:47.506224 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/example/my_first_dbt_model.sql
[0m11:30:47.506497 [debug] [MainThread]: Partial parsing: deleted file: climate_works_dbt://models/example/my_second_dbt_model.sql
[0m11:30:47.510591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:30:47.514949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b5c60>]}
[0m11:30:47.521917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbe4a0>]}
[0m11:30:47.522357 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:30:47.522648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbe3b0>]}
[0m11:30:47.523810 [info ] [MainThread]: 
[0m11:30:47.524465 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:30:47.525554 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:30:47.534464 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:30:47.534861 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:30:47.535118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:47.543730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.545113 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:30:47.548579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:30:47.549165 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:30:47.553941 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:47.554265 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:30:47.554491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:47.562316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.563387 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:47.563641 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:30:47.563888 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.564088 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:47.564306 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:30:47.564578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.565099 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:30:47.565315 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:30:47.565512 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:30:47.565757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.565969 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:30:47.570680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:30:47.574753 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:30:47.575093 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:30:47.575311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:47.583109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.583481 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:30:47.583736 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:30:47.598504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:47.604073 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:30:47.604698 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:30:47.604941 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:30:47.619574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f3100>]}
[0m11:30:47.620018 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:47.620273 [debug] [MainThread]: On master: BEGIN
[0m11:30:47.620484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:47.628450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:47.628824 [debug] [MainThread]: On master: COMMIT
[0m11:30:47.629052 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:47.629265 [debug] [MainThread]: On master: COMMIT
[0m11:30:47.629519 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:47.629738 [debug] [MainThread]: On master: Close
[0m11:30:47.631883 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:30:47.632172 [info ] [MainThread]: 
[0m11:30:47.633456 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:47.633843 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:30:47.634318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:30:47.634596 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:47.637086 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.637766 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:30:47.634767 => 11:30:47.637597
[0m11:30:47.638053 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:47.663328 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.664051 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.664342 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:30:47.664602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:47.671960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.672359 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.672695 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:30:47.673322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.679196 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.679599 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:30:47.680054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.682212 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.682508 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.683160 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.694974 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:30:47.695406 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.695680 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:30:47.696393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.700394 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:30:47.700765 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:30:47.701278 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.702304 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:30:47.638220 => 11:30:47.702147
[0m11:30:47.702583 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:30:47.750131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514ff40>]}
[0m11:30:47.750709 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:30:47.751150 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:30:47.751767 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:47.752249 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:30:47.752752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:30:47.753023 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:47.755127 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:47.755719 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:30:47.753185 => 11:30:47.755564
[0m11:30:47.755982 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:47.760419 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:47.760972 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:47.761234 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:30:47.761470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:47.769403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.769778 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:30:47.770077 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )
)


select * from pivoted
  );

[0m11:30:47.770772 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:30:47.756140 => 11:30:47.770611
[0m11:30:47.771058 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:30:47.772721 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:30:47.773036 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:30:47.776036 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:30:47.776484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105126440>]}
[0m11:30:47.776938 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.02s]
[0m11:30:47.777364 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:30:47.777699 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:47.778125 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:30:47.778733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:30:47.779015 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:47.782012 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:47.782621 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:30:47.779184 => 11:30:47.782461
[0m11:30:47.782888 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:47.820995 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:47.821731 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:47.822008 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:30:47.822283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:47.829927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:47.830331 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:30:47.830630 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(record_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:30:47.831539 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:30:47.783039 => 11:30:47.831380
[0m11:30:47.831817 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: ROLLBACK
[0m11:30:47.832530 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.stg_daily_climate_parameters'
[0m11:30:47.832773 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:30:47.835540 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: Referenced column "record_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical_raw.record_id"
[0m11:30:47.835965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37872c36-d67d-4157-a598-c26e1ead5d21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bce500>]}
[0m11:30:47.836401 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dev_sode.stg_daily_climate_parameters ..... [[31mERROR[0m in 0.06s]
[0m11:30:47.836828 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:30:47.837838 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:47.838115 [debug] [MainThread]: On master: BEGIN
[0m11:30:47.838313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:47.845816 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:47.846177 [debug] [MainThread]: On master: COMMIT
[0m11:30:47.846396 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:47.846603 [debug] [MainThread]: On master: COMMIT
[0m11:30:47.846843 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:47.847056 [debug] [MainThread]: On master: Close
[0m11:30:47.849535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:47.849864 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:30:47.850127 [info ] [MainThread]: 
[0m11:30:47.850372 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:30:47.851000 [debug] [MainThread]: Command end result
[0m11:30:47.856795 [info ] [MainThread]: 
[0m11:30:47.857134 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m11:30:47.857355 [info ] [MainThread]: 
[0m11:30:47.857596 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:30:47.857821 [info ] [MainThread]: 
[0m11:30:47.858026 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: Referenced column "record_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters_vertical_raw.record_id"
[0m11:30:47.858251 [info ] [MainThread]: 
[0m11:30:47.858467 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m11:30:47.859765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7763523, "process_user_time": 1.99441, "process_kernel_time": 0.157787, "process_mem_max_rss": "189136896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:30:47.860220 [debug] [MainThread]: Command `dbt run` failed at 11:30:47.860131 after 0.78 seconds
[0m11:30:47.860509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f3a0>]}
[0m11:30:47.860827 [debug] [MainThread]: Flushing usage events
[0m11:32:47.398234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cbd30>]}


============================== 11:32:47.400658 | 2b1f556d-6c5b-4de4-ac40-6cf34d227007 ==============================
[0m11:32:47.400658 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:32:47.401076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:47.635032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ee60>]}
[0m11:32:47.731348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107976b60>]}
[0m11:32:47.731931 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:32:47.742574 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:32:47.763219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:32:47.763779 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m11:32:47.764086 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m11:32:47.902616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:32:47.906372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecc130>]}
[0m11:32:47.912977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce4b80>]}
[0m11:32:47.913361 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:32:47.913645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce4a30>]}
[0m11:32:47.914513 [info ] [MainThread]: 
[0m11:32:47.915077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:32:47.916002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:32:47.924739 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:32:47.925120 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:32:47.925421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:47.934868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:47.936112 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:32:47.939675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:32:47.940264 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:32:47.945688 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:47.946085 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:32:47.946318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:47.953993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:47.955030 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:47.955264 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:32:47.955501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:47.955696 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:47.955903 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:32:47.956173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:47.958008 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:32:47.958341 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:47.958588 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:32:47.958932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:47.959152 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:32:47.962431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:32:48.003381 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:32:48.003763 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:32:48.003985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:48.011711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:48.012045 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:32:48.012298 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:32:48.025521 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:48.030519 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:32:48.030969 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:32:48.031195 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:32:48.045775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed1ea0>]}
[0m11:32:48.046132 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:48.046347 [debug] [MainThread]: On master: BEGIN
[0m11:32:48.046546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:48.054268 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:48.054576 [debug] [MainThread]: On master: COMMIT
[0m11:32:48.054792 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:48.054996 [debug] [MainThread]: On master: COMMIT
[0m11:32:48.055231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:48.055440 [debug] [MainThread]: On master: Close
[0m11:32:48.057590 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:32:48.057869 [info ] [MainThread]: 
[0m11:32:48.059282 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:48.059648 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:32:48.060131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:32:48.060401 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:48.062737 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.063375 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:32:48.060559 => 11:32:48.063212
[0m11:32:48.063652 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:48.088533 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.089279 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.089557 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:32:48.089806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:48.097607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.097970 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.098302 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:32:48.098928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.104565 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.104988 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:32:48.105470 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.108605 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.108967 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.109398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.120837 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:32:48.121265 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.121541 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:32:48.122146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.125873 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:48.126215 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:32:48.126689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:48.127714 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:32:48.063811 => 11:32:48.127556
[0m11:32:48.128002 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:32:48.175957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1f556d-6c5b-4de4-ac40-6cf34d227007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108842800>]}
[0m11:32:48.176518 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:32:48.176950 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:48.177913 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:48.178182 [debug] [MainThread]: On master: BEGIN
[0m11:32:48.178393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:48.186461 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:48.186819 [debug] [MainThread]: On master: COMMIT
[0m11:32:48.187046 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:48.187255 [debug] [MainThread]: On master: COMMIT
[0m11:32:48.187528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:48.187747 [debug] [MainThread]: On master: Close
[0m11:32:48.190265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:48.190561 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m11:32:48.190814 [info ] [MainThread]: 
[0m11:32:48.191077 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:32:48.191651 [debug] [MainThread]: Command end result
[0m11:32:48.196989 [info ] [MainThread]: 
[0m11:32:48.197347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:48.197579 [info ] [MainThread]: 
[0m11:32:48.197817 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:32:48.198966 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8505706, "process_user_time": 2.081158, "process_kernel_time": 0.152113, "process_mem_max_rss": "195674112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:48.199373 [debug] [MainThread]: Command `dbt run` succeeded at 11:32:48.199289 after 0.85 seconds
[0m11:32:48.199664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088789d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790ce20>]}
[0m11:32:48.199945 [debug] [MainThread]: Flushing usage events
[0m11:32:54.919621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f02bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cbca0>]}


============================== 11:32:54.922023 | 959d8784-ae2a-4a1f-b9bc-1e22f7076da5 ==============================
[0m11:32:54.922023 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:32:54.922432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:55.167330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cb9d0>]}
[0m11:32:55.272088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055779d0>]}
[0m11:32:55.272733 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:32:55.283657 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:32:55.304804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:55.305197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:55.305875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:32:55.312205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078298d0>]}
[0m11:32:55.319243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe49a0>]}
[0m11:32:55.320575 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:32:55.320923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe48b0>]}
[0m11:32:55.321949 [info ] [MainThread]: 
[0m11:32:55.322550 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:32:55.323571 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:32:55.332894 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:32:55.333282 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:32:55.333516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:55.345743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.347138 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:32:55.350943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:32:55.351999 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:32:55.357221 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:55.357601 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:32:55.357829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:55.366279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.367330 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:55.367588 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:32:55.367930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.368158 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:55.368376 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:32:55.368736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.369433 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:32:55.369688 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:32:55.369895 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:32:55.370187 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.370405 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:32:55.374583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:32:55.378925 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:32:55.379363 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:32:55.379601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:55.387346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.387702 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:32:55.387953 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:32:55.402389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:32:55.407714 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:32:55.408219 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:32:55.408447 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:32:55.422478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4670>]}
[0m11:32:55.422878 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:55.423117 [debug] [MainThread]: On master: BEGIN
[0m11:32:55.423341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:55.430716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:55.431050 [debug] [MainThread]: On master: COMMIT
[0m11:32:55.431269 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:55.431479 [debug] [MainThread]: On master: COMMIT
[0m11:32:55.431714 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:55.431922 [debug] [MainThread]: On master: Close
[0m11:32:55.434035 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:32:55.434311 [info ] [MainThread]: 
[0m11:32:55.435560 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:55.435954 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:32:55.436440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:32:55.436715 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:55.439238 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.439934 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:32:55.436878 => 11:32:55.439740
[0m11:32:55.440222 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:55.464905 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.465679 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.466064 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:32:55.466337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:55.474298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.474712 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.475051 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:32:55.475905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.482215 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.482623 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:32:55.483090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.485159 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.485444 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.485887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.498157 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:32:55.498541 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.498813 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:32:55.499404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.503165 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:32:55.503481 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:32:55.503946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.504967 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:32:55.440380 => 11:32:55.504809
[0m11:32:55.505254 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:32:55.553379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ae7a0>]}
[0m11:32:55.553997 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:32:55.554428 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:32:55.554965 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:32:55.555330 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:32:55.555792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:32:55.556056 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:32:55.558156 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:32:55.558825 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:32:55.556212 => 11:32:55.558672
[0m11:32:55.559092 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:32:55.563545 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:32:55.564111 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:32:55.564381 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:32:55.564624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:55.572201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.572569 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:32:55.572854 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )
)


select * from pivoted
  );

[0m11:32:55.573550 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:32:55.559248 => 11:32:55.573395
[0m11:32:55.573828 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:32:55.575492 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:32:55.575884 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:32:55.578994 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:32:55.579429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4b1c0>]}
[0m11:32:55.579948 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.02s]
[0m11:32:55.580584 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:32:55.580941 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:32:55.581385 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:32:55.581920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:32:55.582206 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:32:55.584326 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.584947 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:32:55.582367 => 11:32:55.584788
[0m11:32:55.585220 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:32:55.589661 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.590631 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.591008 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:32:55.591272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:55.598861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.599254 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.599557 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:32:55.600346 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.636678 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.637183 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m11:32:55.637679 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.638911 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:32:55.639182 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.639424 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:32:55.640010 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.642163 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:32:55.642518 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m11:32:55.642919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:55.644030 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:32:55.585371 => 11:32:55.643881
[0m11:32:55.644317 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:32:55.694149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959d8784-ae2a-4a1f-b9bc-1e22f7076da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af36d0>]}
[0m11:32:55.694738 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m11:32:55.695156 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:32:55.696146 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:55.696490 [debug] [MainThread]: On master: BEGIN
[0m11:32:55.696736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:55.704632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:55.705100 [debug] [MainThread]: On master: COMMIT
[0m11:32:55.705430 [debug] [MainThread]: Using duckdb connection "master"
[0m11:32:55.705662 [debug] [MainThread]: On master: COMMIT
[0m11:32:55.705961 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:32:55.706196 [debug] [MainThread]: On master: Close
[0m11:32:55.708651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:55.708975 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:32:55.709248 [info ] [MainThread]: 
[0m11:32:55.709513 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:32:55.710121 [debug] [MainThread]: Command end result
[0m11:32:55.716026 [info ] [MainThread]: 
[0m11:32:55.716392 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:55.716737 [info ] [MainThread]: 
[0m11:32:55.717126 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:32:55.717383 [info ] [MainThread]: 
[0m11:32:55.717618 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:32:55.718849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8531644, "process_user_time": 2.08334, "process_kernel_time": 0.157996, "process_mem_max_rss": "189906944", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:32:55.719297 [debug] [MainThread]: Command `dbt run` failed at 11:32:55.719213 after 0.85 seconds
[0m11:32:55.719579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f02bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107829c90>]}
[0m11:32:55.719873 [debug] [MainThread]: Flushing usage events
[0m11:33:29.016015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aff8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108affcd0>]}


============================== 11:33:29.018463 | b9fa53b6-7e04-4304-aed2-31aaa8c3b49b ==============================
[0m11:33:29.018463 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:33:29.018895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:33:29.255732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aff9d0>]}
[0m11:33:29.353429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901ebc0>]}
[0m11:33:29.354063 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:33:29.364888 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:33:29.386056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:29.386583 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:33:29.519757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:33:29.523285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cc0d0>]}
[0m11:33:29.529843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e4b20>]}
[0m11:33:29.530237 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:33:29.530507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e49d0>]}
[0m11:33:29.531487 [info ] [MainThread]: 
[0m11:33:29.532073 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:29.532934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:33:29.541094 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:33:29.541495 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:33:29.541734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:29.551591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.552834 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:33:29.556324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:33:29.556863 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:33:29.562247 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:33:29.562641 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:33:29.562873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:29.570721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.571785 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:33:29.572031 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:33:29.572279 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.572484 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:33:29.572689 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:33:29.572954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.573483 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:33:29.573694 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:33:29.573949 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:33:29.574295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.574582 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:33:29.578615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:33:29.616829 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:33:29.617212 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:33:29.617436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:29.625335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.625663 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:33:29.625920 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:33:29.639430 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:29.644661 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:33:29.645111 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:33:29.645331 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:33:29.659990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109409c90>]}
[0m11:33:29.660383 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:29.660649 [debug] [MainThread]: On master: BEGIN
[0m11:33:29.660862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:29.668902 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:29.669214 [debug] [MainThread]: On master: COMMIT
[0m11:33:29.669430 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:29.669631 [debug] [MainThread]: On master: COMMIT
[0m11:33:29.669862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:29.670074 [debug] [MainThread]: On master: Close
[0m11:33:29.672260 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:33:29.672524 [info ] [MainThread]: 
[0m11:33:29.673826 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:33:29.674176 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:33:29.674653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:33:29.674916 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:33:29.677324 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.677969 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:33:29.675070 => 11:33:29.677805
[0m11:33:29.678243 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:33:29.701899 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.702609 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.702891 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:33:29.703142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:29.711294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.711700 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.712045 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:33:29.712708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.718385 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.718801 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:33:29.719255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.722256 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.722551 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.722934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.734484 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:33:29.734893 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.735158 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:33:29.735735 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.739376 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:33:29.739747 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:33:29.740316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.741419 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:33:29.678394 => 11:33:29.741253
[0m11:33:29.741724 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:33:29.791249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bc070>]}
[0m11:33:29.791839 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:33:29.792278 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:33:29.792801 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:33:29.793174 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:33:29.793643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:33:29.793912 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:33:29.796013 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:33:29.796780 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:33:29.794065 => 11:33:29.796529
[0m11:33:29.797121 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:33:29.801624 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:33:29.802230 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:33:29.802510 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:33:29.802755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:29.810602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.811017 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:33:29.811316 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )pivoted;
)


select * from pivoted
  );

[0m11:33:29.812028 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:33:29.797285 => 11:33:29.811871
[0m11:33:29.812310 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:33:29.814059 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:33:29.814435 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:33:29.817912 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )pivoted;
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:33:29.818358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ae110>]}
[0m11:33:29.818799 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.02s]
[0m11:33:29.819218 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:33:29.819509 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:33:29.819987 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:33:29.820554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:33:29.820832 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:33:29.823010 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.823611 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:33:29.820996 => 11:33:29.823450
[0m11:33:29.823881 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:33:29.828470 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.829098 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.829362 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:33:29.829598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:29.837099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.837515 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.837816 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:33:29.838510 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.841962 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.842346 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m11:33:29.842819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.846012 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.846347 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m11:33:29.846776 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.848031 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:33:29.848295 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.848529 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:33:29.849151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.851292 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:33:29.851586 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m11:33:29.852058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:29.853082 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:33:29.824031 => 11:33:29.852933
[0m11:33:29.853372 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:33:29.901785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9fa53b6-7e04-4304-aed2-31aaa8c3b49b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a858670>]}
[0m11:33:29.902362 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m11:33:29.902768 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:33:29.903674 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:29.903940 [debug] [MainThread]: On master: BEGIN
[0m11:33:29.904153 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:29.911324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:29.911654 [debug] [MainThread]: On master: COMMIT
[0m11:33:29.911871 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:29.912072 [debug] [MainThread]: On master: COMMIT
[0m11:33:29.912304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:29.912518 [debug] [MainThread]: On master: Close
[0m11:33:29.915429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:29.915737 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:33:29.915995 [info ] [MainThread]: 
[0m11:33:29.916237 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:33:29.916845 [debug] [MainThread]: Command end result
[0m11:33:29.922310 [info ] [MainThread]: 
[0m11:33:29.922653 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:29.922884 [info ] [MainThread]: 
[0m11:33:29.923121 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near "avg"
  LINE 22:       PIVOT source on reading_type avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
      )pivoted;
  )
  
  
  select * from pivoted
    );
  ...
                                              ^
[0m11:33:29.923365 [info ] [MainThread]: 
[0m11:33:29.923941 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:33:29.925167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9592937, "process_user_time": 2.16894, "process_kernel_time": 0.158354, "process_mem_max_rss": "202915840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:33:29.925664 [debug] [MainThread]: Command `dbt run` failed at 11:33:29.925574 after 0.96 seconds
[0m11:33:29.925963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109415060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094aebc0>]}
[0m11:33:29.926249 [debug] [MainThread]: Flushing usage events
[0m11:33:59.909774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596bca0>]}


============================== 11:33:59.912326 | 5cbdba17-c96f-4ac5-8c2a-c349a17201ed ==============================
[0m11:33:59.912326 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:33:59.912737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters_vertical_raw+', 'send_anonymous_usage_stats': 'True'}
[0m11:34:00.148334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b9d0>]}
[0m11:34:00.246440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1f9d0>]}
[0m11:34:00.247091 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:34:00.258106 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:34:00.278098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:00.278652 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:34:00.417524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:34:00.421188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060700d0>]}
[0m11:34:00.427543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e849a0>]}
[0m11:34:00.427934 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:34:00.428213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e848b0>]}
[0m11:34:00.429184 [info ] [MainThread]: 
[0m11:34:00.429836 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:34:00.430654 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:34:00.439150 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:34:00.439662 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:34:00.439954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:00.449678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.451079 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:34:00.454600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:34:00.455330 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:34:00.461049 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:00.461451 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:34:00.461685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:00.469983 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.471258 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:00.471602 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:34:00.471911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.472120 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:00.472332 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:34:00.472626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.473209 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:34:00.473441 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:00.473644 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:34:00.473920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.474138 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:34:00.478700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:34:00.519069 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:34:00.519615 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:34:00.519940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:00.528061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.528421 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:34:00.528669 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:34:00.542434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:00.547659 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:34:00.548250 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:34:00.548587 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:34:00.563586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ae1d0>]}
[0m11:34:00.563981 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:00.564427 [debug] [MainThread]: On master: BEGIN
[0m11:34:00.564651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:00.572463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:00.572796 [debug] [MainThread]: On master: COMMIT
[0m11:34:00.573057 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:00.573269 [debug] [MainThread]: On master: COMMIT
[0m11:34:00.573523 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:00.573741 [debug] [MainThread]: On master: Close
[0m11:34:00.575831 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:34:00.576100 [info ] [MainThread]: 
[0m11:34:00.577570 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:00.577944 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:34:00.578421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:34:00.578704 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:00.581340 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.582119 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:34:00.578860 => 11:34:00.581938
[0m11:34:00.582416 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:00.607662 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.608784 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.609156 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:34:00.609427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:00.616911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.617369 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.617742 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:34:00.618608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.624509 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.624965 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:34:00.625476 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.628809 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.629186 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.629635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.641390 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:34:00.641768 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.642034 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:34:00.642607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.646777 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:00.647218 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:34:00.647815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.648928 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:34:00.582581 => 11:34:00.648769
[0m11:34:00.649234 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:34:00.698532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606bdc0>]}
[0m11:34:00.699104 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:34:00.699532 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:00.700263 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:00.700647 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:34:00.701161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:34:00.701454 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:00.703536 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:00.704090 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:34:00.701619 => 11:34:00.703938
[0m11:34:00.704355 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:00.709001 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:00.709807 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:00.710174 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:34:00.710433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:00.718093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.718539 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:00.718836 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )pivoted;
)


select * from pivoted
  );

[0m11:34:00.720381 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:34:00.704511 => 11:34:00.720154
[0m11:34:00.720728 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:34:00.722358 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:34:00.722690 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:34:00.727358 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near ";"
  LINE 23:     )pivoted;
                       ^
[0m11:34:00.727821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061520e0>]}
[0m11:34:00.728256 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.03s]
[0m11:34:00.728665 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:00.728976 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:00.729282 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:34:00.730071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:34:00.730418 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:00.733383 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.734115 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:34:00.730590 => 11:34:00.733934
[0m11:34:00.734406 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:00.739333 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.740062 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.742792 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:34:00.745707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:00.768262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.768715 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.769027 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:34:00.769775 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.773469 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.773865 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m11:34:00.774316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.777765 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.778236 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m11:34:00.778756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.790024 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:34:00.790424 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.790685 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:34:00.791333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.793856 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:00.794178 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m11:34:00.794680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:00.795683 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:34:00.734569 => 11:34:00.795533
[0m11:34:00.796064 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:34:00.846085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cbdba17-c96f-4ac5-8c2a-c349a17201ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635ad70>]}
[0m11:34:00.846638 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.12s]
[0m11:34:00.847059 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:00.848080 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:00.848419 [debug] [MainThread]: On master: BEGIN
[0m11:34:00.848641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:00.856020 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:00.856392 [debug] [MainThread]: On master: COMMIT
[0m11:34:00.856621 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:00.856831 [debug] [MainThread]: On master: COMMIT
[0m11:34:00.857074 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:00.857291 [debug] [MainThread]: On master: Close
[0m11:34:00.859634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:00.859984 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:34:00.860336 [info ] [MainThread]: 
[0m11:34:00.860603 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m11:34:00.861219 [debug] [MainThread]: Command end result
[0m11:34:00.867137 [info ] [MainThread]: 
[0m11:34:00.867511 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:34:00.867740 [info ] [MainThread]: 
[0m11:34:00.867955 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: syntax error at or near ";"
  LINE 23:     )pivoted;
                       ^
[0m11:34:00.868175 [info ] [MainThread]: 
[0m11:34:00.868401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:34:00.869891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0120175, "process_user_time": 2.188083, "process_kernel_time": 0.157455, "process_mem_max_rss": "183828480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:34:00.870419 [debug] [MainThread]: Command `dbt run` failed at 11:34:00.870325 after 1.01 seconds
[0m11:34:00.870716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037b6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106340580>]}
[0m11:34:00.871010 [debug] [MainThread]: Flushing usage events
[0m11:34:10.067187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cfc70>]}


============================== 11:34:10.069657 | 728bddaf-56f7-411f-a5d1-ef8482d5ba6e ==============================
[0m11:34:10.069657 [info ] [MainThread]: Running with dbt=1.7.6
[0m11:34:10.070083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters_vertical_raw+', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:10.302350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cf9d0>]}
[0m11:34:10.400839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854a1d0>]}
[0m11:34:10.401492 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m11:34:10.412416 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m11:34:10.432140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:10.432860 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m11:34:10.568228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m11:34:10.571862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d00d0>]}
[0m11:34:10.579006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932cac0>]}
[0m11:34:10.579471 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:34:10.579764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932ca00>]}
[0m11:34:10.580910 [info ] [MainThread]: 
[0m11:34:10.581596 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:34:10.582864 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m11:34:10.590916 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m11:34:10.591295 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m11:34:10.591528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:10.600384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.601627 [debug] [ThreadPool]: On list_dev_database: Close
[0m11:34:10.604161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m11:34:10.604714 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m11:34:10.610203 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:10.610575 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m11:34:10.610806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:10.618999 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.620101 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:10.620353 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m11:34:10.620603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.620802 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:10.621010 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m11:34:10.621302 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.621841 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:34:10.622057 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m11:34:10.622253 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m11:34:10.622501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.622707 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m11:34:10.626601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m11:34:10.667093 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:34:10.667474 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m11:34:10.667686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:10.675726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.676085 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m11:34:10.676346 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m11:34:10.689916 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:34:10.695097 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m11:34:10.695601 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m11:34:10.695830 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m11:34:10.710105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a1a0>]}
[0m11:34:10.710508 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:10.710749 [debug] [MainThread]: On master: BEGIN
[0m11:34:10.710958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:34:10.718180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:10.718519 [debug] [MainThread]: On master: COMMIT
[0m11:34:10.718734 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:10.718943 [debug] [MainThread]: On master: COMMIT
[0m11:34:10.719184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:10.719396 [debug] [MainThread]: On master: Close
[0m11:34:10.721517 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m11:34:10.721801 [info ] [MainThread]: 
[0m11:34:10.723183 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:10.723550 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m11:34:10.724026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m11:34:10.724310 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:10.726791 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.727480 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 11:34:10.724472 => 11:34:10.727312
[0m11:34:10.727989 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:10.752822 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.753572 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.753870 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m11:34:10.754122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:10.762364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.762761 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.763096 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m11:34:10.763730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.769379 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.769789 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m11:34:10.770253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.773328 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.773681 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.774099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.785642 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:34:10.786046 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.786331 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m11:34:10.786900 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.790638 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m11:34:10.790950 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m11:34:10.791399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.792467 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 11:34:10.728147 => 11:34:10.792312
[0m11:34:10.792756 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m11:34:10.842481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c5840>]}
[0m11:34:10.843057 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m11:34:10.843481 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m11:34:10.844001 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:10.844375 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m11:34:10.844822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m11:34:10.845083 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:10.847169 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:10.847926 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 11:34:10.845238 => 11:34:10.847645
[0m11:34:10.848296 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:10.852795 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:10.853394 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:10.853680 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m11:34:10.853932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:10.862244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.862634 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m11:34:10.862939 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )
)


select * from pivoted
  );

[0m11:34:10.864289 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 11:34:10.848472 => 11:34:10.864127
[0m11:34:10.864574 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m11:34:10.866076 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m11:34:10.866337 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m11:34:10.869406 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: PIVOT statements with pivot elements extracted from the data cannot be used in views.
  In order to use PIVOT in a view the PIVOT values must be manually specified, e.g.:
  PIVOT ... ON reading_type IN (val1, val2, ...)
[0m11:34:10.869875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b20b0>]}
[0m11:34:10.870342 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.03s]
[0m11:34:10.870773 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m11:34:10.871069 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:10.871426 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m11:34:10.871886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m11:34:10.872144 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:10.874258 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.874973 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 11:34:10.872296 => 11:34:10.874759
[0m11:34:10.875285 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:10.879862 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.880421 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.880675 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m11:34:10.880905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:10.888332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.888711 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.888997 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4),
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m11:34:10.889673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.892987 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.893514 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m11:34:10.894047 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.897318 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.897678 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m11:34:10.898070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.899301 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:34:10.899585 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.899823 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m11:34:10.900464 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.902729 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m11:34:10.903030 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m11:34:10.903494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:34:10.904497 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 11:34:10.875450 => 11:34:10.904351
[0m11:34:10.904773 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m11:34:10.953458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '728bddaf-56f7-411f-a5d1-ef8482d5ba6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a25f010>]}
[0m11:34:10.954025 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m11:34:10.954436 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m11:34:10.955379 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:10.955649 [debug] [MainThread]: On master: BEGIN
[0m11:34:10.955848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:34:10.963182 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:10.963503 [debug] [MainThread]: On master: COMMIT
[0m11:34:10.963717 [debug] [MainThread]: Using duckdb connection "master"
[0m11:34:10.963921 [debug] [MainThread]: On master: COMMIT
[0m11:34:10.964157 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:34:10.964366 [debug] [MainThread]: On master: Close
[0m11:34:10.967004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:10.967333 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m11:34:10.967634 [info ] [MainThread]: 
[0m11:34:10.967881 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:34:10.968489 [debug] [MainThread]: Command end result
[0m11:34:10.973728 [info ] [MainThread]: 
[0m11:34:10.974057 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:34:10.974278 [info ] [MainThread]: 
[0m11:34:10.974654 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Parser Error: PIVOT statements with pivot elements extracted from the data cannot be used in views.
  In order to use PIVOT in a view the PIVOT values must be manually specified, e.g.:
  PIVOT ... ON reading_type IN (val1, val2, ...)
[0m11:34:10.974948 [info ] [MainThread]: 
[0m11:34:10.975214 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:34:10.976487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.96038926, "process_user_time": 2.177345, "process_kernel_time": 0.157419, "process_mem_max_rss": "192659456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:34:10.976935 [debug] [MainThread]: Command `dbt run` failed at 11:34:10.976851 after 0.96 seconds
[0m11:34:10.977216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a244550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109421f30>]}
[0m11:34:10.977494 [debug] [MainThread]: Flushing usage events
[0m13:20:42.957929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a7cd0>]}


============================== 13:20:42.961116 | e8e65cbb-1a77-48cd-a990-4582c1b5aff6 ==============================
[0m13:20:42.961116 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:20:42.961596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:20:43.300375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a7a00>]}
[0m13:20:43.397462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a588b0>]}
[0m13:20:43.399044 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:20:43.410054 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:20:43.440798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:43.441358 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m13:20:43.581998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:20:43.585509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dd40d0>]}
[0m13:20:43.592529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e4a00>]}
[0m13:20:43.592932 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:20:43.593220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109e4910>]}
[0m13:20:43.594216 [info ] [MainThread]: 
[0m13:20:43.594857 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:43.595920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:20:43.604119 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:20:43.604508 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:20:43.604740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:43.620615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.622619 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:20:43.625819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:20:43.626415 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:20:43.631648 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:20:43.631929 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:20:43.632157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:43.640867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.641939 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:20:43.642181 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:20:43.642426 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.642624 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:20:43.642827 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:20:43.643146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.643659 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:20:43.643870 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:20:43.644064 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:20:43.644304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.644513 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:20:43.647435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:20:43.681776 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:20:43.682130 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:20:43.682342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:43.690200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.690510 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:20:43.690759 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:20:43.704894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:20:43.710529 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:20:43.711364 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:20:43.711622 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:20:43.725891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e0e230>]}
[0m13:20:43.726245 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:43.726463 [debug] [MainThread]: On master: BEGIN
[0m13:20:43.726665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:43.733450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:20:43.733739 [debug] [MainThread]: On master: COMMIT
[0m13:20:43.733956 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:43.734157 [debug] [MainThread]: On master: COMMIT
[0m13:20:43.734391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:20:43.734594 [debug] [MainThread]: On master: Close
[0m13:20:43.736691 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:20:43.736966 [info ] [MainThread]: 
[0m13:20:43.738565 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:20:43.738925 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m13:20:43.739416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:20:43.739692 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:20:43.742103 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.742738 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:20:43.739850 => 13:20:43.742574
[0m13:20:43.743029 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:20:43.767691 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.768744 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.769124 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:20:43.769402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:43.777798 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.778198 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.778531 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m13:20:43.779564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.785220 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.785629 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:20:43.786418 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.789617 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.789953 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.790399 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.801917 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:20:43.802343 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.802618 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:20:43.803268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.807014 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:20:43.807325 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:20:43.807777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.808788 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:20:43.743191 => 13:20:43.808631
[0m13:20:43.809077 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:20:43.859479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dcdba0>]}
[0m13:20:43.860065 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m13:20:43.860497 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:20:43.861035 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:20:43.861380 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m13:20:43.861836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m13:20:43.862104 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:20:43.864191 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.865103 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 13:20:43.862258 => 13:20:43.864895
[0m13:20:43.865417 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:20:43.869997 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.870645 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.870922 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m13:20:43.871172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:43.878747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.879137 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.879442 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date
    )
)


select * from pivoted
  );

[0m13:20:43.881404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.883911 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.884240 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m13:20:43.884659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.885901 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:20:43.886208 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.886449 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:20:43.887032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.888984 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:20:43.889295 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m13:20:43.889684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:20:43.890666 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 13:20:43.865589 => 13:20:43.890518
[0m13:20:43.890939 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m13:20:43.940954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e65cbb-1a77-48cd-a990-4582c1b5aff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec8be0>]}
[0m13:20:43.941523 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m13:20:43.941939 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:20:43.942890 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:43.943175 [debug] [MainThread]: On master: BEGIN
[0m13:20:43.943397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:43.950929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:20:43.951291 [debug] [MainThread]: On master: COMMIT
[0m13:20:43.951508 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:43.951722 [debug] [MainThread]: On master: COMMIT
[0m13:20:43.951964 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:20:43.952176 [debug] [MainThread]: On master: Close
[0m13:20:43.954642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:43.954953 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m13:20:43.955213 [info ] [MainThread]: 
[0m13:20:43.955462 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:20:43.955981 [debug] [MainThread]: Command end result
[0m13:20:43.962426 [info ] [MainThread]: 
[0m13:20:43.963019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:43.963361 [info ] [MainThread]: 
[0m13:20:43.963623 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:20:43.965215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0600448, "process_user_time": 2.147608, "process_kernel_time": 0.215347, "process_mem_max_rss": "185647104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:43.965772 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:43.965674 after 1.06 seconds
[0m13:20:43.966098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ebc370>]}
[0m13:20:43.966400 [debug] [MainThread]: Flushing usage events
[0m13:23:53.910941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eeebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b3cd0>]}


============================== 13:23:53.914011 | a42fd159-8828-4ae4-b4a0-e7487b8ef2d3 ==============================
[0m13:23:53.914011 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:23:53.914443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:54.209261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a42fd159-8828-4ae4-b4a0-e7487b8ef2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b3a00>]}
[0m13:23:54.305455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a42fd159-8828-4ae4-b4a0-e7487b8ef2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051688b0>]}
[0m13:23:54.306489 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:23:54.318183 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:23:54.347678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:23:54.348225 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m13:23:54.348525 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m13:23:54.487273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:23:54.490895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a42fd159-8828-4ae4-b4a0-e7487b8ef2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b40d0>]}
[0m13:23:54.498390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a42fd159-8828-4ae4-b4a0-e7487b8ef2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cca00>]}
[0m13:23:54.498886 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:23:54.499179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a42fd159-8828-4ae4-b4a0-e7487b8ef2d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cc910>]}
[0m13:23:54.500160 [info ] [MainThread]: 
[0m13:23:54.500765 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:23:54.501614 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:23:54.509913 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:23:54.510285 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:23:54.510517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:54.519417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:54.519777 [debug] [MainThread]: Connection 'list_dev_database' was properly closed.
[0m13:23:54.520015 [info ] [MainThread]: 
[0m13:23:54.520267 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m13:23:54.520622 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/raajassode/dev/climate_works_dbt/./dev_database.duckdb": Resource temporarily unavailable
[0m13:23:54.522107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6624237, "process_user_time": 1.838283, "process_kernel_time": 0.171526, "process_mem_max_rss": "132169728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:23:54.522724 [debug] [MainThread]: Command `dbt run` failed at 13:23:54.522620 after 0.66 seconds
[0m13:23:54.523032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eeebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057edf90>]}
[0m13:23:54.523323 [debug] [MainThread]: Flushing usage events
[0m13:24:05.793385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103722bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058eb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ebcd0>]}


============================== 13:24:05.795916 | 7b8a6c62-3c0a-47c3-a8b6-11a470943029 ==============================
[0m13:24:05.795916 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:24:05.796341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_daily_climate_parameters', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:06.032338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058eb9d0>]}
[0m13:24:06.129389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3abc0>]}
[0m13:24:06.130004 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:24:06.140715 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:24:06.160750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:06.161167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:06.161698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:24:06.166335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e45900>]}
[0m13:24:06.174623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e00b20>]}
[0m13:24:06.175008 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:24:06.175279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e009d0>]}
[0m13:24:06.176166 [info ] [MainThread]: 
[0m13:24:06.176722 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:24:06.177478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:24:06.186277 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:24:06.186673 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:24:06.186911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:06.213876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.216786 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:24:06.219766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:24:06.220344 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:24:06.225092 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:24:06.225408 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:24:06.225631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:06.234383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.235518 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:24:06.235787 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:24:06.236079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.236286 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:24:06.236499 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:24:06.237135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.237876 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:24:06.238135 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:24:06.238354 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:24:06.238633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.238853 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:24:06.242628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:24:06.246731 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:24:06.247095 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:24:06.247342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:06.255291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.255651 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:24:06.255902 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:24:06.270768 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:24:06.277015 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:24:06.277841 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:24:06.278110 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:24:06.292337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e77160>]}
[0m13:24:06.292728 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:06.292946 [debug] [MainThread]: On master: BEGIN
[0m13:24:06.293143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:06.301004 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:24:06.301357 [debug] [MainThread]: On master: COMMIT
[0m13:24:06.301575 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:06.301781 [debug] [MainThread]: On master: COMMIT
[0m13:24:06.302026 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:24:06.302252 [debug] [MainThread]: On master: Close
[0m13:24:06.304415 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:24:06.304693 [info ] [MainThread]: 
[0m13:24:06.306216 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:24:06.306606 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m13:24:06.307108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m13:24:06.307392 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:24:06.309549 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.310335 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 13:24:06.307564 => 13:24:06.310152
[0m13:24:06.310624 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:24:06.335981 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.336689 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.336968 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m13:24:06.337213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:06.345294 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.345708 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.346016 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) as year,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

)

select * from source
  );

[0m13:24:06.347026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.353208 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.353601 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m13:24:06.354765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.357275 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.357615 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m13:24:06.358030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.369523 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:24:06.369919 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.370183 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:24:06.371154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.375671 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:24:06.376049 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m13:24:06.376590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:24:06.377715 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 13:24:06.310785 => 13:24:06.377557
[0m13:24:06.378018 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m13:24:06.428051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b8a6c62-3c0a-47c3-a8b6-11a470943029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105def130>]}
[0m13:24:06.428611 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.12s]
[0m13:24:06.429050 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:24:06.429998 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:06.430270 [debug] [MainThread]: On master: BEGIN
[0m13:24:06.430482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:06.437763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:24:06.438099 [debug] [MainThread]: On master: COMMIT
[0m13:24:06.438320 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:06.438535 [debug] [MainThread]: On master: COMMIT
[0m13:24:06.438777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:24:06.438986 [debug] [MainThread]: On master: Close
[0m13:24:06.441281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:06.441579 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m13:24:06.441835 [info ] [MainThread]: 
[0m13:24:06.442093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:24:06.442536 [debug] [MainThread]: Command end result
[0m13:24:06.449071 [info ] [MainThread]: 
[0m13:24:06.449424 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:06.449656 [info ] [MainThread]: 
[0m13:24:06.449912 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:24:06.451179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7081289, "process_user_time": 1.914089, "process_kernel_time": 0.147458, "process_mem_max_rss": "193118208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:24:06.451688 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:06.451601 after 0.71 seconds
[0m13:24:06.451984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103722bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f050f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e68520>]}
[0m13:24:06.452269 [debug] [MainThread]: Flushing usage events
[0m13:27:17.864975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccfc70>]}


============================== 13:27:17.867762 | 918f9553-5bc9-4c4e-86fb-9ea952b5562d ==============================
[0m13:27:17.867762 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:27:17.868202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'send_anonymous_usage_stats': 'True'}
[0m13:27:18.111850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '918f9553-5bc9-4c4e-86fb-9ea952b5562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccf9d0>]}
[0m13:27:18.213182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '918f9553-5bc9-4c4e-86fb-9ea952b5562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4a1d0>]}
[0m13:27:18.213919 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:27:18.225008 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:27:18.245193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:18.245540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:18.246190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:27:18.250557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '918f9553-5bc9-4c4e-86fb-9ea952b5562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032d8a0>]}
[0m13:27:18.256971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '918f9553-5bc9-4c4e-86fb-9ea952b5562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e8ac0>]}
[0m13:27:18.257360 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:27:18.257634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '918f9553-5bc9-4c4e-86fb-9ea952b5562d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e8a00>]}
[0m13:27:18.258614 [info ] [MainThread]: 
[0m13:27:18.259255 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:18.260165 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:27:18.268902 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:27:18.269287 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:27:18.269520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:18.273656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:18.274001 [debug] [MainThread]: Connection 'list_dev_database' was properly closed.
[0m13:27:18.274244 [info ] [MainThread]: 
[0m13:27:18.274510 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m13:27:18.274892 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/raajassode/dev/climate_works_dbt/./dev_database.duckdb": Resource temporarily unavailable
[0m13:27:18.276218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4658857, "process_user_time": 1.774738, "process_kernel_time": 0.135325, "process_mem_max_rss": "129925120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:27:18.276767 [debug] [MainThread]: Command `dbt run` failed at 13:27:18.276672 after 0.47 seconds
[0m13:27:18.277083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102e85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110367430>]}
[0m13:27:18.277397 [debug] [MainThread]: Flushing usage events
[0m13:27:38.941743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061078b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106107c70>]}


============================== 13:27:38.944233 | e75a46ce-b136-48cf-8b98-f6821d52d8cb ==============================
[0m13:27:38.944233 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:27:38.944665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'send_anonymous_usage_stats': 'True'}
[0m13:27:39.180351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e75a46ce-b136-48cf-8b98-f6821d52d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061079d0>]}
[0m13:27:39.278324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e75a46ce-b136-48cf-8b98-f6821d52d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061861d0>]}
[0m13:27:39.279002 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:27:39.290328 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:27:39.311116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:39.311484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:39.312022 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:27:39.316665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e75a46ce-b136-48cf-8b98-f6821d52d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b298a0>]}
[0m13:27:39.324396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e75a46ce-b136-48cf-8b98-f6821d52d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae4ac0>]}
[0m13:27:39.324847 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:27:39.325116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e75a46ce-b136-48cf-8b98-f6821d52d8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae4a00>]}
[0m13:27:39.326553 [info ] [MainThread]: 
[0m13:27:39.327317 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:39.328089 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:27:39.336629 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:27:39.337021 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:27:39.337266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:39.345001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:39.345350 [debug] [MainThread]: Connection 'list_dev_database' was properly closed.
[0m13:27:39.345588 [info ] [MainThread]: 
[0m13:27:39.345973 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m13:27:39.347028 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/raajassode/dev/climate_works_dbt/./dev_database.duckdb": Resource temporarily unavailable
[0m13:27:39.348617 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4594825, "process_user_time": 1.708797, "process_kernel_time": 0.118808, "process_mem_max_rss": "128876544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:27:39.349117 [debug] [MainThread]: Command `dbt run` failed at 13:27:39.349024 after 0.46 seconds
[0m13:27:39.349408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10317abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b63430>]}
[0m13:27:39.349688 [debug] [MainThread]: Flushing usage events
[0m13:27:52.988457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcbca0>]}


============================== 13:27:52.990798 | 94150b16-c3f0-4629-bdcc-8d14950f35ea ==============================
[0m13:27:52.990798 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:27:52.991221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:27:53.219778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcb9d0>]}
[0m13:27:53.317091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e839d0>]}
[0m13:27:53.317688 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:27:53.329044 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:27:53.349266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:53.349643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:53.350188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:27:53.355030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123298d0>]}
[0m13:27:53.362328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e49a0>]}
[0m13:27:53.362826 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:27:53.363172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e48b0>]}
[0m13:27:53.364660 [info ] [MainThread]: 
[0m13:27:53.365673 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:27:53.366604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:27:53.375005 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:27:53.375354 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:27:53.375586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:53.384535 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.385926 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:27:53.389077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:27:53.389706 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:27:53.394797 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:27:53.395174 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:27:53.395405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:53.404701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.405727 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:27:53.405964 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:27:53.406210 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.406409 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:27:53.406613 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:27:53.406917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.407431 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:27:53.407645 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:27:53.407837 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:27:53.408076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.408280 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:27:53.412013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:27:53.416316 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:27:53.416667 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:27:53.416881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:27:53.424765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.425103 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:27:53.425363 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:27:53.438393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:27:53.443472 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:27:53.444957 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:27:53.445186 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:27:53.459299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e4520>]}
[0m13:27:53.459663 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:53.459878 [debug] [MainThread]: On master: BEGIN
[0m13:27:53.460077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:53.466766 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:53.467053 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.467262 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:53.467465 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.467698 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:53.467920 [debug] [MainThread]: On master: Close
[0m13:27:53.470372 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:27:53.470703 [info ] [MainThread]: 
[0m13:27:53.472354 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:27:53.472779 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m13:27:53.473321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:27:53.473615 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:27:53.476095 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.476733 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:27:53.473784 => 13:27:53.476555
[0m13:27:53.477011 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:27:53.500695 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.501455 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.501747 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:27:53.502003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:53.509783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.510179 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.510517 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m13:27:53.511169 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.517537 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.517924 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:27:53.518400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.520509 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.520795 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.521153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.532247 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:27:53.532616 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.532883 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:27:53.533452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.536992 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:27:53.537282 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:27:53.537708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.538742 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:27:53.477167 => 13:27:53.538583
[0m13:27:53.539025 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:27:53.588813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f5d80>]}
[0m13:27:53.589375 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m13:27:53.589914 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:27:53.590542 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:27:53.590964 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m13:27:53.591442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m13:27:53.591709 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:27:53.593826 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.594792 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 13:27:53.591875 => 13:27:53.594579
[0m13:27:53.595107 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:27:53.599700 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.600347 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.600632 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m13:27:53.600880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:53.608730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.609105 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.609405 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag
    )
)


select * from pivoted
  );

[0m13:27:53.612018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.615176 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.615534 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m13:27:53.615971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.618021 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.618292 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m13:27:53.618630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.619815 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:27:53.620071 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.620306 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:27:53.620925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.624106 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:27:53.624410 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m13:27:53.624910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:27:53.625977 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 13:27:53.595278 => 13:27:53.625827
[0m13:27:53.626261 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m13:27:53.675049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94150b16-c3f0-4629-bdcc-8d14950f35ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11277d8d0>]}
[0m13:27:53.675605 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m13:27:53.676024 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:27:53.676899 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:53.677138 [debug] [MainThread]: On master: BEGIN
[0m13:27:53.677344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:53.684461 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:53.684786 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.684994 [debug] [MainThread]: Using duckdb connection "master"
[0m13:27:53.685200 [debug] [MainThread]: On master: COMMIT
[0m13:27:53.685426 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:27:53.685633 [debug] [MainThread]: On master: Close
[0m13:27:53.688661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:53.688985 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m13:27:53.689244 [info ] [MainThread]: 
[0m13:27:53.689494 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:27:53.690006 [debug] [MainThread]: Command end result
[0m13:27:53.732538 [info ] [MainThread]: 
[0m13:27:53.732886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:53.733106 [info ] [MainThread]: 
[0m13:27:53.733332 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:27:53.734474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7958374, "process_user_time": 2.0111, "process_kernel_time": 0.156101, "process_mem_max_rss": "187531264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:27:53.734857 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:53.734779 after 0.80 seconds
[0m13:27:53.735130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e53100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112777ee0>]}
[0m13:27:53.735405 [debug] [MainThread]: Flushing usage events
[0m13:54:03.385153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecfcd0>]}


============================== 13:54:03.388530 | 051ce505-0dd7-45c0-a457-5a64b1df2176 ==============================
[0m13:54:03.388530 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:54:03.388991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:03.737174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecfa00>]}
[0m13:54:03.833898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c8b0>]}
[0m13:54:03.835467 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:54:03.847311 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:54:03.877088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:03.877608 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m13:54:04.018961 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:54:04.022559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d00d0>]}
[0m13:54:04.031652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e4a00>]}
[0m13:54:04.032120 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:54:04.032411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e4910>]}
[0m13:54:04.033496 [info ] [MainThread]: 
[0m13:54:04.034163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:04.035029 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:54:04.043404 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:54:04.043794 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:54:04.044038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:04.064109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.066375 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:54:04.069397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:54:04.069963 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:54:04.075366 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:04.075731 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:54:04.075962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:04.084401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.085495 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:04.085755 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:54:04.086011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.086216 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:04.086424 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:54:04.086794 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.087317 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:54:04.087546 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:04.087743 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:54:04.087987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.088199 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:54:04.091123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:54:04.126759 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:54:04.127152 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:54:04.127373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:04.135188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.135485 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:54:04.135728 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:54:04.153160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:04.159549 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:54:04.160320 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:54:04.160589 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:54:04.174993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110106230>]}
[0m13:54:04.175363 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.175585 [debug] [MainThread]: On master: BEGIN
[0m13:54:04.175786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:04.182636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.182944 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.183160 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.183366 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.183598 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.183803 [debug] [MainThread]: On master: Close
[0m13:54:04.185996 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:54:04.186321 [info ] [MainThread]: 
[0m13:54:04.187960 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:04.188352 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m13:54:04.188844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:54:04.189111 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:04.191461 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.192307 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:54:04.189265 => 13:54:04.192145
[0m13:54:04.192585 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:04.216274 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.217235 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.217556 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:54:04.217820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:04.224773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.225116 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.225439 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m13:54:04.226484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.231691 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.232051 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:54:04.232467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.235198 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.235490 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.235842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.246537 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:54:04.246857 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.247115 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:54:04.247842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.251460 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:04.251770 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:54:04.252193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.253161 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:54:04.192742 => 13:54:04.253009
[0m13:54:04.253437 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:54:04.302089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107619510>]}
[0m13:54:04.302649 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m13:54:04.303076 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:04.303709 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:04.304207 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m13:54:04.304702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m13:54:04.304973 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:04.307143 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:04.307786 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 13:54:04.305135 => 13:54:04.307625
[0m13:54:04.308054 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:04.312569 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:04.313156 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:04.313416 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m13:54:04.313655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:04.321514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:04.321896 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:04.322205 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) as year,
        array_slice(reading_date,4,6) as month,
        array_slice(reading_date,6,8) as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source
)

select * from final
  );

[0m13:54:04.325272 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 13:54:04.308207 => 13:54:04.325030
[0m13:54:04.325640 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: ROLLBACK
[0m13:54:04.329729 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.stg_daily_climate_parameters'
[0m13:54:04.330097 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m13:54:04.333724 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: No function matches the given name and argument types 'make_date(VARCHAR, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	make_date(BIGINT, BIGINT, BIGINT) -> DATE
  	make_date(STRUCT("year" BIGINT, "month" BIGINT, "day" BIGINT)) -> DATE
  
[0m13:54:04.334116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '051ce505-0dd7-45c0-a457-5a64b1df2176', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107619db0>]}
[0m13:54:04.334566 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model dev_sode.stg_daily_climate_parameters ..... [[31mERROR[0m in 0.03s]
[0m13:54:04.334987 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:04.335940 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.336172 [debug] [MainThread]: On master: BEGIN
[0m13:54:04.336373 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:04.344499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.344900 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.345139 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:04.345354 [debug] [MainThread]: On master: COMMIT
[0m13:54:04.345604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:04.345814 [debug] [MainThread]: On master: Close
[0m13:54:04.348394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:04.348711 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m13:54:04.348980 [info ] [MainThread]: 
[0m13:54:04.349232 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:54:04.349800 [debug] [MainThread]: Command end result
[0m13:54:04.355288 [info ] [MainThread]: 
[0m13:54:04.355640 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:54:04.355978 [info ] [MainThread]: 
[0m13:54:04.356264 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters (models/staging/stg_daily_climate_parameters.sql)
  Binder Error: No function matches the given name and argument types 'make_date(VARCHAR, VARCHAR, VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	make_date(BIGINT, BIGINT, BIGINT) -> DATE
  	make_date(STRUCT("year" BIGINT, "month" BIGINT, "day" BIGINT)) -> DATE
  
[0m13:54:04.356520 [info ] [MainThread]: 
[0m13:54:04.356761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m13:54:04.358585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0284423, "process_user_time": 2.165805, "process_kernel_time": 0.228743, "process_mem_max_rss": "197148672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:04.359113 [debug] [MainThread]: Command `dbt run` failed at 13:54:04.359018 after 1.03 seconds
[0m13:54:04.359431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ecfa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110114e80>]}
[0m13:54:04.359801 [debug] [MainThread]: Flushing usage events
[0m13:54:53.917108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cfd30>]}


============================== 13:54:53.920415 | b8310f5b-c764-4d32-bdc3-3e9834c94818 ==============================
[0m13:54:53.920415 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:54:53.920846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:54.200282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac0ee60>]}
[0m13:54:54.297958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac80730>]}
[0m13:54:54.299003 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:54:54.310325 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:54:54.336294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:54.336821 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m13:54:54.473972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:54:54.477560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2d4100>]}
[0m13:54:54.484234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e4b80>]}
[0m13:54:54.484705 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:54:54.484992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0e4a30>]}
[0m13:54:54.486141 [info ] [MainThread]: 
[0m13:54:54.486995 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:54:54.487958 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:54:54.496091 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:54:54.496509 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:54:54.496764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:54.512388 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.514219 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:54:54.517254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:54:54.517785 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:54:54.523100 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:54.523440 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:54:54.523665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:54.531872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.532950 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:54.533200 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:54:54.533463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.533664 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:54.533869 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:54:54.534204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.534734 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:54:54.534952 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:54:54.535147 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:54:54.535393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.535599 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:54:54.538591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:54:54.575227 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:54:54.575611 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:54:54.575825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:54.583327 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.583632 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:54:54.583873 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:54:54.598375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:54:54.604013 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:54:54.604748 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:54:54.604978 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:54:54.619306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30e260>]}
[0m13:54:54.619676 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:54.619894 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.620094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:54.626972 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:54.627430 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.627692 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:54.627914 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.628213 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:54.628431 [debug] [MainThread]: On master: Close
[0m13:54:54.630486 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:54:54.630810 [info ] [MainThread]: 
[0m13:54:54.632386 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:54.632787 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m13:54:54.633308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:54:54.633592 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:54.636129 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.636714 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:54:54.633785 => 13:54:54.636554
[0m13:54:54.636999 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:54.660718 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.661490 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.661770 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:54:54.662019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.669642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.670037 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.670380 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m13:54:54.671259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.676880 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.677271 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:54:54.678085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.681076 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.681394 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.681823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.693079 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:54:54.693451 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.693725 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:54:54.694362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.698443 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:54:54.698757 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:54:54.699309 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.700539 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:54:54.637157 => 13:54:54.700368
[0m13:54:54.700848 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:54:54.751176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b119f00>]}
[0m13:54:54.751789 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m13:54:54.752226 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:54:54.752851 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:54.753255 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m13:54:54.753772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m13:54:54.754070 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:54.756245 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.756915 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 13:54:54.754228 => 13:54:54.756758
[0m13:54:54.757182 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:54.761841 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.762522 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.762784 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m13:54:54.763021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:54.770551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.770932 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.771252 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,4,6) ::INTEGER as month,
        array_slice(reading_date,6,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source
)

select * from final
  );

[0m13:54:54.772048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.775194 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.775574 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m13:54:54.776066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.778465 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.778788 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m13:54:54.779166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.780450 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:54:54.780708 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.780946 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:54:54.781445 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.783327 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:54:54.783605 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m13:54:54.784027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:54.784969 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 13:54:54.757339 => 13:54:54.784821
[0m13:54:54.785246 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m13:54:54.835538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8310f5b-c764-4d32-bdc3-3e9834c94818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b119600>]}
[0m13:54:54.836102 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m13:54:54.836518 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:54:54.837448 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:54.837758 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.837971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:54.845356 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:54.845765 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.846016 [debug] [MainThread]: Using duckdb connection "master"
[0m13:54:54.846250 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.846543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:54:54.846758 [debug] [MainThread]: On master: Close
[0m13:54:54.849098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:54.849371 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m13:54:54.849660 [info ] [MainThread]: 
[0m13:54:54.849933 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:54:54.850453 [debug] [MainThread]: Command end result
[0m13:54:54.856513 [info ] [MainThread]: 
[0m13:54:54.856853 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:54.857082 [info ] [MainThread]: 
[0m13:54:54.857313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:54:54.859043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99591446, "process_user_time": 2.205451, "process_kernel_time": 0.186575, "process_mem_max_rss": "183435264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:54.859617 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:54.859501 after 1.00 seconds
[0m13:54:54.859928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0cfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b318ee0>]}
[0m13:54:54.860218 [debug] [MainThread]: Flushing usage events
[0m13:57:18.026480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c478b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c47ca0>]}


============================== 13:57:18.028849 | 2be02841-799d-480a-86f5-5b02187068fb ==============================
[0m13:57:18.028849 [info ] [MainThread]: Running with dbt=1.7.6
[0m13:57:18.029271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:18.259986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c479d0>]}
[0m13:57:18.357456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dff9d0>]}
[0m13:57:18.358036 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m13:57:18.368394 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m13:57:18.388797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:18.389336 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m13:57:18.525671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:57:18.529205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073500d0>]}
[0m13:57:18.535179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071609a0>]}
[0m13:57:18.535608 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:57:18.535892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071608b0>]}
[0m13:57:18.536843 [info ] [MainThread]: 
[0m13:57:18.537421 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:57:18.538186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:57:18.545926 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:57:18.546236 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:57:18.546466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:18.555467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.556752 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:57:18.559366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:57:18.559909 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:57:18.564882 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:57:18.565184 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m13:57:18.565407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:18.573413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.574530 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:57:18.574784 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:57:18.575043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.575249 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:57:18.575464 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m13:57:18.575738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.576263 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:57:18.576483 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:57:18.576684 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:57:18.576934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.577140 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:57:18.580257 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:57:18.615808 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:57:18.616170 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:57:18.616385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:18.623574 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.623892 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:57:18.624145 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:57:18.637391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:18.642559 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:57:18.643051 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:57:18.643279 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:57:18.657890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738a1d0>]}
[0m13:57:18.658298 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:18.658538 [debug] [MainThread]: On master: BEGIN
[0m13:57:18.658759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:18.666635 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:18.666958 [debug] [MainThread]: On master: COMMIT
[0m13:57:18.667177 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:18.667385 [debug] [MainThread]: On master: COMMIT
[0m13:57:18.667624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:18.667841 [debug] [MainThread]: On master: Close
[0m13:57:18.669986 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:57:18.670246 [info ] [MainThread]: 
[0m13:57:18.671593 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:18.671957 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m13:57:18.672439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:57:18.672724 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:18.675112 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.675767 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:57:18.672892 => 13:57:18.675605
[0m13:57:18.676042 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:18.699399 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.700125 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.700415 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:57:18.700670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:18.707972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.708343 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.708670 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m13:57:18.709369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.714610 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.714939 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:57:18.715507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.718695 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.719002 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.719371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.730881 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:57:18.731226 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.731490 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:57:18.732113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.736088 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:18.736412 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:57:18.736920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.737943 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:57:18.676203 => 13:57:18.737783
[0m13:57:18.738233 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:57:18.785968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734e620>]}
[0m13:57:18.786588 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m13:57:18.787036 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:18.787613 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:57:18.787999 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m13:57:18.788488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m13:57:18.788764 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:57:18.790833 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.791757 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 13:57:18.788926 => 13:57:18.791578
[0m13:57:18.792041 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:57:18.796552 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.797357 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.797630 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m13:57:18.798070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:18.805853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.806240 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.806561 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source
)

select * from final
  );

[0m13:57:18.807370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.810527 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.810875 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m13:57:18.811290 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.813339 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.813638 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m13:57:18.813991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.815372 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:57:18.815725 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.815999 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:57:18.816584 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.818590 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:57:18.818873 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m13:57:18.819330 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:18.820294 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 13:57:18.792206 => 13:57:18.820148
[0m13:57:18.820568 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m13:57:18.868626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2be02841-799d-480a-86f5-5b02187068fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107457100>]}
[0m13:57:18.869230 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m13:57:18.869659 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:57:18.870598 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:18.870856 [debug] [MainThread]: On master: BEGIN
[0m13:57:18.871065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:18.878320 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:18.878682 [debug] [MainThread]: On master: COMMIT
[0m13:57:18.878911 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:18.879116 [debug] [MainThread]: On master: COMMIT
[0m13:57:18.879367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:18.879592 [debug] [MainThread]: On master: Close
[0m13:57:18.881921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:18.882174 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m13:57:18.882427 [info ] [MainThread]: 
[0m13:57:18.882671 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:57:18.883190 [debug] [MainThread]: Command end result
[0m13:57:18.889291 [info ] [MainThread]: 
[0m13:57:18.889619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:18.889845 [info ] [MainThread]: 
[0m13:57:18.890081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:57:18.891233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.91489345, "process_user_time": 2.135529, "process_kernel_time": 0.154568, "process_mem_max_rss": "196853760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:57:18.891627 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:18.891547 after 0.92 seconds
[0m13:57:18.891896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a92bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107221210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107394ca0>]}
[0m13:57:18.892176 [debug] [MainThread]: Flushing usage events
[0m16:19:54.409707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078678b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107867c70>]}


============================== 16:19:54.412882 | f496194c-c245-4225-9d60-48241cc25b46 ==============================
[0m16:19:54.412882 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:19:54.413333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:19:54.748857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078679d0>]}
[0m16:19:54.846370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e61d0>]}
[0m16:19:54.847916 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:19:54.859350 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:19:54.886888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:54.887403 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m16:19:55.023176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:19:55.026749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f680d0>]}
[0m16:19:55.033833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d80ac0>]}
[0m16:19:55.034288 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:19:55.034599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d80a00>]}
[0m16:19:55.035641 [info ] [MainThread]: 
[0m16:19:55.036265 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:55.037055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:19:55.044941 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:19:55.045329 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:19:55.045565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:55.059963 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.061815 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:19:55.064842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:19:55.065410 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:19:55.070574 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:19:55.070869 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:19:55.071091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:55.079235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.080301 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:19:55.080553 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:19:55.080806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.081008 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:19:55.081216 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:19:55.081526 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.082039 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:19:55.082270 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:19:55.082479 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:19:55.082730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.082942 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:19:55.085743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:19:55.121202 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:19:55.121585 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:19:55.121809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:55.129028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.129320 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:19:55.129563 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:19:55.144095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:19:55.149876 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:19:55.150696 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:19:55.150921 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:19:55.164975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa21a0>]}
[0m16:19:55.165355 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:55.165583 [debug] [MainThread]: On master: BEGIN
[0m16:19:55.165791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:55.173120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:55.173433 [debug] [MainThread]: On master: COMMIT
[0m16:19:55.173650 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:55.173861 [debug] [MainThread]: On master: COMMIT
[0m16:19:55.174095 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:55.174307 [debug] [MainThread]: On master: Close
[0m16:19:55.176404 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:19:55.176669 [info ] [MainThread]: 
[0m16:19:55.178294 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:19:55.178682 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:19:55.179197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:19:55.179481 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:19:55.181860 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.182497 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:19:55.179645 => 16:19:55.182332
[0m16:19:55.182777 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:19:55.206378 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.207345 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.207652 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:19:55.207923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:55.215197 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.215588 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.215916 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:19:55.216788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.222107 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.222572 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:19:55.223087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.226194 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.226560 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.227057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.238663 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:19:55.239031 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.239304 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:19:55.239973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.244015 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:19:55.244326 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:19:55.244803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.245848 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:19:55.182934 => 16:19:55.245687
[0m16:19:55.246134 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:19:55.293961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db42e0>]}
[0m16:19:55.294541 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m16:19:55.295084 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:19:55.295647 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:19:55.296091 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:19:55.296609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:19:55.296904 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:19:55.299065 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.300205 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:19:55.297072 => 16:19:55.300034
[0m16:19:55.300497 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:19:55.305281 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.305920 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.306186 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:19:55.306428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:55.314297 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.314697 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.314997 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag
    )
)


select * from pivoted
  );

[0m16:19:55.316715 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.319799 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.320140 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m16:19:55.320636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.323035 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.323345 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:19:55.323761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.325018 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:19:55.325283 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.325526 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:19:55.326145 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.328368 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:19:55.328806 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:19:55.329363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.330540 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:19:55.300665 => 16:19:55.330356
[0m16:19:55.330846 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:19:55.378858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080731c0>]}
[0m16:19:55.379448 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m16:19:55.379884 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:19:55.380194 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:19:55.380552 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:19:55.381007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:19:55.381267 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:19:55.384359 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.385319 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:19:55.381420 => 16:19:55.385162
[0m16:19:55.385582 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:19:55.390330 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.390997 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.391268 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:19:55.391515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:55.399022 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.399516 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.399919 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN')
)

select * from final
  );

[0m16:19:55.400810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.403871 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.404202 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:19:55.404587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.406797 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.407081 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:19:55.407422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.408666 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:19:55.408913 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.409147 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:19:55.409834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.411945 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:19:55.412246 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:19:55.412659 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:19:55.413651 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:19:55.385738 => 16:19:55.413505
[0m16:19:55.413922 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:19:55.462273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f496194c-c245-4225-9d60-48241cc25b46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffdf00>]}
[0m16:19:55.462855 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:19:55.463282 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:19:55.464260 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:55.464530 [debug] [MainThread]: On master: BEGIN
[0m16:19:55.464749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:55.471956 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:55.472361 [debug] [MainThread]: On master: COMMIT
[0m16:19:55.472586 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:55.472801 [debug] [MainThread]: On master: COMMIT
[0m16:19:55.473044 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:19:55.473259 [debug] [MainThread]: On master: Close
[0m16:19:55.475638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:55.475993 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m16:19:55.476277 [info ] [MainThread]: 
[0m16:19:55.476536 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m16:19:55.477133 [debug] [MainThread]: Command end result
[0m16:19:55.482492 [info ] [MainThread]: 
[0m16:19:55.482835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:55.483068 [info ] [MainThread]: 
[0m16:19:55.483301 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:19:55.484863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1286902, "process_user_time": 2.218924, "process_kernel_time": 0.207174, "process_mem_max_rss": "197885952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:19:55.485385 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:55.485291 after 1.13 seconds
[0m16:19:55.485663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffdf00>]}
[0m16:19:55.485948 [debug] [MainThread]: Flushing usage events
[0m16:24:54.341433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d938b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d93cd0>]}


============================== 16:24:54.344081 | 10fca3cd-e9d3-480b-8979-eaa89ad36893 ==============================
[0m16:24:54.344081 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:24:54.344495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters+', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:54.579649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d939d0>]}
[0m16:24:54.676949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e6bc0>]}
[0m16:24:54.678058 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:24:54.689961 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:24:54.716590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:54.716979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:54.717520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:24:54.722003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f1900>]}
[0m16:24:54.728915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092acb20>]}
[0m16:24:54.729377 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:24:54.729651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ac9d0>]}
[0m16:24:54.730824 [info ] [MainThread]: 
[0m16:24:54.731666 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:24:54.732432 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:24:54.741391 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:24:54.741781 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:24:54.742018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:54.751396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.752660 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:24:54.755215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:24:54.755721 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:24:54.760437 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:24:54.760728 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:24:54.760944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:54.769403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.770528 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:24:54.770795 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:24:54.771047 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.771246 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:24:54.771451 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:24:54.771762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.772413 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:24:54.772680 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:24:54.772906 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:24:54.773224 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.773476 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:24:54.776674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:24:54.780658 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:24:54.780932 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:24:54.781143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:54.788722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.789049 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:24:54.789293 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:24:54.802525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:54.807620 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:24:54.809374 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:24:54.809634 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:24:54.823657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931f160>]}
[0m16:24:54.824004 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:54.824224 [debug] [MainThread]: On master: BEGIN
[0m16:24:54.824426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:54.831677 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:54.831984 [debug] [MainThread]: On master: COMMIT
[0m16:24:54.832201 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:54.832425 [debug] [MainThread]: On master: COMMIT
[0m16:24:54.832669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:54.832875 [debug] [MainThread]: On master: Close
[0m16:24:54.834915 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:24:54.835170 [info ] [MainThread]: 
[0m16:24:54.836709 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:24:54.837081 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:24:54.837557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:24:54.837833 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:24:54.839994 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.840579 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:24:54.837997 => 16:24:54.840423
[0m16:24:54.840841 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:24:54.863861 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.864598 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.864874 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:24:54.865122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:54.872661 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.873043 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.873376 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN')
)

select * from final
  );

[0m16:24:54.874339 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.880867 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.881256 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:24:54.881687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.883843 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.884121 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:24:54.884473 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.895811 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:24:54.896216 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.896480 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:24:54.897091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.900679 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:24:54.900971 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:24:54.901398 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:54.902405 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:24:54.840993 => 16:24:54.902249
[0m16:24:54.902676 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:24:54.951967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10fca3cd-e9d3-480b-8979-eaa89ad36893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929b130>]}
[0m16:24:54.952567 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m16:24:54.953001 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:24:54.953900 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:54.954154 [debug] [MainThread]: On master: BEGIN
[0m16:24:54.954356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:54.961207 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:54.961506 [debug] [MainThread]: On master: COMMIT
[0m16:24:54.961715 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:54.961912 [debug] [MainThread]: On master: COMMIT
[0m16:24:54.962140 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:54.962342 [debug] [MainThread]: On master: Close
[0m16:24:54.964659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:54.964970 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m16:24:54.965219 [info ] [MainThread]: 
[0m16:24:54.965464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m16:24:54.965899 [debug] [MainThread]: Command end result
[0m16:24:54.970919 [info ] [MainThread]: 
[0m16:24:54.971210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:54.971434 [info ] [MainThread]: 
[0m16:24:54.971680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:24:54.973201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6824065, "process_user_time": 1.904468, "process_kernel_time": 0.161564, "process_mem_max_rss": "171458560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:54.973755 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:54.973668 after 0.68 seconds
[0m16:24:54.974083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093b10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109314520>]}
[0m16:24:54.974362 [debug] [MainThread]: Flushing usage events
[0m16:25:08.711870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cbcd0>]}


============================== 16:25:08.714400 | 89319d1d-650e-4477-99e9-5217e7a8c669 ==============================
[0m16:25:08.714400 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:25:08.714820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:08.946306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cb9d0>]}
[0m16:25:09.042519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791ebc0>]}
[0m16:25:09.043121 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:25:09.053805 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:25:09.073416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:09.073758 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:09.074277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:25:09.078710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c29900>]}
[0m16:25:09.085684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4b20>]}
[0m16:25:09.086102 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:25:09.086363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be49d0>]}
[0m16:25:09.087328 [info ] [MainThread]: 
[0m16:25:09.087878 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:25:09.088789 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:25:09.097188 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:25:09.097533 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:25:09.097763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:09.106569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.107938 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:25:09.110722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:25:09.111380 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:25:09.116384 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:09.116728 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:25:09.116967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:09.125000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.126030 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:09.126275 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:25:09.126537 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.126737 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:09.126943 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:25:09.127213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.127715 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:25:09.127930 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:09.128120 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:25:09.128362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.128560 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:25:09.131577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:25:09.135558 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:25:09.135857 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:25:09.136079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:09.143700 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.144041 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:25:09.144286 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:25:09.157498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:09.162676 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:25:09.163153 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:25:09.163382 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:25:09.177481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c47160>]}
[0m16:25:09.177810 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:09.178031 [debug] [MainThread]: On master: BEGIN
[0m16:25:09.178235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:09.185217 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:09.185520 [debug] [MainThread]: On master: COMMIT
[0m16:25:09.185744 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:09.185944 [debug] [MainThread]: On master: COMMIT
[0m16:25:09.186196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:09.186416 [debug] [MainThread]: On master: Close
[0m16:25:09.188414 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:25:09.188692 [info ] [MainThread]: 
[0m16:25:09.189988 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:09.190357 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:25:09.190825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:25:09.191099 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:09.193487 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.194143 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:25:09.191260 => 16:25:09.193973
[0m16:25:09.194425 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:09.218992 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.219747 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.220175 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:25:09.220507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:09.227869 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.228252 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.228588 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:25:09.229210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.235393 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.235748 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:25:09.236151 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.238205 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.238485 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.238825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.249971 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:25:09.250523 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.250809 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:25:09.251393 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.255280 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:09.255587 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:25:09.256134 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.257223 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:25:09.194586 => 16:25:09.257064
[0m16:25:09.257512 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:25:09.306492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcf130>]}
[0m16:25:09.307078 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.12s]
[0m16:25:09.307500 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:09.308029 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:09.308412 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:25:09.308879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:25:09.309149 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:09.311257 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.311868 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:25:09.309305 => 16:25:09.311706
[0m16:25:09.312145 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:09.316837 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.317478 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.317747 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:25:09.317991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:09.325581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.325945 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.326252 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN')
)

select * from final
  );

[0m16:25:09.327057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.329962 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.330245 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:25:09.330591 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.332618 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.332900 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:25:09.333509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.335087 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:25:09.335392 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.335652 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:25:09.336188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.339158 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:09.339478 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:25:09.339944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:09.341038 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:25:09.312304 => 16:25:09.340880
[0m16:25:09.341351 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:25:09.389941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89319d1d-650e-4477-99e9-5217e7a8c669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7d900>]}
[0m16:25:09.390533 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:25:09.390956 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:09.391859 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:09.392093 [debug] [MainThread]: On master: BEGIN
[0m16:25:09.392287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:09.399856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:09.400216 [debug] [MainThread]: On master: COMMIT
[0m16:25:09.400433 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:09.400769 [debug] [MainThread]: On master: COMMIT
[0m16:25:09.401136 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:09.401363 [debug] [MainThread]: On master: Close
[0m16:25:09.403677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:09.404012 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m16:25:09.404276 [info ] [MainThread]: 
[0m16:25:09.404523 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:25:09.405027 [debug] [MainThread]: Command end result
[0m16:25:09.444474 [info ] [MainThread]: 
[0m16:25:09.444818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:09.445041 [info ] [MainThread]: 
[0m16:25:09.445275 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:25:09.446393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.78434074, "process_user_time": 2.001073, "process_kernel_time": 0.147287, "process_mem_max_rss": "185319424", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:09.446782 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:09.446701 after 0.78 seconds
[0m16:25:09.447045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e755a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e74910>]}
[0m16:25:09.447309 [debug] [MainThread]: Flushing usage events
[0m16:25:47.855521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280bcd0>]}


============================== 16:25:47.858122 | 00a1dc7a-4e80-460b-a23a-65bc1edf54b3 ==============================
[0m16:25:47.858122 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:25:47.858547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'send_anonymous_usage_stats': 'True'}
[0m16:25:48.086932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280ba00>]}
[0m16:25:48.183411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7c8b0>]}
[0m16:25:48.184009 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:25:48.194568 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:25:48.214582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:25:48.215054 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m16:25:48.348173 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:25:48.351640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ad40d0>]}
[0m16:25:48.357836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e4a00>]}
[0m16:25:48.358209 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:25:48.358469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e4910>]}
[0m16:25:48.359460 [info ] [MainThread]: 
[0m16:25:48.360026 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:25:48.360927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:25:48.368895 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:25:48.369243 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:25:48.369476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:48.378000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.379217 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:25:48.381877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:25:48.382373 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:25:48.387338 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:48.387654 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:25:48.387895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:48.396014 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.397084 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:48.397333 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:25:48.397586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.397786 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:48.397991 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:25:48.398264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.398785 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:25:48.399000 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:25:48.399199 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:25:48.399442 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.399646 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:25:48.402440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:25:48.436776 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:25:48.437141 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:25:48.437353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:48.444998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.445300 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:25:48.445541 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:25:48.458829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:25:48.464012 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:25:48.464494 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:25:48.464721 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:25:48.478976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0e230>]}
[0m16:25:48.479370 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:48.479597 [debug] [MainThread]: On master: BEGIN
[0m16:25:48.479796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:48.486963 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:48.487265 [debug] [MainThread]: On master: COMMIT
[0m16:25:48.487486 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:48.487688 [debug] [MainThread]: On master: COMMIT
[0m16:25:48.487928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:48.488137 [debug] [MainThread]: On master: Close
[0m16:25:48.490063 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:25:48.490347 [info ] [MainThread]: 
[0m16:25:48.491794 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:48.492263 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:25:48.492779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:25:48.493059 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:48.495485 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.496135 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:25:48.493218 => 16:25:48.495971
[0m16:25:48.496408 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:48.519455 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.520130 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.520405 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:25:48.520655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:48.528094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.528465 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.528793 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:25:48.529422 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.534956 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.535388 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:25:48.535892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.539181 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.539565 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.539996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.551419 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:25:48.551848 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.552123 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:25:48.552753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.556341 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:25:48.556652 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:25:48.557090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.558107 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:25:48.496563 => 16:25:48.557950
[0m16:25:48.558397 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:25:48.606412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139193f0>]}
[0m16:25:48.606977 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m16:25:48.607404 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:25:48.607919 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:48.608309 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:25:48.608800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:25:48.609081 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:48.611187 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.611798 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:25:48.609243 => 16:25:48.611620
[0m16:25:48.612105 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:48.617313 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.618039 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.618315 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:25:48.618562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:48.625978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.626341 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.626649 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as record_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN')
)

select * from final
  );

[0m16:25:48.627469 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.630462 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.630751 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:25:48.631104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.633306 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.633738 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:25:48.634216 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.635591 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:25:48.635894 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.636139 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:25:48.636742 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.638923 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:25:48.639243 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:25:48.639698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.640799 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:25:48.612274 => 16:25:48.640647
[0m16:25:48.641089 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:25:48.690655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113919930>]}
[0m16:25:48.691232 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:25:48.691657 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:25:48.692163 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:25:48.692579 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:25:48.693071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:25:48.693347 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:25:48.696544 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:25:48.697167 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:25:48.693514 => 16:25:48.697010
[0m16:25:48.697438 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:25:48.701873 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:25:48.702557 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:25:48.702947 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:25:48.703217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:25:48.710348 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:25:48.710696 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:25:48.711000 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag
    )
)


select * from pivoted
  );

[0m16:25:48.714337 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:25:48.697594 => 16:25:48.714119
[0m16:25:48.714689 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m16:25:48.718353 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m16:25:48.718629 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:25:48.721381 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "reading_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters.reading_type", "stg_daily_climate_parameters.reading_value"
[0m16:25:48.721761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00a1dc7a-4e80-460b-a23a-65bc1edf54b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cb4c40>]}
[0m16:25:48.722219 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.03s]
[0m16:25:48.722624 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:25:48.723573 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:48.723865 [debug] [MainThread]: On master: BEGIN
[0m16:25:48.724073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:48.731175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:48.731580 [debug] [MainThread]: On master: COMMIT
[0m16:25:48.731797 [debug] [MainThread]: Using duckdb connection "master"
[0m16:25:48.731998 [debug] [MainThread]: On master: COMMIT
[0m16:25:48.732267 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:25:48.732474 [debug] [MainThread]: On master: Close
[0m16:25:48.734705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:48.735049 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m16:25:48.735349 [info ] [MainThread]: 
[0m16:25:48.735607 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:25:48.736298 [debug] [MainThread]: Command end result
[0m16:25:48.742255 [info ] [MainThread]: 
[0m16:25:48.742608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:48.742829 [info ] [MainThread]: 
[0m16:25:48.743050 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "reading_date" not found in FROM clause!
  Candidate bindings: "stg_daily_climate_parameters.reading_type", "stg_daily_climate_parameters.reading_value"
[0m16:25:48.743269 [info ] [MainThread]: 
[0m16:25:48.743489 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:25:48.744850 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.93970394, "process_user_time": 2.144386, "process_kernel_time": 0.159185, "process_mem_max_rss": "195510272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:25:48.745342 [debug] [MainThread]: Command `dbt run` failed at 16:25:48.745252 after 0.94 seconds
[0m16:25:48.745639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072c2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138cfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c198a0>]}
[0m16:25:48.745918 [debug] [MainThread]: Flushing usage events
[0m16:26:38.857645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b7c70>]}


============================== 16:26:38.860146 | 2500343d-537d-43b5-a4ce-278b0e857623 ==============================
[0m16:26:38.860146 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:26:38.860565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:26:39.088025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b79d0>]}
[0m16:26:39.184811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072361d0>]}
[0m16:26:39.185424 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:26:39.196127 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:26:39.215963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:26:39.216558 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters.sql
[0m16:26:39.351262 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:26:39.354792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d00d0>]}
[0m16:26:39.360943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e4ac0>]}
[0m16:26:39.361326 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:26:39.361597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e4a00>]}
[0m16:26:39.362642 [info ] [MainThread]: 
[0m16:26:39.363357 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:26:39.364237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:26:39.372194 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:26:39.372553 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:26:39.372791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:39.381677 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.382944 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:26:39.386032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:26:39.386563 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:26:39.392137 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:26:39.392537 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:26:39.392767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.401071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.402149 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:26:39.402411 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:26:39.402661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.402866 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:26:39.403078 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:26:39.403356 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.403951 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:26:39.404236 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:26:39.404460 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:26:39.404761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.404980 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:26:39.407925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:26:39.442511 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:26:39.442876 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:26:39.443093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.450285 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.450585 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:26:39.450829 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:26:39.463998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:26:39.469220 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:26:39.469698 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:26:39.469923 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:26:39.484258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b061a0>]}
[0m16:26:39.484645 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:39.484872 [debug] [MainThread]: On master: BEGIN
[0m16:26:39.485074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:39.492952 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:39.493276 [debug] [MainThread]: On master: COMMIT
[0m16:26:39.493493 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:39.493696 [debug] [MainThread]: On master: COMMIT
[0m16:26:39.493932 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:39.494144 [debug] [MainThread]: On master: Close
[0m16:26:39.496449 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:26:39.496806 [info ] [MainThread]: 
[0m16:26:39.498219 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:26:39.498641 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:26:39.499183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:26:39.499469 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:26:39.501851 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.502459 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:26:39.499632 => 16:26:39.502298
[0m16:26:39.502725 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:26:39.526389 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.527083 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.527367 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:26:39.527626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:39.535295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.535668 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.535996 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:26:39.536615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.541817 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.542166 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:26:39.542569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.545473 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.545858 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.546298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.557579 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:26:39.557953 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.558215 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:26:39.558781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.562346 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:26:39.562647 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:26:39.563087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.564129 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:26:39.502891 => 16:26:39.563968
[0m16:26:39.564436 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:26:39.613495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078182e0>]}
[0m16:26:39.614040 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m16:26:39.614468 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:26:39.615005 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:26:39.615404 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:26:39.615881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:26:39.616152 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:26:39.618227 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.618921 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:26:39.616304 => 16:26:39.618650
[0m16:26:39.619270 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:26:39.623837 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.624505 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.624775 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:26:39.625015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:39.632306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.632674 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.633003 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m16:26:39.633852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.636847 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.637143 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:26:39.637674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.639999 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.640299 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:26:39.640695 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.641991 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:26:39.642253 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.642492 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:26:39.643107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.645162 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:26:39.645456 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:26:39.645915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.646905 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:26:39.619434 => 16:26:39.646758
[0m16:26:39.647195 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:26:39.695635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781a1a0>]}
[0m16:26:39.696193 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:26:39.696613 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:26:39.697174 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:26:39.697510 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:26:39.697973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:26:39.698238 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:26:39.701300 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.701958 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:26:39.698400 => 16:26:39.701730
[0m16:26:39.702278 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:26:39.706762 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.707314 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.707812 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:26:39.708085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:39.715414 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.715791 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.716087 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag
    )
)


select * from pivoted
  );

[0m16:26:39.717878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.720935 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.721261 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m16:26:39.721658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.724139 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.724501 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:26:39.724936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.726292 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:26:39.726568 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.726819 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:26:39.727372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.729264 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:26:39.729532 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:26:39.729964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:39.730873 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:26:39.702435 => 16:26:39.730729
[0m16:26:39.731138 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:26:39.778982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2500343d-537d-43b5-a4ce-278b0e857623', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cf130>]}
[0m16:26:39.779613 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m16:26:39.780038 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:26:39.780949 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:39.781214 [debug] [MainThread]: On master: BEGIN
[0m16:26:39.781426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:39.788550 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:39.788901 [debug] [MainThread]: On master: COMMIT
[0m16:26:39.789132 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:39.789342 [debug] [MainThread]: On master: COMMIT
[0m16:26:39.789588 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:39.789805 [debug] [MainThread]: On master: Close
[0m16:26:39.792141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:39.792450 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m16:26:39.792717 [info ] [MainThread]: 
[0m16:26:39.792977 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:26:39.793606 [debug] [MainThread]: Command end result
[0m16:26:39.798983 [info ] [MainThread]: 
[0m16:26:39.799309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:39.799535 [info ] [MainThread]: 
[0m16:26:39.799766 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:26:39.800867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9943737, "process_user_time": 2.198125, "process_kernel_time": 0.155263, "process_mem_max_rss": "198918144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:39.801257 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:39.801174 after 0.99 seconds
[0m16:26:39.801531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b79d0>]}
[0m16:26:39.801809 [debug] [MainThread]: Flushing usage events
[0m16:30:50.556524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cbd30>]}


============================== 16:30:50.560235 | c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269 ==============================
[0m16:30:50.560235 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:30:50.560680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:30:50.864393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930ee60>]}
[0m16:30:50.969978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937c730>]}
[0m16:30:50.971232 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:30:50.982805 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:30:51.009465 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:30:51.009982 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m16:30:51.145386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:30:51.148897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d4100>]}
[0m16:30:51.155634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e4b80>]}
[0m16:30:51.156107 [info ] [MainThread]: Found 2 seeds, 3 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:30:51.156432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e4a30>]}
[0m16:30:51.157491 [info ] [MainThread]: 
[0m16:30:51.158047 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:30:51.158841 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:30:51.166863 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:30:51.167249 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:30:51.167498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:51.182247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.184200 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:30:51.187631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:30:51.188167 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:30:51.193171 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:30:51.193448 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:30:51.193680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:51.201989 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.203027 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:30:51.203271 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:30:51.203532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.203732 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:30:51.203945 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:30:51.204272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.204793 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:30:51.205013 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:30:51.205208 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:30:51.205452 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.205658 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:30:51.208539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:30:51.244422 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:30:51.244798 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:30:51.245024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:51.252500 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.252794 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:30:51.253034 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:30:51.267679 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:30:51.273560 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:30:51.274461 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:30:51.274724 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:30:51.289282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0a260>]}
[0m16:30:51.289652 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:51.289864 [debug] [MainThread]: On master: BEGIN
[0m16:30:51.290069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:51.297089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:51.297398 [debug] [MainThread]: On master: COMMIT
[0m16:30:51.297608 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:51.297813 [debug] [MainThread]: On master: COMMIT
[0m16:30:51.298052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:51.298257 [debug] [MainThread]: On master: Close
[0m16:30:51.300360 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:30:51.300675 [info ] [MainThread]: 
[0m16:30:51.302329 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:30:51.302721 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:30:51.303212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:30:51.303475 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:30:51.305872 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.306574 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:30:51.303629 => 16:30:51.306335
[0m16:30:51.306907 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:30:51.330061 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.330783 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.331067 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:30:51.331328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:51.339093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.339486 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.339821 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:30:51.340790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.346021 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.346356 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:30:51.346783 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.350010 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.350449 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.351026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.362329 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:30:51.362698 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.362970 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:30:51.363529 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.367252 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:30:51.367569 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:30:51.368003 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.368993 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:30:51.307074 => 16:30:51.368835
[0m16:30:51.369269 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:30:51.418023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109819420>]}
[0m16:30:51.418591 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m16:30:51.419033 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:30:51.419592 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:30:51.419960 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:30:51.420437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:30:51.420715 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:30:51.422868 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.423576 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:30:51.420877 => 16:30:51.423331
[0m16:30:51.423913 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:30:51.428544 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.429185 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.429453 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:30:51.429695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:51.437246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.437620 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.437936 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m16:30:51.438758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.442084 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.442474 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:30:51.442933 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.445086 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.445389 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:30:51.445758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.447012 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:30:51.447270 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.447512 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:30:51.448065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.450286 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:30:51.450647 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:30:51.451189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.452351 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:30:51.424079 => 16:30:51.452199
[0m16:30:51.452647 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:30:51.501851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109819900>]}
[0m16:30:51.502433 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:30:51.502852 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:30:51.503372 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:30:51.503753 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:30:51.504238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:30:51.504514 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:30:51.507750 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.508355 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:30:51.504671 => 16:30:51.508200
[0m16:30:51.508627 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:30:51.513127 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.513801 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.514225 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:30:51.514547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:51.522077 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.522449 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.522747 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)


select * from pivoted
  );

[0m16:30:51.525088 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.528235 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.528573 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m16:30:51.528998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.531157 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.531459 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:30:51.531931 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.533380 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:30:51.533680 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.533932 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:30:51.534543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.536605 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:30:51.536904 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:30:51.537363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:51.538342 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:30:51.508785 => 16:30:51.538192
[0m16:30:51.538619 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:30:51.587674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2f02e75-029b-4ddf-b7fb-d0c2f0a0d269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d09a0>]}
[0m16:30:51.588245 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m16:30:51.588673 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:30:51.589660 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:51.589896 [debug] [MainThread]: On master: BEGIN
[0m16:30:51.590114 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:51.597453 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:51.597823 [debug] [MainThread]: On master: COMMIT
[0m16:30:51.598046 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:51.598257 [debug] [MainThread]: On master: COMMIT
[0m16:30:51.598518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:51.598764 [debug] [MainThread]: On master: Close
[0m16:30:51.601032 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:51.601293 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m16:30:51.601574 [info ] [MainThread]: 
[0m16:30:51.601813 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m16:30:51.602391 [debug] [MainThread]: Command end result
[0m16:30:51.607704 [info ] [MainThread]: 
[0m16:30:51.608068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:51.608299 [info ] [MainThread]: 
[0m16:30:51.608528 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:30:51.609984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1111809, "process_user_time": 2.264131, "process_kernel_time": 0.2049, "process_mem_max_rss": "200556544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:30:51.610559 [debug] [MainThread]: Command `dbt run` succeeded at 16:30:51.610461 after 1.11 seconds
[0m16:30:51.610874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109814c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097fccd0>]}
[0m16:30:51.611170 [debug] [MainThread]: Flushing usage events
[0m17:04:58.045199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cfcd0>]}


============================== 17:04:58.048161 | 5e29bf33-e6af-4d43-bd44-ac3f0454ec6c ==============================
[0m17:04:58.048161 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:04:58.048596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:58.386651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060cfa00>]}
[0m17:04:58.483353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061808b0>]}
[0m17:04:58.484870 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m17:04:58.496258 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:04:58.524115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:04:58.524588 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m17:04:58.660593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m17:04:58.664168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae05b0>]}
[0m17:04:58.671786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cfee0>]}
[0m17:04:58.672273 [info ] [MainThread]: Found 2 seeds, 4 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:04:58.672547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cfdf0>]}
[0m17:04:58.673617 [info ] [MainThread]: 
[0m17:04:58.674191 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:04:58.675058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m17:04:58.682947 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m17:04:58.683314 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m17:04:58.683561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:58.697641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.699373 [debug] [ThreadPool]: On list_dev_database: Close
[0m17:04:58.702234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m17:04:58.702901 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m17:04:58.708097 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:04:58.708402 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m17:04:58.708634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:58.717061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.718187 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:04:58.718452 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m17:04:58.718728 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.718942 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:04:58.719155 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m17:04:58.719477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.720043 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:04:58.720334 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:04:58.720554 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:04:58.720826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.721041 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m17:04:58.724043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m17:04:58.758646 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:04:58.759008 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m17:04:58.759223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:58.766755 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.767045 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:04:58.767287 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m17:04:58.781925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:58.787472 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m17:04:58.788270 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m17:04:58.788513 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m17:04:58.803117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0e0b0>]}
[0m17:04:58.803512 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:58.803749 [debug] [MainThread]: On master: BEGIN
[0m17:04:58.803972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:58.811325 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:58.811644 [debug] [MainThread]: On master: COMMIT
[0m17:04:58.811862 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:58.812069 [debug] [MainThread]: On master: COMMIT
[0m17:04:58.812304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:58.812515 [debug] [MainThread]: On master: Close
[0m17:04:58.814656 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m17:04:58.814930 [info ] [MainThread]: 
[0m17:04:58.816523 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:04:58.816881 [info ] [Thread-1 (]: 1 of 4 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m17:04:58.817350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m17:04:58.817614 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:04:58.819990 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.820797 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 17:04:58.817769 => 17:04:58.820617
[0m17:04:58.821080 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:04:58.844299 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.845224 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.845509 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m17:04:58.845759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:58.853147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.853559 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.853896 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m17:04:58.854871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.860166 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.860496 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m17:04:58.860953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.863704 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.863993 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.864362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.875457 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:04:58.875821 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.876091 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:04:58.876712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.880690 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:04:58.881033 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m17:04:58.881522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.882547 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 17:04:58.821240 => 17:04:58.882390
[0m17:04:58.882834 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m17:04:58.930831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3fcd0>]}
[0m17:04:58.931396 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m17:04:58.931829 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:04:58.932398 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:04:58.932876 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m17:04:58.933377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m17:04:58.933645 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:04:58.935707 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.936332 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 17:04:58.933797 => 17:04:58.936178
[0m17:04:58.936596 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:04:58.941122 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.941784 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.942049 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m17:04:58.942288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:58.950124 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.950526 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.950849 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m17:04:58.951773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.955093 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.955531 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m17:04:58.956046 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.958409 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.958731 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m17:04:58.959095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.960307 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:04:58.960570 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.960817 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:04:58.961335 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.963263 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:04:58.963541 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m17:04:58.963969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:58.964917 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 17:04:58.936746 => 17:04:58.964770
[0m17:04:58.965187 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m17:04:59.013379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edb550>]}
[0m17:04:59.013920 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m17:04:59.014341 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:04:59.014871 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:04:59.015251 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m17:04:59.015740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m17:04:59.016016 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:04:59.019100 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.020080 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 17:04:59.016175 => 17:04:59.019851
[0m17:04:59.020412 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:04:59.025122 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.025778 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.026039 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m17:04:59.026278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.034091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.034481 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.034784 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)


select * from pivoted
  );

[0m17:04:59.037074 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.040167 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.040481 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m17:04:59.040887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.042927 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.043205 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m17:04:59.043549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.044750 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:04:59.045025 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.045263 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:04:59.045748 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.047485 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:04:59.047751 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m17:04:59.048159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.049042 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 17:04:59.020580 => 17:04:59.048896
[0m17:04:59.049306 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m17:04:59.097556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691b790>]}
[0m17:04:59.098115 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m17:04:59.098535 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:04:59.099045 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:04:59.099454 [info ] [Thread-1 (]: 4 of 4 START sql view model dev_sode.fact_daily_climate_parameters ............. [RUN]
[0m17:04:59.099938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m17:04:59.100213 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:04:59.102326 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:04:59.102983 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 17:04:59.100371 => 17:04:59.102825
[0m17:04:59.103250 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:04:59.107858 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:04:59.108748 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:04:59.109084 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m17:04:59.109366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:59.117071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:59.117432 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:04:59.117716 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" as (
    with source from (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min,
    TMAX_max,
    TMAX_avg,
    TMIN_min,
    TMIN_max,
    TMIN_avg

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
  );

[0m17:04:59.121261 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 17:04:59.103403 => 17:04:59.121027
[0m17:04:59.121606 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: ROLLBACK
[0m17:04:59.125304 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.fact_daily_climate_parameters'
[0m17:04:59.125586 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m17:04:59.128391 [debug] [Thread-1 (]: Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Parser Error: syntax error at or near "from"
  LINE 5:     with source from (
                          ^
[0m17:04:59.128775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e29bf33-e6af-4d43-bd44-ac3f0454ec6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ffdf0>]}
[0m17:04:59.129205 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model dev_sode.fact_daily_climate_parameters .... [[31mERROR[0m in 0.03s]
[0m17:04:59.129619 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:04:59.130551 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:59.130782 [debug] [MainThread]: On master: BEGIN
[0m17:04:59.130984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:59.138099 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:59.138450 [debug] [MainThread]: On master: COMMIT
[0m17:04:59.138669 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:59.138872 [debug] [MainThread]: On master: COMMIT
[0m17:04:59.139107 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:59.139320 [debug] [MainThread]: On master: Close
[0m17:04:59.142960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:59.143288 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m17:04:59.143570 [info ] [MainThread]: 
[0m17:04:59.143821 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:04:59.144510 [debug] [MainThread]: Command end result
[0m17:04:59.151570 [info ] [MainThread]: 
[0m17:04:59.152036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:59.152269 [info ] [MainThread]: 
[0m17:04:59.152487 [error] [MainThread]:   Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Parser Error: syntax error at or near "from"
  LINE 5:     with source from (
                          ^
[0m17:04:59.152708 [info ] [MainThread]: 
[0m17:04:59.152934 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:04:59.154649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1634251, "process_user_time": 2.234085, "process_kernel_time": 0.209105, "process_mem_max_rss": "202440704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:04:59.155195 [debug] [MainThread]: Command `dbt run` failed at 17:04:59.155101 after 1.16 seconds
[0m17:04:59.155505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090b850>]}
[0m17:04:59.155790 [debug] [MainThread]: Flushing usage events
[0m17:05:19.636037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0bcd0>]}


============================== 17:05:19.638450 | 5ec38d73-2e92-48df-ab1d-e7d6f6114aaa ==============================
[0m17:05:19.638450 [info ] [MainThread]: Running with dbt=1.7.6
[0m17:05:19.638877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:05:19.867337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0ba00>]}
[0m17:05:19.963566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbc8b0>]}
[0m17:05:19.964133 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m17:05:19.974990 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m17:05:19.994531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:19.995064 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m17:05:20.126238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m17:05:20.129724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135e45b0>]}
[0m17:05:20.135554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ecee0>]}
[0m17:05:20.135908 [info ] [MainThread]: Found 2 seeds, 4 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:05:20.136171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133ecdf0>]}
[0m17:05:20.137096 [info ] [MainThread]: 
[0m17:05:20.137643 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:05:20.138470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m17:05:20.146455 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m17:05:20.146845 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m17:05:20.147090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:20.156254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.157456 [debug] [ThreadPool]: On list_dev_database: Close
[0m17:05:20.159984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m17:05:20.160597 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m17:05:20.165671 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:05:20.165973 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m17:05:20.166215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:20.174131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.175197 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:05:20.175440 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m17:05:20.175699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.175901 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:05:20.176119 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m17:05:20.176408 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.176947 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:05:20.177168 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:05:20.177363 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:05:20.177610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.177809 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m17:05:20.180743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m17:05:20.215684 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:05:20.216063 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m17:05:20.216287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:20.223315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.223614 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:05:20.223850 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m17:05:20.237128 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:05:20.242325 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m17:05:20.242841 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m17:05:20.243070 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m17:05:20.257502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11400e0b0>]}
[0m17:05:20.257898 [debug] [MainThread]: Using duckdb connection "master"
[0m17:05:20.258131 [debug] [MainThread]: On master: BEGIN
[0m17:05:20.258337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:20.265844 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:05:20.266151 [debug] [MainThread]: On master: COMMIT
[0m17:05:20.266363 [debug] [MainThread]: Using duckdb connection "master"
[0m17:05:20.266570 [debug] [MainThread]: On master: COMMIT
[0m17:05:20.266803 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:05:20.267009 [debug] [MainThread]: On master: Close
[0m17:05:20.269003 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m17:05:20.269271 [info ] [MainThread]: 
[0m17:05:20.270624 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:05:20.271017 [info ] [Thread-1 (]: 1 of 4 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m17:05:20.271507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m17:05:20.271785 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:05:20.274163 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.274796 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 17:05:20.271953 => 17:05:20.274632
[0m17:05:20.275069 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:05:20.298484 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.299227 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.299517 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m17:05:20.299775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:20.307565 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.307937 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.308262 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m17:05:20.308885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.314270 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.314652 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m17:05:20.315091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.318069 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.318396 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.318753 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.330449 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:05:20.330903 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.331175 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:05:20.331747 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.335467 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:05:20.335801 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m17:05:20.336273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.337310 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 17:05:20.275228 => 17:05:20.337156
[0m17:05:20.337587 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m17:05:20.385482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114047cd0>]}
[0m17:05:20.386051 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m17:05:20.386476 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:05:20.387045 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:05:20.387422 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m17:05:20.387925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m17:05:20.388202 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:05:20.390350 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.390995 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 17:05:20.388365 => 17:05:20.390838
[0m17:05:20.391258 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:05:20.395911 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.396610 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.396865 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m17:05:20.397100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:20.404575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.404978 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.405304 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m17:05:20.406148 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.409093 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.409383 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m17:05:20.409741 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.411773 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.412049 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m17:05:20.412387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.413870 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:05:20.414255 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.414521 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:05:20.415087 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.417154 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:05:20.417435 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m17:05:20.417891 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.418925 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 17:05:20.391414 => 17:05:20.418775
[0m17:05:20.419211 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m17:05:20.466705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140db550>]}
[0m17:05:20.467288 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m17:05:20.467716 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:05:20.468230 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:05:20.468624 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m17:05:20.469105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m17:05:20.469381 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:05:20.472454 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.473194 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 17:05:20.469540 => 17:05:20.472967
[0m17:05:20.473527 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:05:20.478020 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.478761 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.479132 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m17:05:20.479388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:20.486814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.487228 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.487532 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)


select * from pivoted
  );

[0m17:05:20.489442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.492428 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.492743 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m17:05:20.493117 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.495182 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.495452 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m17:05:20.495788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.497002 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:05:20.497257 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.497498 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:05:20.498101 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.500297 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:05:20.500606 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m17:05:20.501097 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.502158 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 17:05:20.473692 => 17:05:20.502008
[0m17:05:20.502446 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m17:05:20.549841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11341dae0>]}
[0m17:05:20.550385 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m17:05:20.550800 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:05:20.551288 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:05:20.551667 [info ] [Thread-1 (]: 4 of 4 START sql view model dev_sode.fact_daily_climate_parameters ............. [RUN]
[0m17:05:20.552126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m17:05:20.552389 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:05:20.554494 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.555188 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 17:05:20.552546 => 17:05:20.554941
[0m17:05:20.555525 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:05:20.559978 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.560638 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.560904 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m17:05:20.561148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:20.568522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.568892 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.569182 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" as (
    with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min,
    TMAX_max,
    TMAX_avg,
    TMIN_min,
    TMIN_max,
    TMIN_avg

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
  );

[0m17:05:20.571181 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.573817 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.574197 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m17:05:20.574598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.575719 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:05:20.575981 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.576217 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:05:20.576761 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.579845 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:05:20.580131 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m17:05:20.580502 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:05:20.581495 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 17:05:20.555693 => 17:05:20.581348
[0m17:05:20.581767 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m17:05:20.629678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec38d73-2e92-48df-ab1d-e7d6f6114aaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114519240>]}
[0m17:05:20.630247 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dev_sode.fact_daily_climate_parameters ........ [[32mOK[0m in 0.08s]
[0m17:05:20.630657 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:05:20.631625 [debug] [MainThread]: Using duckdb connection "master"
[0m17:05:20.631939 [debug] [MainThread]: On master: BEGIN
[0m17:05:20.632147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:20.639230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:05:20.639541 [debug] [MainThread]: On master: COMMIT
[0m17:05:20.639759 [debug] [MainThread]: Using duckdb connection "master"
[0m17:05:20.639970 [debug] [MainThread]: On master: COMMIT
[0m17:05:20.640215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:05:20.640427 [debug] [MainThread]: On master: Close
[0m17:05:20.642823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:20.643094 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m17:05:20.643365 [info ] [MainThread]: 
[0m17:05:20.643614 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m17:05:20.644262 [debug] [MainThread]: Command end result
[0m17:05:20.649409 [info ] [MainThread]: 
[0m17:05:20.649693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:20.649911 [info ] [MainThread]: 
[0m17:05:20.650140 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:05:20.651382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0663141, "process_user_time": 2.266814, "process_kernel_time": 0.158078, "process_mem_max_rss": "196870144", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:20.651810 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:20.651721 after 1.07 seconds
[0m17:05:20.652087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11401c910>]}
[0m17:05:20.652361 [debug] [MainThread]: Flushing usage events
[0m16:50:45.670550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accbca0>]}


============================== 16:50:45.673539 | 07ac8823-c134-4bcc-88bd-8205b94d325d ==============================
[0m16:50:45.673539 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:50:45.673963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:45.989921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accb9d0>]}
[0m16:50:46.086699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0779d0>]}
[0m16:50:46.088234 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:50:46.099264 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:50:46.126333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:50:46.126801 [debug] [MainThread]: Partial parsing: added file: climate_works_dbt://models/Intermediate/int_daily_climate_params.sql
[0m16:50:46.127100 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m16:50:46.262100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:50:46.265734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dc9a0>]}
[0m16:50:46.272899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e8f70>]}
[0m16:50:46.273350 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:50:46.273643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e8d90>]}
[0m16:50:46.274630 [info ] [MainThread]: 
[0m16:50:46.275179 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:50:46.276065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:50:46.284077 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:50:46.284440 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:50:46.284692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:46.299798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.301751 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:50:46.304664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:50:46.305168 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:50:46.310250 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:50:46.310535 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:50:46.310761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:46.318043 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.319052 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:50:46.319285 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:50:46.319527 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.319725 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:50:46.319929 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:50:46.320239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.320761 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:50:46.320979 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:50:46.321176 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:50:46.321421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.321624 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:50:46.324462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:50:46.358585 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:50:46.358935 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:50:46.359144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:46.365880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.366195 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:50:46.366443 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:50:46.381057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:50:46.386686 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:50:46.387482 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:50:46.387735 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:50:46.401855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1aaa10>]}
[0m16:50:46.402251 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:46.402475 [debug] [MainThread]: On master: BEGIN
[0m16:50:46.402678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:46.410090 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:50:46.410432 [debug] [MainThread]: On master: COMMIT
[0m16:50:46.410649 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:46.410857 [debug] [MainThread]: On master: COMMIT
[0m16:50:46.411093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:50:46.411298 [debug] [MainThread]: On master: Close
[0m16:50:46.413468 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:50:46.413733 [info ] [MainThread]: 
[0m16:50:46.415493 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:50:46.415880 [info ] [Thread-1 (]: 1 of 4 START sql view model dev_sode.stg_daily_climate_parameters_vertical_raw . [RUN]
[0m16:50:46.416388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:50:46.416669 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:50:46.419131 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.420050 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:50:46.416829 => 16:50:46.419790
[0m16:50:46.420415 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:50:46.444296 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.445383 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.445790 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:50:46.446064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:46.453036 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.453389 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.453714 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" as (
    with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
  );

[0m16:50:46.454652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.460099 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.460421 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m16:50:46.460847 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.463608 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.463896 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.464262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.475097 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:50:46.475429 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.475689 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:50:46.476218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.479743 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:50:46.480071 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:50:46.480500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.481456 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:50:46.420588 => 16:50:46.481298
[0m16:50:46.481731 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:50:46.530645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b843bb0>]}
[0m16:50:46.531234 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 0.11s]
[0m16:50:46.531665 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:50:46.532239 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:50:46.532624 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:50:46.533117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:50:46.533405 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:50:46.535646 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.536260 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:50:46.533571 => 16:50:46.536096
[0m16:50:46.536542 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:50:46.541058 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.541565 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.541835 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:50:46.542084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:46.549507 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.549907 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.550235 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m16:50:46.551089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.554207 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.554498 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m16:50:46.554860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.556963 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.557282 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:50:46.557673 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.559040 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:50:46.559301 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.559552 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:50:46.560115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.562308 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:50:46.562617 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:50:46.563083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.564067 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:50:46.536701 => 16:50:46.563911
[0m16:50:46.564352 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:50:46.611220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b403490>]}
[0m16:50:46.611783 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.08s]
[0m16:50:46.612194 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:50:46.612719 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:50:46.613051 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:50:46.613513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:50:46.613773 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:50:46.616820 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.617647 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:50:46.613920 => 16:50:46.617486
[0m16:50:46.617930 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:50:46.622422 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.622929 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.623185 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:50:46.623422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:46.631165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.631538 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.631865 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)


select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX_max/10 ::DECIMAL as max_max_temperature_celsius,
    TMAX_avg/10 ::DECIMAL as max_avg_temperature_celsius,
    TMIN_min/10 ::DECIMAL as min_min_temperature_celsius,
    TMIN_max/10 ::DECIMAL as min_max_temperature_celsius,
    TMIN_avg/10 ::DECIMAL as min_avg_temperature_celsius
    
     from pivoted
  );

[0m16:50:46.634463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.637557 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.637897 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m16:50:46.638289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.640464 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.640802 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:50:46.641186 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.642483 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:50:46.642768 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.643011 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:50:46.643566 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.645527 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:50:46.645823 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:50:46.646266 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.647232 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:50:46.618088 => 16:50:46.647080
[0m16:50:46.647535 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:50:46.696825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89f9a0>]}
[0m16:50:46.697382 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m16:50:46.697799 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:50:46.698400 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:50:46.698852 [info ] [Thread-1 (]: 4 of 4 START sql view model dev_sode.fact_daily_climate_parameters ............. [RUN]
[0m16:50:46.699425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m16:50:46.699715 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:50:46.701904 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:50:46.702598 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 16:50:46.699880 => 16:50:46.702429
[0m16:50:46.702881 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:50:46.707484 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:50:46.708091 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:50:46.708355 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m16:50:46.708589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:46.715840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:50:46.716201 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:50:46.716508 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" as (
    with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min,
    TMAX_max,
    TMAX_avg,
    TMIN_min,
    TMIN_max,
    TMIN_avg

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
  );

[0m16:50:46.720794 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 16:50:46.703029 => 16:50:46.720625
[0m16:50:46.721076 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: ROLLBACK
[0m16:50:46.724755 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.fact_daily_climate_parameters'
[0m16:50:46.725039 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m16:50:46.727605 [debug] [Thread-1 (]: Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "TMAX_min" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.PRCP_min"
[0m16:50:46.727980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07ac8823-c134-4bcc-88bd-8205b94d325d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4038e0>]}
[0m16:50:46.728430 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model dev_sode.fact_daily_climate_parameters .... [[31mERROR[0m in 0.03s]
[0m16:50:46.728852 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:50:46.729739 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:46.729966 [debug] [MainThread]: On master: BEGIN
[0m16:50:46.730167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:46.737823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:50:46.738172 [debug] [MainThread]: On master: COMMIT
[0m16:50:46.738397 [debug] [MainThread]: Using duckdb connection "master"
[0m16:50:46.738605 [debug] [MainThread]: On master: COMMIT
[0m16:50:46.738838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:50:46.739048 [debug] [MainThread]: On master: Close
[0m16:50:46.741541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:46.741777 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m16:50:46.742048 [info ] [MainThread]: 
[0m16:50:46.742298 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:50:46.742952 [debug] [MainThread]: Command end result
[0m16:50:46.749593 [info ] [MainThread]: 
[0m16:50:46.749963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:46.750200 [info ] [MainThread]: 
[0m16:50:46.750418 [error] [MainThread]:   Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "TMAX_min" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.PRCP_min"
[0m16:50:46.750647 [info ] [MainThread]: 
[0m16:50:46.750874 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:50:46.752277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1338223, "process_user_time": 2.225368, "process_kernel_time": 0.201345, "process_mem_max_rss": "184418304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:50:46.752702 [debug] [MainThread]: Command `dbt run` failed at 16:50:46.752617 after 1.13 seconds
[0m16:50:46.752981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0fd60>]}
[0m16:50:46.753261 [debug] [MainThread]: Flushing usage events
[0m15:06:52.177218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c76bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2fc70>]}


============================== 15:06:52.180201 | 0a8a7b40-8bbb-44d8-9dc3-2a9f12510587 ==============================
[0m15:06:52.180201 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:06:52.180578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:06:53.057704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2f9d0>]}
[0m15:06:53.134214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaa1d0>]}
[0m15:06:53.135676 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:06:53.145840 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:06:53.172049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:06:53.172529 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:06:53.172782 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m15:06:53.173010 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m15:06:53.284111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:06:53.286951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105530b80>]}
[0m15:06:53.294175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105349420>]}
[0m15:06:53.294478 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:06:53.294700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053490c0>]}
[0m15:06:53.295511 [info ] [MainThread]: 
[0m15:06:53.295989 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:06:53.296707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:06:53.303434 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:06:53.303743 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:06:53.303935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:53.313332 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.314704 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:06:53.317557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:06:53.317971 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:06:53.321785 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:53.322010 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:06:53.322194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:53.329906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.361454 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:53.362643 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:06:53.362912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.363077 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:53.363242 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:06:53.363507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.363946 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:06:53.364113 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:53.364272 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:06:53.364470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.364632 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:06:53.367271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:06:53.370431 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:06:53.370649 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:06:53.370824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:53.377192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.377462 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:06:53.377648 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:06:53.388346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:53.392825 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:06:53.393671 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:06:53.393888 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:06:53.405682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb06d0>]}
[0m15:06:53.405996 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:53.406187 [debug] [MainThread]: On master: BEGIN
[0m15:06:53.406359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:53.412050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:53.412291 [debug] [MainThread]: On master: COMMIT
[0m15:06:53.412458 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:53.412619 [debug] [MainThread]: On master: COMMIT
[0m15:06:53.412800 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:53.412964 [debug] [MainThread]: On master: Close
[0m15:06:53.414582 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:06:53.414781 [info ] [MainThread]: 
[0m15:06:53.416084 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:53.416380 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:06:53.416785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:06:53.417015 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:53.419194 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:53.420615 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:06:53.417161 => 15:06:53.420469
[0m15:06:53.420847 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:53.441059 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:53.441928 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:53.442185 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:06:53.442476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:53.449616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:53.449959 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:53.450224 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:06:59.133589 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m15:06:59.139482 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:59.139745 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:06:59.140188 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:59.142607 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:59.142847 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:06:59.143164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:59.153476 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:06:59.153727 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:59.153938 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:07:05.739637 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:07:05.745802 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:07:05.746056 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:07:05.746542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:05.747842 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:06:53.420972 => 15:07:05.747627
[0m15:07:05.748085 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:07:05.983968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aa5c0>]}
[0m15:07:05.984667 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.57s]
[0m15:07:05.985038 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:07:05.985909 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:07:05.986177 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:07:05.986590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:07:05.986821 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:07:05.989070 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:05.991129 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:07:05.986954 => 15:07:05.990952
[0m15:07:05.991382 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:07:06.003505 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.004146 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.004367 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:07:06.004573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:06.012545 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.012861 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.013157 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:07:06.013751 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.016202 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.016468 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:07:06.016859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.018702 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.018942 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:07:06.019265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.020386 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:07:06.020589 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.020770 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:07:06.021174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.023211 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:07:06.023422 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:07:06.023733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.024442 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:07:05.991519 => 15:07:06.024327
[0m15:07:06.024645 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:07:06.092847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561bb20>]}
[0m15:07:06.093299 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:07:06.093640 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:07:06.094187 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:07:06.094506 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:07:06.094901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:07:06.095129 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:07:06.097139 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.098194 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:07:06.095258 => 15:07:06.098065
[0m15:07:06.098406 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:07:06.101924 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.102486 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.102773 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:07:06.102976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:06.108905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.109177 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.109425 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX_max/10 ::DECIMAL as max_max_temperature_celsius,
    TMAX_avg/10 ::DECIMAL as max_avg_temperature_celsius,
    TMIN_min/10 ::DECIMAL as min_min_temperature_celsius,
    TMIN_max/10 ::DECIMAL as min_max_temperature_celsius,
    TMIN_avg/10 ::DECIMAL as min_avg_temperature_celsius
    
     from pivoted
  );

[0m15:07:06.110676 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.113334 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.113705 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:07:06.114090 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.115914 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.116174 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:07:06.116483 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.117538 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:07:06.117758 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.117949 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:07:06.118409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.119913 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:07:06.120136 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:07:06.120516 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.121277 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:07:06.098538 => 15:07:06.121153
[0m15:07:06.121506 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:07:06.196303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648fd0>]}
[0m15:07:06.196786 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:07:06.197130 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:07:06.197597 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:07:06.197877 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:07:06.198275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:07:06.198491 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:07:06.200322 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:07:06.201149 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:07:06.198617 => 15:07:06.200992
[0m15:07:06.201395 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:07:06.205021 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:07:06.205493 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:07:06.205704 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:07:06.205897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:06.213855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:06.214179 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:07:06.214412 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min,
    TMAX_max,
    TMAX_avg,
    TMIN_min,
    TMIN_max,
    TMIN_avg

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m15:07:06.216299 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:07:06.201522 => 15:07:06.216160
[0m15:07:06.216532 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: ROLLBACK
[0m15:07:06.220370 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.fact_daily_climate_parameters'
[0m15:07:06.220686 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:07:06.224292 [debug] [Thread-1 (]: Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "TMAX_min" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.PRCP_min"
[0m15:07:06.224663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a8a7b40-8bbb-44d8-9dc3-2a9f12510587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105380eb0>]}
[0m15:07:06.225009 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dev_sode.fact_daily_climate_parameters ... [[31mERROR[0m in 0.03s]
[0m15:07:06.225349 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:07:06.226467 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:06.226707 [debug] [MainThread]: On master: BEGIN
[0m15:07:06.226883 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:06.234807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:06.235090 [debug] [MainThread]: On master: COMMIT
[0m15:07:06.235257 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:06.235415 [debug] [MainThread]: On master: COMMIT
[0m15:07:06.235605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:06.235774 [debug] [MainThread]: On master: Close
[0m15:07:06.237393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:06.237579 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:07:06.237820 [info ] [MainThread]: 
[0m15:07:06.238065 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 12.94 seconds (12.94s).
[0m15:07:06.238685 [debug] [MainThread]: Command end result
[0m15:07:06.246535 [info ] [MainThread]: 
[0m15:07:06.246918 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:06.247119 [info ] [MainThread]: 
[0m15:07:06.247325 [error] [MainThread]:   Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "TMAX_min" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.PRCP_min"
[0m15:07:06.247520 [info ] [MainThread]: 
[0m15:07:06.247748 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:07:06.249437 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.117127, "process_user_time": 43.947063, "process_kernel_time": 1.432758, "process_mem_max_rss": "3131637760", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:06.249995 [debug] [MainThread]: Command `dbt run` failed at 15:07:06.249915 after 14.12 seconds
[0m15:07:06.250296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c76bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaa1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37a30>]}
[0m15:07:06.250529 [debug] [MainThread]: Flushing usage events
[0m15:07:57.996977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cfc40>]}


============================== 15:07:57.999429 | 25e70ff2-b72a-4b93-86ca-1dd40d07a736 ==============================
[0m15:07:57.999429 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:07:57.999761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:58.181198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cfa90>]}
[0m15:07:58.254209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091645e0>]}
[0m15:07:58.255113 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:07:58.264834 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:07:58.287563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:58.288019 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m15:07:58.392468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:07:58.395336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ad7eb0>]}
[0m15:07:58.401127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ed2a0>]}
[0m15:07:58.401472 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:07:58.401699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097ed0c0>]}
[0m15:07:58.402521 [info ] [MainThread]: 
[0m15:07:58.403072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:07:58.403889 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:07:58.410323 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:07:58.410633 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:07:58.410823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:58.418953 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.420119 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:07:58.422485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:07:58.422945 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:07:58.427336 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:07:58.427589 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:07:58.427763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:58.434219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.435170 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:07:58.435365 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:07:58.435569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.435734 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:07:58.435892 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:07:58.436134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.436536 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:07:58.436705 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:07:58.436857 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:07:58.437064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.437224 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:07:58.439896 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:07:58.471981 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:07:58.474359 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:07:58.474566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:58.480636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.480901 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:07:58.481087 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:07:58.491223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:58.495165 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:07:58.495886 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:07:58.496059 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:07:58.507352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11a380>]}
[0m15:07:58.507680 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:58.507858 [debug] [MainThread]: On master: BEGIN
[0m15:07:58.508013 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:58.513590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:58.513834 [debug] [MainThread]: On master: COMMIT
[0m15:07:58.514001 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:58.514155 [debug] [MainThread]: On master: COMMIT
[0m15:07:58.514334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:58.514494 [debug] [MainThread]: On master: Close
[0m15:07:58.516198 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:07:58.516400 [info ] [MainThread]: 
[0m15:07:58.517783 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:07:58.518076 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:07:58.518481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:07:58.518702 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:07:58.520789 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:07:58.521355 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:07:58.518830 => 15:07:58.521219
[0m15:07:58.521579 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:07:58.540695 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:07:58.541494 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:07:58.541727 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:07:58.541932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:58.548067 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:58.548369 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:07:58.548620 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:08:03.691423 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:08:03.699857 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:08:03.700132 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:08:03.700549 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:03.703074 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:08:03.703309 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:08:03.703593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:03.713622 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:08:03.713867 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:08:03.714062 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:08:10.572985 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:08:10.577083 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:08:10.577328 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:08:10.583253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.584517 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:07:58.521706 => 15:08:10.584233
[0m15:08:10.584789 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:08:10.834728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a147c40>]}
[0m15:08:10.835492 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.32s]
[0m15:08:10.835870 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:08:10.836792 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:08:10.837164 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:08:10.837619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:08:10.837859 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:08:10.839831 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.842181 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:08:10.837989 => 15:08:10.841992
[0m15:08:10.842522 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:08:10.854375 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.855021 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.855251 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:08:10.855456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:10.862044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.862364 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.862623 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:08:10.863287 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.866096 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.866410 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:08:10.866785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.868428 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.868649 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:08:10.868959 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.869975 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:08:10.870168 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.870350 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:08:10.870871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.872574 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:08:10.872813 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:08:10.873179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.873970 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:08:10.842694 => 15:08:10.873857
[0m15:08:10.874197 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:08:10.949349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b7460>]}
[0m15:08:10.949895 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:08:10.950282 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:08:10.950982 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:08:10.951415 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:08:10.951845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:08:10.952083 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:08:10.954819 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.955336 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:08:10.952208 => 15:08:10.955213
[0m15:08:10.955541 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:08:10.959129 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.959651 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.959885 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:08:10.960105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:10.967277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.967594 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.967842 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using avg(reading_value) as avg, max(reading_value) as max, min(reading_value) as min group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX_min/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX_max/10 ::DECIMAL as max_max_temperature_celsius,
    TMAX_avg/10 ::DECIMAL as max_avg_temperature_celsius,
    TMIN_min/10 ::DECIMAL as min_min_temperature_celsius,
    TMIN_max/10 ::DECIMAL as min_max_temperature_celsius,
    TMIN_avg/10 ::DECIMAL as min_avg_temperature_celsius
    
     from pivoted
  );

[0m15:08:10.969127 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.971598 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.971853 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:08:10.972144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.973642 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.973850 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:08:10.974106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.975044 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:08:10.975245 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.975433 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:08:10.976061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.978084 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:08:10.978374 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:08:10.978792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:10.979649 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:08:10.955654 => 15:08:10.979523
[0m15:08:10.979906 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:08:11.052622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991c5b0>]}
[0m15:08:11.053089 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:08:11.053424 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:08:11.053965 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:08:11.054301 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:08:11.054700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:08:11.054923 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:08:11.056761 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:11.057511 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:08:11.055048 => 15:08:11.057385
[0m15:08:11.057720 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:08:11.061381 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:11.061895 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:11.062109 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:08:11.062303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:11.070326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:11.070668 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:11.070912 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    max_min_temperature_celsius,
    max_max_temperature_celsius,
    max_avg_temperature_celsius,
    min_min_temperature_celsius,
    min_max_temperature_celsius,
    min_avg_temperature_celsius

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m15:08:13.552457 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m15:08:13.554831 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:13.556147 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m15:08:13.556600 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:13.558816 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:13.559185 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m15:08:13.559671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:13.560912 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:08:13.561134 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:13.561327 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:08:13.564999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:13.566653 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:08:13.566886 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m15:08:13.567313 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:13.568469 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:08:11.057851 => 15:08:13.568339
[0m15:08:13.568809 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:08:13.684484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70ff2-b72a-4b93-86ca-1dd40d07a736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a172aa0>]}
[0m15:08:13.684974 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 2.63s]
[0m15:08:13.685320 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:08:13.686514 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:13.686876 [debug] [MainThread]: On master: BEGIN
[0m15:08:13.687158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:13.694837 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:13.695129 [debug] [MainThread]: On master: COMMIT
[0m15:08:13.695297 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:13.695454 [debug] [MainThread]: On master: COMMIT
[0m15:08:13.695633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:13.695792 [debug] [MainThread]: On master: Close
[0m15:08:13.699905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:13.700178 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:08:13.700457 [info ] [MainThread]: 
[0m15:08:13.700726 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.30 seconds (15.30s).
[0m15:08:13.701877 [debug] [MainThread]: Command end result
[0m15:08:13.711197 [info ] [MainThread]: 
[0m15:08:13.711516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:13.711704 [info ] [MainThread]: 
[0m15:08:13.711918 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:08:13.713889 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.758793, "process_user_time": 55.03762, "process_kernel_time": 1.792817, "process_mem_max_rss": "2783461376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:13.714471 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:13.714387 after 15.76 seconds
[0m15:08:13.714787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a9ab0>]}
[0m15:08:13.715042 [debug] [MainThread]: Flushing usage events
[0m15:11:02.044776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107702bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bbcd0>]}


============================== 15:11:02.047236 | c5fc09e9-5e40-4fa2-9b07-e0f90be34cde ==============================
[0m15:11:02.047236 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:11:02.047573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:11:02.293453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bb9d0>]}
[0m15:11:02.367582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c0abc0>]}
[0m15:11:02.368949 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:11:02.378655 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:11:02.403212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:02.403659 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:11:02.507658 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:11:02.510473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc4a00>]}
[0m15:11:02.515861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd5330>]}
[0m15:11:02.516210 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:11:02.516430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd5150>]}
[0m15:11:02.517289 [info ] [MainThread]: 
[0m15:11:02.517833 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:02.518627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:11:02.525465 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:11:02.525816 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:11:02.525996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:02.535114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.538457 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:11:02.544419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:11:02.545691 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:11:02.549855 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:02.550131 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:11:02.550302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:02.557445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.558314 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:02.558506 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:11:02.558697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.558851 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:02.559011 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:11:02.559220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.559637 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:11:02.559803 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:02.559957 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:11:02.560146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.560307 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:11:02.562944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:11:02.593540 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:11:02.593829 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:11:02.594000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:02.600458 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.600749 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:11:02.600943 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:11:02.611597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:02.615858 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:11:02.617253 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:11:02.617432 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:11:02.628673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109935cc0>]}
[0m15:11:02.628986 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:02.629167 [debug] [MainThread]: On master: BEGIN
[0m15:11:02.629328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:02.636161 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:02.636437 [debug] [MainThread]: On master: COMMIT
[0m15:11:02.636607 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:02.636764 [debug] [MainThread]: On master: COMMIT
[0m15:11:02.636945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:02.637107 [debug] [MainThread]: On master: Close
[0m15:11:02.639039 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:11:02.639256 [info ] [MainThread]: 
[0m15:11:02.640640 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:02.640936 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:11:02.641330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:11:02.641545 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:02.643655 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:02.644206 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:11:02.641675 => 15:11:02.644071
[0m15:11:02.644435 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:02.665221 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:02.665951 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:02.666173 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:11:02.666367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:02.672763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:02.673103 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:02.673353 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:11:07.993391 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:11:07.999863 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:08.000129 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:11:08.000513 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.002868 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:08.003092 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:11:08.003371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:08.013252 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:11:08.013499 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:08.013699 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:11:14.790859 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:11:14.795357 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:14.795622 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:11:14.802788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:14.804291 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:11:02.644560 => 15:11:14.803982
[0m15:11:14.804631 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:11:15.117439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02fcd0>]}
[0m15:11:15.119227 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.48s]
[0m15:11:15.119599 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:15.120406 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:15.120752 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:11:15.121175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:11:15.121411 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:15.123463 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.125074 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:11:15.121547 => 15:11:15.124927
[0m15:11:15.125302 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:15.137822 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.138480 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.138727 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:11:15.138962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:15.146042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.146405 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.146672 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:11:15.147306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.150110 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.150453 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:11:15.150817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.152515 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.152731 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:11:15.153014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.154030 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:11:15.154254 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.154440 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:11:15.154983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.156727 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:15.156989 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:11:15.157391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.158182 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:11:15.125423 => 15:11:15.158057
[0m15:11:15.158405 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:11:15.229806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a34f0>]}
[0m15:11:15.230260 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:11:15.230620 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:15.231277 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:15.231657 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:11:15.232141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:11:15.232369 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:15.235049 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:15.236124 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:11:15.232490 => 15:11:15.235937
[0m15:11:15.236405 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:15.240227 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:15.240785 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:15.241012 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:11:15.241211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:15.247878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:15.248208 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:15.248459 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP_avg,
    PRCP_max,
    PRCP_min,
    TMAX/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX/10 ::DECIMAL as max_max_temperature_celsius,

    
     from pivoted
  );

[0m15:11:15.249753 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:11:15.236541 => 15:11:15.249613
[0m15:11:15.250003 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m15:11:15.254410 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m15:11:15.254684 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:11:15.258222 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "PRCP_avg" not found in FROM clause!
  Candidate bindings: "pivoted.PRCP"
[0m15:11:15.258621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5fc09e9-5e40-4fa2-9b07-e0f90be34cde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0cf700>]}
[0m15:11:15.258998 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.03s]
[0m15:11:15.259366 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:15.260357 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:15.260572 [debug] [MainThread]: On master: BEGIN
[0m15:11:15.260741 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:15.268364 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:15.268697 [debug] [MainThread]: On master: COMMIT
[0m15:11:15.268884 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:15.269042 [debug] [MainThread]: On master: COMMIT
[0m15:11:15.269225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:15.269389 [debug] [MainThread]: On master: Close
[0m15:11:15.273830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:15.274091 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m15:11:15.274307 [info ] [MainThread]: 
[0m15:11:15.274504 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 12.76 seconds (12.76s).
[0m15:11:15.275001 [debug] [MainThread]: Command end result
[0m15:11:15.281472 [info ] [MainThread]: 
[0m15:11:15.281824 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:11:15.282012 [info ] [MainThread]: 
[0m15:11:15.282194 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "PRCP_avg" not found in FROM clause!
  Candidate bindings: "pivoted.PRCP"
[0m15:11:15.282466 [info ] [MainThread]: 
[0m15:11:15.282697 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:11:15.284438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.282381, "process_user_time": 43.62934, "process_kernel_time": 1.707573, "process_mem_max_rss": "3360980992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:15.284933 [debug] [MainThread]: Command `dbt run` failed at 15:11:15.284854 after 13.28 seconds
[0m15:11:15.285195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107702bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a009450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e4790>]}
[0m15:11:15.285431 [debug] [MainThread]: Flushing usage events
[0m15:11:34.436626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050338b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105033d30>]}


============================== 15:11:34.438995 | 8230c790-0f1f-437b-8389-09937cefc834 ==============================
[0m15:11:34.438995 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:11:34.439326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'send_anonymous_usage_stats': 'True'}
[0m15:11:34.623309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105172e60>]}
[0m15:11:34.698565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e4e20>]}
[0m15:11:34.699527 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:11:34.708659 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:11:34.730735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:34.731258 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:11:34.834091 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:11:34.836910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573ca60>]}
[0m15:11:34.842889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d4e0>]}
[0m15:11:34.843239 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:11:34.843460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10554d1e0>]}
[0m15:11:34.844311 [info ] [MainThread]: 
[0m15:11:34.844869 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:11:34.845717 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:11:34.852374 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:11:34.852686 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:11:34.852873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:34.861048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.862268 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:11:34.864776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:11:34.865214 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:11:34.869205 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:34.869427 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:11:34.869603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:34.876596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.877473 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:34.877669 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:11:34.877867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.878034 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:34.878199 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:11:34.878405 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.878802 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:11:34.878979 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:11:34.879134 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:11:34.879321 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.879483 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:11:34.882245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:11:34.913515 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:11:34.913819 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:11:34.913992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:34.920050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.920288 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:11:34.920473 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:11:34.930601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:11:34.934579 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:11:34.936113 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:11:34.936296 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:11:34.947772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105776470>]}
[0m15:11:34.948089 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:34.948263 [debug] [MainThread]: On master: BEGIN
[0m15:11:34.948423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:34.954367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:34.954608 [debug] [MainThread]: On master: COMMIT
[0m15:11:34.954775 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:34.954940 [debug] [MainThread]: On master: COMMIT
[0m15:11:34.955119 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:34.955277 [debug] [MainThread]: On master: Close
[0m15:11:34.957554 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:11:34.957810 [info ] [MainThread]: 
[0m15:11:34.959260 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:34.959593 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:11:34.960038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:11:34.960271 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:34.962437 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:34.963020 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:11:34.960398 => 15:11:34.962881
[0m15:11:34.963263 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:34.983365 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:34.984057 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:34.984286 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:11:34.984486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:34.991289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:34.991608 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:34.991870 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:11:40.599840 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m15:11:40.603929 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:40.604223 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:11:40.604624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:40.606782 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:40.607007 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:11:40.607286 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:40.617226 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:11:40.617467 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:40.617664 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:11:47.445161 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:11:47.449288 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:11:47.449540 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:11:47.456306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.457397 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:11:34.963400 => 15:11:47.457244
[0m15:11:47.457642 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:11:47.702270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a7d30>]}
[0m15:11:47.702784 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.74s]
[0m15:11:47.703134 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:11:47.703643 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:47.703890 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:11:47.704273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:11:47.704492 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:47.706433 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.706961 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:11:47.704619 => 15:11:47.706827
[0m15:11:47.707195 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:47.719035 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.719686 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.719919 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:11:47.720122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:47.728425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.728762 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.729027 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:11:47.729598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.732276 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.732639 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:11:47.732991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.734568 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.734782 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:11:47.735048 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.736052 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:11:47.736265 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.736451 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:11:47.736902 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.738534 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:11:47.738777 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:11:47.739132 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.739916 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:11:47.707322 => 15:11:47.739794
[0m15:11:47.740140 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:11:47.810760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581b550>]}
[0m15:11:47.811271 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:11:47.811623 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:11:47.812163 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:47.812481 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:11:47.812877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:11:47.813119 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:47.815977 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.816554 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:11:47.813244 => 15:11:47.816419
[0m15:11:47.816768 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:47.820538 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.821191 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.821403 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:11:47.821597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:47.828018 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.828337 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.828587 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP,
    TMAX/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX/10 ::DECIMAL as max_max_temperature_celsius,

    
     from pivoted
  );

[0m15:11:47.829633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.832301 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.832601 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:11:47.832995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.834639 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.834885 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:11:47.835163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.836225 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:11:47.836484 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.836700 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:11:47.837176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.838657 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:11:47.838862 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:11:47.839176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:11:47.839894 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:11:47.816889 => 15:11:47.839778
[0m15:11:47.840101 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:11:47.906582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8230c790-0f1f-437b-8389-09937cefc834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105170760>]}
[0m15:11:47.907068 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.09s]
[0m15:11:47.907407 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:11:47.908245 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:47.908445 [debug] [MainThread]: On master: BEGIN
[0m15:11:47.908605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:47.915062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:47.915375 [debug] [MainThread]: On master: COMMIT
[0m15:11:47.915558 [debug] [MainThread]: Using duckdb connection "master"
[0m15:11:47.915729 [debug] [MainThread]: On master: COMMIT
[0m15:11:47.915931 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:11:47.916104 [debug] [MainThread]: On master: Close
[0m15:11:47.920354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:47.920657 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m15:11:47.920871 [info ] [MainThread]: 
[0m15:11:47.921069 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.08 seconds (13.08s).
[0m15:11:47.921541 [debug] [MainThread]: Command end result
[0m15:11:47.927920 [info ] [MainThread]: 
[0m15:11:47.928314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:47.928518 [info ] [MainThread]: 
[0m15:11:47.928714 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:11:47.930024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.533858, "process_user_time": 44.178486, "process_kernel_time": 1.593446, "process_mem_max_rss": "3328131072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:47.930521 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:47.930440 after 13.53 seconds
[0m15:11:47.930784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105601990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e4e20>]}
[0m15:11:47.931043 [debug] [MainThread]: Flushing usage events
[0m15:12:34.284747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acbcd0>]}


============================== 15:12:34.287183 | 9edfd55a-8d06-41e3-ad19-7907551962f5 ==============================
[0m15:12:34.287183 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:12:34.287532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:12:34.540378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb9d0>]}
[0m15:12:34.615943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a01ebc0>]}
[0m15:12:34.617399 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:12:34.626463 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:12:34.650830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:12:34.651293 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:12:34.651526 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m15:12:34.758932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:12:34.761851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d09d0>]}
[0m15:12:34.767651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e9330>]}
[0m15:12:34.768001 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:12:34.768232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e9150>]}
[0m15:12:34.769074 [info ] [MainThread]: 
[0m15:12:34.769625 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:12:34.770394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:12:34.777347 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:12:34.777680 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:12:34.777866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:34.786035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.787236 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:12:34.790110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:12:34.790607 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:12:34.795025 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:12:34.795313 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:12:34.795489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:34.802812 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.803679 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:12:34.803871 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:12:34.804061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.804211 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:12:34.804371 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:12:34.804576 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.804979 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:12:34.805155 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:12:34.805312 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:12:34.805505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.805666 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:12:34.808788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:12:34.840345 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:12:34.840658 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:12:34.840823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:34.847877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.848133 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:12:34.848320 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:12:34.858589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:12:34.862621 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:12:34.864031 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:12:34.864231 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:12:34.875844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b4dcc0>]}
[0m15:12:34.876160 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:34.876331 [debug] [MainThread]: On master: BEGIN
[0m15:12:34.876492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:34.882531 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:12:34.882790 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.882965 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:34.883122 [debug] [MainThread]: On master: COMMIT
[0m15:12:34.883299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:12:34.883464 [debug] [MainThread]: On master: Close
[0m15:12:34.885373 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:12:34.885613 [info ] [MainThread]: 
[0m15:12:34.887071 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:12:34.887359 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:12:34.887754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:12:34.887975 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:12:34.890176 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:34.891331 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:12:34.888108 => 15:12:34.891141
[0m15:12:34.891603 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:12:34.911573 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:34.912186 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:34.912402 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:12:34.912596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:34.919137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:34.919467 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:34.919763 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:12:40.482327 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m15:12:40.488202 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:40.488520 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:12:40.489084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:40.492038 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:40.492380 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:12:40.492792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:40.503863 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:12:40.504207 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:40.504438 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:12:47.509770 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:12:47.513175 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:12:47.513446 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:12:47.520221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.521351 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:12:34.891738 => 15:12:47.521198
[0m15:12:47.521630 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:12:47.851232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a543c70>]}
[0m15:12:47.851849 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.96s]
[0m15:12:47.852224 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:12:47.852886 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:12:47.853241 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:12:47.853709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:12:47.853963 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:12:47.855934 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.857356 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:12:47.854093 => 15:12:47.857204
[0m15:12:47.857591 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:12:47.870877 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.871541 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.871777 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:12:47.872076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:47.880065 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.880419 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.880690 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:12:47.881385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.883771 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.884017 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:12:47.884306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.885907 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.886141 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:12:47.886428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.887452 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:12:47.887660 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.887844 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:12:47.888281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.889784 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:12:47.890012 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:12:47.890401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.891173 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:12:47.857721 => 15:12:47.891038
[0m15:12:47.891388 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:12:47.963311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b7490>]}
[0m15:12:47.963813 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:12:47.964176 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:12:47.964661 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:12:47.965029 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:12:47.965463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:12:47.965698 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:12:47.968277 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.969196 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:12:47.965827 => 15:12:47.969071
[0m15:12:47.969404 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:12:47.972959 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.973495 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.973711 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:12:47.973905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:47.982234 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.982585 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.982838 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP,
    TMAX/10 ::DECIMAL as max_min_temperature_celsius,
    TMAX/10 ::DECIMAL as max_max_temperature_celsius,
    SNWD,
    SNOW

    
     from pivoted
  );

[0m15:12:47.983890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.986538 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.986820 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:12:47.987161 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.988808 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.989058 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:12:47.989377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.990427 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:12:47.990648 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.990839 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:12:47.991365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.993067 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:12:47.993356 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:12:47.993822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:12:47.994712 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:12:47.969520 => 15:12:47.994589
[0m15:12:47.994953 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:12:48.066739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9edfd55a-8d06-41e3-ad19-7907551962f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a56dbd0>]}
[0m15:12:48.067218 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:12:48.067557 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:12:48.068422 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:48.068663 [debug] [MainThread]: On master: BEGIN
[0m15:12:48.068838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:48.076490 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:12:48.076795 [debug] [MainThread]: On master: COMMIT
[0m15:12:48.076967 [debug] [MainThread]: Using duckdb connection "master"
[0m15:12:48.077136 [debug] [MainThread]: On master: COMMIT
[0m15:12:48.077332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:12:48.077509 [debug] [MainThread]: On master: Close
[0m15:12:48.080691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:48.080986 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m15:12:48.081204 [info ] [MainThread]: 
[0m15:12:48.081402 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 13.31 seconds (13.31s).
[0m15:12:48.081875 [debug] [MainThread]: Command end result
[0m15:12:48.088794 [info ] [MainThread]: 
[0m15:12:48.089112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:48.089322 [info ] [MainThread]: 
[0m15:12:48.089538 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:12:48.090817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.848035, "process_user_time": 43.924755, "process_kernel_time": 1.781932, "process_mem_max_rss": "3161243648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:48.091251 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:48.091177 after 13.85 seconds
[0m15:12:48.091501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a543c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a51d000>]}
[0m15:12:48.091734 [debug] [MainThread]: Flushing usage events
[0m15:13:52.677674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c938e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93cd0>]}


============================== 15:13:52.680057 | 9d9952a0-56f1-45b7-a8b4-81d683fca9b7 ==============================
[0m15:13:52.680057 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:13:52.680406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'send_anonymous_usage_stats': 'True'}
[0m15:13:52.867370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c93a00>]}
[0m15:13:52.940664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d408b0>]}
[0m15:13:52.941529 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:13:52.950704 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:13:52.972666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:13:52.973111 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m15:13:52.973343 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:13:53.076862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:13:53.079677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109394a00>]}
[0m15:13:53.085231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ad360>]}
[0m15:13:53.085554 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:13:53.085789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ad180>]}
[0m15:13:53.086669 [info ] [MainThread]: 
[0m15:13:53.087253 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:53.088115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:13:53.094922 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:13:53.095284 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:13:53.095479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:53.103667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.104625 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:13:53.106961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:13:53.107505 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:13:53.111626 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:13:53.111864 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:13:53.112032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:53.118916 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.120004 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:13:53.120238 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:13:53.120460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.120615 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:13:53.120774 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:13:53.121003 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.121415 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:13:53.121586 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:13:53.121737 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:13:53.121952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.122121 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:13:53.124813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:13:53.155899 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:13:53.156214 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:13:53.156390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:53.162733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.162982 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:13:53.163169 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:13:53.173255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:13:53.177246 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:13:53.178687 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:13:53.178886 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:13:53.190540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093d65c0>]}
[0m15:13:53.190854 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:53.191030 [debug] [MainThread]: On master: BEGIN
[0m15:13:53.191187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:53.197521 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:53.197764 [debug] [MainThread]: On master: COMMIT
[0m15:13:53.197930 [debug] [MainThread]: Using duckdb connection "master"
[0m15:13:53.198086 [debug] [MainThread]: On master: COMMIT
[0m15:13:53.198266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:13:53.198428 [debug] [MainThread]: On master: Close
[0m15:13:53.200649 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:13:53.200925 [info ] [MainThread]: 
[0m15:13:53.202361 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:13:53.202698 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:13:53.203133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:13:53.203363 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:13:53.205510 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:53.206051 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:13:53.203494 => 15:13:53.205918
[0m15:13:53.206279 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:13:53.225993 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:53.226629 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:53.226859 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:13:53.227064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:53.233997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:53.234367 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:53.234634 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:13:58.495051 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:13:58.500983 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:58.501243 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:13:58.501616 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:58.503869 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:58.504090 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:13:58.504366 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:13:58.514286 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:13:58.514527 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:13:58.514724 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:14:05.290513 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:14:05.293942 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:14:05.294190 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:14:05.300039 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.301006 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:13:53.206406 => 15:14:05.300852
[0m15:14:05.301241 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:14:05.548298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109407ca0>]}
[0m15:14:05.548860 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.35s]
[0m15:14:05.549223 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:14:05.549860 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:14:05.550202 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:14:05.550624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:14:05.550859 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:14:05.552728 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.555099 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:14:05.550991 => 15:14:05.554947
[0m15:14:05.555334 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:14:05.566858 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.567486 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.567728 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:14:05.567933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:05.574585 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.574886 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.575138 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:14:05.575714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.578239 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.578481 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:14:05.578803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.580344 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.580551 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:14:05.580815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.581800 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:14:05.581996 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.582176 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:14:05.582602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.584027 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:14:05.584250 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:14:05.584576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.585285 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:14:05.555462 => 15:14:05.585172
[0m15:14:05.585498 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:14:05.659140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947b4c0>]}
[0m15:14:05.659643 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:14:05.659996 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:14:05.660440 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:14:05.660765 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:14:05.661150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:14:05.661361 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:14:05.663877 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.665212 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:14:05.661483 => 15:14:05.665062
[0m15:14:05.665453 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:14:05.669002 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.669490 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.669701 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:14:05.669897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:05.676728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.677048 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.677309 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD,
    SNOW

    
     from pivoted
  );

[0m15:14:05.678352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.680921 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.681213 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:14:05.681558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.683275 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.683488 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:14:05.683760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.684738 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:14:05.684955 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.685142 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:14:05.685558 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.687281 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:14:05.687586 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:14:05.688064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.689126 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:14:05.665582 => 15:14:05.688986
[0m15:14:05.689398 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:14:05.759700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e34c0>]}
[0m15:14:05.760210 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:14:05.760549 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:14:05.761066 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:14:05.761403 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:14:05.761793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:14:05.762013 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:14:05.763932 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:05.765400 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:14:05.762139 => 15:14:05.765266
[0m15:14:05.765614 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:14:05.769165 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:05.769754 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:05.769967 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:14:05.770168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:05.777615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:05.777965 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:05.778195 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    SNOW,
    SNWD

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m15:14:07.169979 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:14:07.172107 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:07.173271 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m15:14:07.173660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:07.175255 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:07.175480 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m15:14:07.175752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:07.176816 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:14:07.177014 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:07.177199 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:14:07.179675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:07.181184 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:14:07.181398 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m15:14:07.181768 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:14:07.182486 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:14:05.765731 => 15:14:07.182372
[0m15:14:07.182688 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:14:07.297876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9952a0-56f1-45b7-a8b4-81d683fca9b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109433f70>]}
[0m15:14:07.298367 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 1.54s]
[0m15:14:07.298712 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:14:07.299597 [debug] [MainThread]: Using duckdb connection "master"
[0m15:14:07.299802 [debug] [MainThread]: On master: BEGIN
[0m15:14:07.299966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:07.306453 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:14:07.306747 [debug] [MainThread]: On master: COMMIT
[0m15:14:07.306922 [debug] [MainThread]: Using duckdb connection "master"
[0m15:14:07.307095 [debug] [MainThread]: On master: COMMIT
[0m15:14:07.307298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:14:07.307480 [debug] [MainThread]: On master: Close
[0m15:14:07.311341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:07.311631 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:14:07.311868 [info ] [MainThread]: 
[0m15:14:07.312085 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.22 seconds (14.22s).
[0m15:14:07.312672 [debug] [MainThread]: Command end result
[0m15:14:07.318082 [info ] [MainThread]: 
[0m15:14:07.318396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:07.318596 [info ] [MainThread]: 
[0m15:14:07.318801 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:14:07.320357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.684308, "process_user_time": 54.30158, "process_kernel_time": 1.906722, "process_mem_max_rss": "3045261312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:07.320788 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:07.320712 after 14.68 seconds
[0m15:14:07.321039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106acabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920b8e0>]}
[0m15:14:07.321277 [debug] [MainThread]: Flushing usage events
[0m15:20:04.737764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120cb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120cbc70>]}


============================== 15:20:04.740310 | b29c718f-4b0b-4493-8149-2be35c9892eb ==============================
[0m15:20:04.740310 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:20:04.740649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:05.015276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120cb9d0>]}
[0m15:20:05.088323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11214a1d0>]}
[0m15:20:05.089727 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:20:05.099774 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:20:05.123015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:05.123455 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/Intermediate/int_daily_climate_params_pivoted.sql
[0m15:20:05.225921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:20:05.228842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd89a0>]}
[0m15:20:05.234845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e9420>]}
[0m15:20:05.235191 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:20:05.235401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139e90c0>]}
[0m15:20:05.236197 [info ] [MainThread]: 
[0m15:20:05.236664 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:20:05.237348 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:20:05.243501 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:20:05.243797 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:20:05.244000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:05.256505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.257998 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:20:05.260873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:20:05.261343 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:20:05.265375 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:05.265601 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:20:05.265776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:05.272925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.273754 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:05.273931 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:20:05.274116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.274270 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:05.274428 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:20:05.274673 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.275091 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:20:05.275262 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:05.275415 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:20:05.275598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.275754 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:20:05.278207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:20:05.308578 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:20:05.308889 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:20:05.309055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:05.314908 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.315153 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:20:05.315338 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:20:05.326337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:05.330787 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:20:05.331423 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:20:05.331609 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:20:05.342654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123506d0>]}
[0m15:20:05.342952 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:05.343122 [debug] [MainThread]: On master: BEGIN
[0m15:20:05.343277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:05.349590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:05.349837 [debug] [MainThread]: On master: COMMIT
[0m15:20:05.350005 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:05.350161 [debug] [MainThread]: On master: COMMIT
[0m15:20:05.350336 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:05.350493 [debug] [MainThread]: On master: Close
[0m15:20:05.352460 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:20:05.352685 [info ] [MainThread]: 
[0m15:20:05.354033 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:05.354332 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:20:05.354722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:20:05.354956 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:05.357039 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:05.357918 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:20:05.355095 => 15:20:05.357762
[0m15:20:05.358167 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:05.377702 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:05.378328 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:05.378547 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:20:05.378742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:05.385621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:05.385962 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:05.386224 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:20:10.598532 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:20:10.602941 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:10.603194 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:20:10.603967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:10.606150 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:10.606371 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:20:10.606660 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:10.616446 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:20:10.616684 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:10.616883 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:20:17.279177 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:20:17.282700 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:17.282958 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:20:17.289873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.290831 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:20:05.358296 => 15:20:17.290696
[0m15:20:17.291061 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:20:17.532723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d43c70>]}
[0m15:20:17.533276 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.18s]
[0m15:20:17.533642 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:17.534174 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:20:17.534565 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:20:17.535019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:20:17.535257 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:20:17.537251 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.538733 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:20:17.535406 => 15:20:17.538570
[0m15:20:17.538968 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:20:17.550128 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.550903 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.551123 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:20:17.551312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.558427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.558746 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.558987 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:20:17.559526 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.561849 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.562083 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:20:17.562352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.563885 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.564100 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:20:17.564356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.565340 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:20:17.565537 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.565722 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:20:17.566115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.567481 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:20:17.567688 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:20:17.567996 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.568699 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:20:17.539090 => 15:20:17.568585
[0m15:20:17.568907 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:20:17.640291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113db7490>]}
[0m15:20:17.640753 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:20:17.641116 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:20:17.641566 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:20:17.641845 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:20:17.642218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:20:17.642432 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:20:17.645146 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.645908 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:20:17.642558 => 15:20:17.645759
[0m15:20:17.646243 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:20:17.649975 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.650426 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.650634 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:20:17.650822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.657364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.657642 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.657882 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m15:20:17.659786 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.662191 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.662424 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:20:17.662707 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.664248 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.664454 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:20:17.664721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.665636 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:20:17.665834 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.666011 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:20:17.666382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.667766 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:20:17.667970 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:20:17.668271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.668965 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:20:17.646484 => 15:20:17.668843
[0m15:20:17.669170 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:20:17.737435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a1e050>]}
[0m15:20:17.737905 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:20:17.738241 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:20:17.738677 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:20:17.739008 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:20:17.739383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:20:17.739598 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:20:17.741584 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:20:17.742627 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:20:17.739722 => 15:20:17.742447
[0m15:20:17.742891 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:20:17.746487 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:20:17.747018 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:20:17.747224 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:20:17.747401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:17.754663 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:17.754975 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:20:17.755195 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    PRCP,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    SNOW,
    SNWD

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m15:20:17.758589 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:20:17.743027 => 15:20:17.758461
[0m15:20:17.758816 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: ROLLBACK
[0m15:20:17.762276 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.fact_daily_climate_parameters'
[0m15:20:17.762492 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:20:17.766276 [debug] [Thread-1 (]: Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "PRCP" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.source_flag"
[0m15:20:17.766580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29c718f-4b0b-4493-8149-2be35c9892eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bc8b50>]}
[0m15:20:17.766955 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model dev_sode.fact_daily_climate_parameters ... [[31mERROR[0m in 0.03s]
[0m15:20:17.767294 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:20:17.768102 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:17.768293 [debug] [MainThread]: On master: BEGIN
[0m15:20:17.768447 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:17.774304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:17.774554 [debug] [MainThread]: On master: COMMIT
[0m15:20:17.774725 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:17.774894 [debug] [MainThread]: On master: COMMIT
[0m15:20:17.775092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:17.775311 [debug] [MainThread]: On master: Close
[0m15:20:17.778687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:17.778911 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:20:17.779127 [info ] [MainThread]: 
[0m15:20:17.779340 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 12.54 seconds (12.54s).
[0m15:20:17.779954 [debug] [MainThread]: Command end result
[0m15:20:17.786678 [info ] [MainThread]: 
[0m15:20:17.786999 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:17.787182 [info ] [MainThread]: 
[0m15:20:17.787366 [error] [MainThread]:   Runtime Error in model fact_daily_climate_parameters (models/marts/fact_daily_climate_parameters.sql)
  Binder Error: Referenced column "PRCP" not found in FROM clause!
  Candidate bindings: "int_daily_climate_params_pivoted.source_flag"
[0m15:20:17.787555 [info ] [MainThread]: 
[0m15:20:17.787747 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:20:17.789013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.092131, "process_user_time": 43.925323, "process_kernel_time": 1.600676, "process_mem_max_rss": "3550461952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:20:17.789385 [debug] [MainThread]: Command `dbt run` failed at 15:20:17.789318 after 13.09 seconds
[0m15:20:17.789613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120967a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a24bb0>]}
[0m15:20:17.789832 [debug] [MainThread]: Flushing usage events
[0m15:20:54.024778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074af8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074afcd0>]}


============================== 15:20:54.027150 | 196f769d-d64b-4407-8c7e-3262c39a1a72 ==============================
[0m15:20:54.027150 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:20:54.027489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:54.210522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074af9d0>]}
[0m15:20:54.283968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077febc0>]}
[0m15:20:54.284877 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:20:54.294064 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:20:54.315976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:54.316507 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/marts/fact_daily_climate_parameters.sql
[0m15:20:54.421544 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:20:54.424418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8a00>]}
[0m15:20:54.429865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9330>]}
[0m15:20:54.430217 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:20:54.430437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c9150>]}
[0m15:20:54.431242 [info ] [MainThread]: 
[0m15:20:54.431845 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:20:54.432657 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:20:54.439519 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:20:54.439839 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:20:54.440022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:54.447993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.449237 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:20:54.452207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:20:54.452693 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:20:54.457265 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:54.457562 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:20:54.457764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:54.465270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.466186 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:54.466393 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:20:54.466593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.466747 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:54.466902 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:20:54.467116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.467518 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:20:54.467687 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:20:54.467839 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:20:54.468031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.468196 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:20:54.471137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:20:54.502936 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:20:54.503261 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:20:54.503437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:54.509773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.510049 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:20:54.510237 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:20:54.520360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.524363 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:20:54.525980 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:20:54.526192 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:20:54.538087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752dcc0>]}
[0m15:20:54.538425 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.538609 [debug] [MainThread]: On master: BEGIN
[0m15:20:54.538771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:54.545496 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.545762 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.545937 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.546097 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.546281 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.546443 [debug] [MainThread]: On master: Close
[0m15:20:54.548431 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:20:54.548655 [info ] [MainThread]: 
[0m15:20:54.550099 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:54.550406 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:20:54.550812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:20:54.551036 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:54.553193 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:54.553747 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:20:54.551163 => 15:20:54.553608
[0m15:20:54.553976 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:20:54.574660 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:54.575321 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:54.575541 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:20:54.575740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:54.582166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:54.582491 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:54.582743 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:20:59.801142 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:20:59.805723 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:59.806007 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m15:20:59.806380 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:59.808574 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:59.808801 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:20:59.809098 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:59.818947 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:20:59.819192 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:20:59.819399 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:21:06.557153 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m15:21:06.560404 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:21:06.560650 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:21:06.566563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.567514 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:20:54.554107 => 15:21:06.567349
[0m15:21:06.567746 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:21:06.808134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c23cd0>]}
[0m15:21:06.808697 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 12.26s]
[0m15:21:06.809060 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:21:06.809592 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:21:06.809917 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:21:06.810348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:21:06.810592 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:21:06.812379 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.812940 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:21:06.810729 => 15:21:06.812811
[0m15:21:06.813157 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:21:06.824834 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.825771 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.826023 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:21:06.826253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:06.834909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.835214 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.835457 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m15:21:06.836006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.838359 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.838598 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m15:21:06.838910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.840488 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.840691 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:21:06.840950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.841927 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:21:06.842120 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.842302 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:21:06.842732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.844191 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:21:06.844408 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:21:06.844730 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.845477 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:21:06.813285 => 15:21:06.845361
[0m15:21:06.845684 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:21:06.916053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c974f0>]}
[0m15:21:06.916528 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:21:06.916896 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:21:06.917387 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:21:06.917748 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:21:06.918143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:21:06.918372 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:21:06.921236 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.922030 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:21:06.918502 => 15:21:06.921864
[0m15:21:06.922272 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:21:06.925985 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.926610 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.926838 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:21:06.927037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:06.933807 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.934133 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.934376 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m15:21:06.935359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.937766 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.938019 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m15:21:06.938326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.939872 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.940080 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:21:06.940354 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.941472 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:21:06.941782 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.941989 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:21:06.942459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.944081 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:21:06.944290 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:21:06.944629 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:06.945414 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:21:06.922398 => 15:21:06.945292
[0m15:21:06.945624 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:21:07.019761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fff10>]}
[0m15:21:07.020229 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:21:07.020585 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:21:07.021053 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:21:07.021361 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:21:07.021753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:21:07.021969 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:21:07.023895 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:07.024797 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:21:07.022157 => 15:21:07.024654
[0m15:21:07.025029 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:21:07.028549 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:07.029218 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:07.029466 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:21:07.029673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:07.036231 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:07.036527 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:07.036746 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m15:21:08.432433 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:21:08.434529 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:08.435601 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m15:21:08.435960 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:08.437507 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:08.437725 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m15:21:08.438001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:08.439072 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:21:08.439272 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:08.439457 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:21:08.441894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:08.443377 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:21:08.443607 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m15:21:08.443976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:08.444677 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:21:07.025157 => 15:21:08.444562
[0m15:21:08.444884 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:21:08.556352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '196f769d-d64b-4407-8c7e-3262c39a1a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f00a00>]}
[0m15:21:08.556855 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 1.53s]
[0m15:21:08.557198 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:21:08.558085 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:08.558296 [debug] [MainThread]: On master: BEGIN
[0m15:21:08.558460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:08.565777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:08.566133 [debug] [MainThread]: On master: COMMIT
[0m15:21:08.566310 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:08.566478 [debug] [MainThread]: On master: COMMIT
[0m15:21:08.566696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:08.566882 [debug] [MainThread]: On master: Close
[0m15:21:08.571302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:08.571634 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:21:08.571866 [info ] [MainThread]: 
[0m15:21:08.572080 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.14 seconds (14.14s).
[0m15:21:08.572638 [debug] [MainThread]: Command end result
[0m15:21:08.582579 [info ] [MainThread]: 
[0m15:21:08.582889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:08.583089 [info ] [MainThread]: 
[0m15:21:08.583287 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:21:08.584771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.600895, "process_user_time": 54.254227, "process_kernel_time": 1.842778, "process_mem_max_rss": "3668148224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:21:08.585160 [debug] [MainThread]: Command `dbt run` succeeded at 15:21:08.585089 after 14.60 seconds
[0m15:21:08.585398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077febc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfd0c0>]}
[0m15:21:08.585628 [debug] [MainThread]: Flushing usage events
[0m15:32:06.536134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f26bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ef8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050efcd0>]}


============================== 15:32:06.538673 | dab4f1f6-fc4b-44d4-aa0e-2390181b2b10 ==============================
[0m15:32:06.538673 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:32:06.539065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:06.817151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050efa00>]}
[0m15:32:06.890648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a08b0>]}
[0m15:32:06.891340 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:32:06.901613 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:32:06.926585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:32:06.926918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:32:06.927405 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:32:06.931317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105652290>]}
[0m15:32:06.937601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560d360>]}
[0m15:32:06.937943 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:32:06.938155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10560d180>]}
[0m15:32:06.938873 [info ] [MainThread]: 
[0m15:32:06.939320 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:32:06.940058 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:32:06.947799 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:32:06.948141 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:32:06.948338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:06.958276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.960075 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:32:06.962089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:32:06.962554 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:32:06.966790 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:32:06.967104 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:32:06.967290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:06.971015 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.971978 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:32:06.972156 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:32:06.972366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.972511 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:32:06.972666 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:32:06.972925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.973336 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:32:06.973499 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:32:06.973645 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:32:06.973837 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.973996 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:32:06.975888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:32:06.979214 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:32:06.979449 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:32:06.979609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:06.982593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.982858 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:32:06.983057 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:32:06.993798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:06.996936 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:32:06.997573 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:32:06.997764 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:32:06.999440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105683cd0>]}
[0m15:32:06.999713 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:06.999878 [debug] [MainThread]: On master: BEGIN
[0m15:32:07.000029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:07.002533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:07.002723 [debug] [MainThread]: On master: COMMIT
[0m15:32:07.002878 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:07.003031 [debug] [MainThread]: On master: COMMIT
[0m15:32:07.003208 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:07.003368 [debug] [MainThread]: On master: Close
[0m15:32:07.004407 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:32:07.004626 [info ] [MainThread]: 
[0m15:32:07.006023 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:32:07.006338 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:32:07.006736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:32:07.006970 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:32:07.009088 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:07.009834 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:32:07.007109 => 15:32:07.009687
[0m15:32:07.010077 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:32:07.029420 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:07.029997 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:07.030216 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:32:07.030411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:07.033486 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:32:07.033780 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:07.034040 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:32:12.114569 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m15:32:12.119177 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:12.119438 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:32:12.120327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:32:12.129283 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:32:12.129521 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:12.129723 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:32:18.568262 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m15:32:18.571629 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:32:18.571881 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:32:18.572471 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:32:18.573452 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:32:07.010207 => 15:32:18.573314
[0m15:32:18.573683 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:32:18.786043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab4f1f6-fc4b-44d4-aa0e-2390181b2b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cc160>]}
[0m15:32:18.786598 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 11.78s]
[0m15:32:18.786951 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:32:18.788003 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:18.788282 [debug] [MainThread]: On master: BEGIN
[0m15:32:18.788450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:18.792823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:18.793041 [debug] [MainThread]: On master: COMMIT
[0m15:32:18.793206 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:18.793359 [debug] [MainThread]: On master: COMMIT
[0m15:32:18.793536 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:18.793693 [debug] [MainThread]: On master: Close
[0m15:32:18.794974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:18.795222 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m15:32:18.795428 [info ] [MainThread]: 
[0m15:32:18.795652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.86 seconds (11.86s).
[0m15:32:18.796038 [debug] [MainThread]: Command end result
[0m15:32:18.802708 [info ] [MainThread]: 
[0m15:32:18.803000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:18.803194 [info ] [MainThread]: 
[0m15:32:18.803405 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:32:18.805114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.311458, "process_user_time": 43.466927, "process_kernel_time": 1.506038, "process_mem_max_rss": "3763716096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:32:18.805680 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:18.805604 after 12.31 seconds
[0m15:32:18.806151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f26bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105276fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cc160>]}
[0m15:32:18.806394 [debug] [MainThread]: Flushing usage events
[0m15:35:32.990662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d26bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eef8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eefd30>]}


============================== 15:35:32.993143 | 47fd8ce6-4fa6-4074-850a-cb8824756f5d ==============================
[0m15:35:32.993143 [info ] [MainThread]: Running with dbt=1.7.6
[0m15:35:32.993498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'send_anonymous_usage_stats': 'True'}
[0m15:35:33.208583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109032e60>]}
[0m15:35:33.281501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a4730>]}
[0m15:35:33.282402 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m15:35:33.292047 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m15:35:33.313427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:33.313724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:33.314163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:35:33.318059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094522c0>]}
[0m15:35:33.323662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940d4e0>]}
[0m15:35:33.323992 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:35:33.324199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940d1e0>]}
[0m15:35:33.324958 [info ] [MainThread]: 
[0m15:35:33.325471 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:35:33.326186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:35:33.332922 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:35:33.333244 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:35:33.333489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:33.341268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.343102 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:35:33.344813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:35:33.345204 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:35:33.348811 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:35:33.349037 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m15:35:33.349217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:33.352508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.353326 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:35:33.353513 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:35:33.353708 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.353864 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:35:33.354026 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m15:35:33.354289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.354680 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:35:33.354863 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:35:33.355028 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:35:33.355223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.355379 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:35:33.357041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:35:33.359985 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:35:33.360192 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:35:33.360349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:33.362901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.363102 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:35:33.363284 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:35:33.374050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:35:33.376960 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:35:33.377590 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:35:33.377779 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:35:33.379155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109440100>]}
[0m15:35:33.379432 [debug] [MainThread]: Using duckdb connection "master"
[0m15:35:33.379596 [debug] [MainThread]: On master: BEGIN
[0m15:35:33.379747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:33.382059 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:35:33.382243 [debug] [MainThread]: On master: COMMIT
[0m15:35:33.382398 [debug] [MainThread]: Using duckdb connection "master"
[0m15:35:33.382548 [debug] [MainThread]: On master: COMMIT
[0m15:35:33.382718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:35:33.382876 [debug] [MainThread]: On master: Close
[0m15:35:33.383803 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:35:33.384013 [info ] [MainThread]: 
[0m15:35:33.385407 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:35:33.385696 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:35:33.386080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:35:33.386304 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:35:33.388430 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:35:33.388971 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:35:33.386622 => 15:35:33.388780
[0m15:35:33.389206 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:35:33.407306 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:35:33.407997 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:35:33.408258 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:35:33.408462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:33.411016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:35:33.411245 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:35:33.411494 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:35:33.423226 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:35:33.389352 => 15:35:33.423077
[0m15:35:33.423471 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: ROLLBACK
[0m15:35:33.426694 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw'
[0m15:35:33.426913 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:35:33.428537 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters_vertical_raw (models/staging/stg_daily_climate_parameters_vertical_raw.sql)
  Catalog Error: Table with name noaa_ghcn_2022 does not exist!
  Did you mean "pg_catalog.pg_am"?
[0m15:35:33.428850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47fd8ce6-4fa6-4074-850a-cb8824756f5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094a2dd0>]}
[0m15:35:33.429203 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[31mERROR[0m in 0.04s]
[0m15:35:33.429542 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:35:33.430307 [debug] [MainThread]: Using duckdb connection "master"
[0m15:35:33.430506 [debug] [MainThread]: On master: BEGIN
[0m15:35:33.430668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:33.433271 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:35:33.433531 [debug] [MainThread]: On master: COMMIT
[0m15:35:33.433705 [debug] [MainThread]: Using duckdb connection "master"
[0m15:35:33.433874 [debug] [MainThread]: On master: COMMIT
[0m15:35:33.434061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:35:33.434223 [debug] [MainThread]: On master: Close
[0m15:35:33.435298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:33.435548 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m15:35:33.435751 [info ] [MainThread]: 
[0m15:35:33.435957 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m15:35:33.436331 [debug] [MainThread]: Command end result
[0m15:35:33.441364 [info ] [MainThread]: 
[0m15:35:33.441659 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:33.442090 [info ] [MainThread]: 
[0m15:35:33.442313 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters_vertical_raw (models/staging/stg_daily_climate_parameters_vertical_raw.sql)
  Catalog Error: Table with name noaa_ghcn_2022 does not exist!
  Did you mean "pg_catalog.pg_am"?
[0m15:35:33.442513 [info ] [MainThread]: 
[0m15:35:33.442714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:33.443998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.493639, "process_user_time": 1.404438, "process_kernel_time": 0.140567, "process_mem_max_rss": "139018240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:35:33.444444 [debug] [MainThread]: Command `dbt run` failed at 15:35:33.444374 after 0.49 seconds
[0m15:35:33.444701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d26bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cfc10>]}
[0m15:35:33.444977 [debug] [MainThread]: Flushing usage events
[0m16:03:13.957649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073038b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107303d30>]}


============================== 16:03:13.960476 | e703a384-4313-4f32-b561-a1721dafbda8 ==============================
[0m16:03:13.960476 [info ] [MainThread]: Running with dbt=1.7.6
[0m16:03:13.960852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:03:14.212695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107446e60>]}
[0m16:03:14.286125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b2b60>]}
[0m16:03:14.286811 [info ] [MainThread]: Registered adapter: duckdb=1.7.1
[0m16:03:14.296164 [debug] [MainThread]: checksum: d62e513342251256fdf8c77c78ccf3e0bf76720e6e4e8384a98b7479399def9a, vars: {}, profile: , target: , version: 1.7.6
[0m16:03:14.320155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:14.320602 [debug] [MainThread]: Partial parsing: updated file: climate_works_dbt://models/staging/stg_daily_climate_parameters_vertical_raw.sql
[0m16:03:14.424541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:03:14.427282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a08ac0>]}
[0m16:03:14.433342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078254e0>]}
[0m16:03:14.433653 [info ] [MainThread]: Found 2 seeds, 5 models, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:03:14.433874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078251e0>]}
[0m16:03:14.434638 [info ] [MainThread]: 
[0m16:03:14.435074 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:14.435792 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:03:14.442152 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:03:14.442428 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:03:14.442608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:14.451399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.452882 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:03:14.454866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:03:14.455336 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:03:14.459249 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:03:14.459459 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
        select type from duckdb_databases()
        where database_name='dev_database'
        and type='sqlite'
    
  
[0m16:03:14.459633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:14.463870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.464702 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:03:14.464898 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:03:14.465104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.465268 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:03:14.465445 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */

    
    
        create schema if not exists "dev_database"."dev_sode"
    
[0m16:03:14.465711 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.466141 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:03:14.466323 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:03:14.466488 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:03:14.466694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.466867 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:03:14.468621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:03:14.498389 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:03:14.498718 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:03:14.498893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:14.501782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.501979 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:03:14.502162 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:03:14.512930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:14.515940 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:03:14.516592 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:03:14.516799 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:03:14.518581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4d1e0>]}
[0m16:03:14.518855 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:14.519017 [debug] [MainThread]: On master: BEGIN
[0m16:03:14.519170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:14.521663 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:14.521868 [debug] [MainThread]: On master: COMMIT
[0m16:03:14.522024 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:14.522177 [debug] [MainThread]: On master: COMMIT
[0m16:03:14.522347 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:14.522500 [debug] [MainThread]: On master: Close
[0m16:03:14.523584 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:03:14.523778 [info ] [MainThread]: 
[0m16:03:14.524926 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:03:14.525195 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m16:03:14.525675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:03:14.525878 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:03:14.527633 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:14.528379 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:03:14.525994 => 16:03:14.528243
[0m16:03:14.528602 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:03:14.546622 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:14.547480 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:14.547707 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:03:14.547911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:14.551063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:14.551358 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:14.551621 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m16:03:19.817291 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m16:03:19.821150 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:19.821406 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:03:19.822279 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:19.831180 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:03:19.831422 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:19.831633 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:03:26.125893 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m16:03:26.129077 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:03:26.129334 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:03:26.129907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.130731 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:03:14.528724 => 16:03:26.130610
[0m16:03:26.130951 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:03:26.325647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107824fd0>]}
[0m16:03:26.326157 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 11.80s]
[0m16:03:26.326520 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:03:26.327007 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:03:26.327262 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:03:26.327684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:03:26.327923 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:03:26.330342 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.330840 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:03:26.328056 => 16:03:26.330721
[0m16:03:26.331058 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:03:26.342356 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.343241 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.343478 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:03:26.343680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:26.348587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.348850 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.349085 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as (

    select
        record_id ::varchar as record_id,
        array_slice(reading_date,1,4) ::INTEGER as year,
        array_slice(reading_date,5,6) ::INTEGER as month,
        array_slice(reading_date,7,8) ::INTEGER as day,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as (

  select 
        record_id,
        make_date(year,month,day) ::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null 
)

select * from final
  );

[0m16:03:26.349626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.351401 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.351617 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:03:26.351885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.352714 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:03:26.352974 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.353229 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:03:26.354091 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.355812 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:03:26.356046 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:03:26.356318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.357113 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:03:26.331185 => 16:03:26.356985
[0m16:03:26.357347 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:03:26.413025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107827400>]}
[0m16:03:26.413474 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m16:03:26.413810 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:03:26.414220 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:03:26.414512 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:03:26.414917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:03:26.415137 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:03:26.416869 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.417573 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:03:26.415256 => 16:03:26.417453
[0m16:03:26.417787 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:03:26.419942 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.420532 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.420770 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:03:26.420982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:26.424304 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.424595 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.424841 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m16:03:26.426987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.429003 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.429271 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:03:26.429626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.430613 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:03:26.430847 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.431038 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:03:26.431461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.433750 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:03:26.434016 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:03:26.434319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.435130 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:03:26.417906 => 16:03:26.435011
[0m16:03:26.435344 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:03:26.490641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b088e0>]}
[0m16:03:26.491144 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m16:03:26.491499 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:03:26.491943 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:03:26.492239 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m16:03:26.492611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m16:03:26.492821 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:03:26.494588 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:26.495246 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 16:03:26.492940 => 16:03:26.495095
[0m16:03:26.495485 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:03:26.497823 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:26.498544 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:26.498803 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m16:03:26.499011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:26.502190 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:26.502456 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:26.502686 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m16:03:27.880591 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:03:27.882748 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:27.882985 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m16:03:27.883333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:27.884384 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m16:03:27.884587 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:27.884774 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m16:03:27.887136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:27.888507 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:03:27.888719 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.6", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m16:03:27.888975 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:27.889687 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 16:03:26.495613 => 16:03:27.889573
[0m16:03:27.889906 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m16:03:27.980193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e703a384-4313-4f32-b561-a1721dafbda8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107af76d0>]}
[0m16:03:27.980723 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 1.49s]
[0m16:03:27.981075 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:03:27.981921 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:27.982154 [debug] [MainThread]: On master: BEGIN
[0m16:03:27.982335 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:27.985581 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:27.985850 [debug] [MainThread]: On master: COMMIT
[0m16:03:27.986032 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:27.986202 [debug] [MainThread]: On master: COMMIT
[0m16:03:27.986397 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:27.986578 [debug] [MainThread]: On master: Close
[0m16:03:27.989213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:27.989487 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m16:03:27.989711 [info ] [MainThread]: 
[0m16:03:27.989917 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 13.55 seconds (13.55s).
[0m16:03:27.990451 [debug] [MainThread]: Command end result
[0m16:03:27.996725 [info ] [MainThread]: 
[0m16:03:27.997001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:27.997177 [info ] [MainThread]: 
[0m16:03:27.997359 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:03:27.998835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.083471, "process_user_time": 53.860546, "process_kernel_time": 1.577036, "process_mem_max_rss": "3787915264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:03:27.999190 [debug] [MainThread]: Command `dbt run` succeeded at 16:03:27.999117 after 14.08 seconds
[0m16:03:27.999442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b088e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107446e60>]}
[0m16:03:27.999679 [debug] [MainThread]: Flushing usage events
[0m16:24:39.112161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba6af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7b390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba7b890>]}


============================== 16:24:39.114871 | d0732290-2e34-47fc-962e-5a81af498a9f ==============================
[0m16:24:39.114871 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:24:39.115168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:24:39.189767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0732290-2e34-47fc-962e-5a81af498a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b096590>]}
[0m16:24:39.190224 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:24:39.190690 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:24:39.192243 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.114121415, "process_user_time": 0.920492, "process_kernel_time": 0.099503, "process_mem_max_rss": "108642304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:24:39.192635 [debug] [MainThread]: Command `cli deps` succeeded at 16:24:39.192555 after 0.11 seconds
[0m16:24:39.192853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f4b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb7b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab3d90>]}
[0m16:24:39.193050 [debug] [MainThread]: Flushing usage events
[0m16:26:15.040917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109427090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109427450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109433fd0>]}


============================== 16:26:15.043488 | 15db4db4-8c15-44cf-86d9-33eb60a4ee96 ==============================
[0m16:26:15.043488 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:26:15.043788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m16:26:15.113097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15db4db4-8c15-44cf-86d9-33eb60a4ee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094cf0d0>]}
[0m16:26:15.113581 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:26:15.114030 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:26:15.115107 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.107311875, "process_user_time": 0.897977, "process_kernel_time": 0.094699, "process_mem_max_rss": "105398272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:15.115451 [debug] [MainThread]: Command `dbt deps` succeeded at 16:26:15.115374 after 0.11 seconds
[0m16:26:15.115649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109430510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea8f90>]}
[0m16:26:15.115821 [debug] [MainThread]: Flushing usage events
[0m16:26:22.848073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bb450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cb850>]}


============================== 16:26:22.850339 | 61943bc0-dc81-4ddd-8da0-477195cb521c ==============================
[0m16:26:22.850339 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:26:22.850661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:26:22.850981 [info ] [MainThread]: dbt version: 1.7.8
[0m16:26:22.851154 [info ] [MainThread]: python version: 3.11.7
[0m16:26:22.851311 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.11/bin/python3.11
[0m16:26:22.851451 [info ] [MainThread]: os info: macOS-14.1.2-arm64-arm-64bit
[0m16:26:22.933778 [info ] [MainThread]: Using profiles dir at /Users/raajassode/dev/climate_works_dbt
[0m16:26:22.934079 [info ] [MainThread]: Using profiles.yml file at /Users/raajassode/dev/climate_works_dbt/profiles.yml
[0m16:26:22.934247 [info ] [MainThread]: Using dbt_project.yml file at /Users/raajassode/dev/climate_works_dbt/dbt_project.yml
[0m16:26:22.934505 [info ] [MainThread]: adapter type: duckdb
[0m16:26:22.934653 [info ] [MainThread]: adapter version: 1.7.0
[0m16:26:22.985760 [info ] [MainThread]: Configuration:
[0m16:26:22.986076 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:26:22.986231 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:26:22.986371 [info ] [MainThread]: Required dependencies:
[0m16:26:22.986639 [debug] [MainThread]: Executing "git --help"
[0m16:26:22.998615 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:26:22.999324 [debug] [MainThread]: STDERR: "b''"
[0m16:26:22.999532 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:26:22.999706 [info ] [MainThread]: Connection:
[0m16:26:22.999895 [info ] [MainThread]:   database: dev_database
[0m16:26:23.000030 [info ] [MainThread]:   schema: dev_sode
[0m16:26:23.000161 [info ] [MainThread]:   path: ./dev_database.duckdb
[0m16:26:23.000294 [info ] [MainThread]:   config_options: None
[0m16:26:23.000420 [info ] [MainThread]:   extensions: None
[0m16:26:23.000548 [info ] [MainThread]:   settings: None
[0m16:26:23.000677 [info ] [MainThread]:   external_root: .
[0m16:26:23.000806 [info ] [MainThread]:   use_credential_provider: None
[0m16:26:23.000932 [info ] [MainThread]:   attach: None
[0m16:26:23.001062 [info ] [MainThread]:   filesystems: None
[0m16:26:23.001191 [info ] [MainThread]:   remote: None
[0m16:26:23.001315 [info ] [MainThread]:   plugins: None
[0m16:26:23.001443 [info ] [MainThread]:   disable_transactions: False
[0m16:26:23.001696 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m16:26:23.027079 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m16:26:23.027616 [debug] [MainThread]: Using duckdb connection "debug"
[0m16:26:23.027778 [debug] [MainThread]: On debug: select 1 as id
[0m16:26:23.027935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:23.044804 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:23.045632 [debug] [MainThread]: On debug: Close
[0m16:26:23.047103 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:26:23.047390 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:26:23.048593 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23282558, "process_user_time": 0.978761, "process_kernel_time": 0.098301, "process_mem_max_rss": "126287872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:26:23.048919 [debug] [MainThread]: Command `cli debug` succeeded at 16:26:23.048851 after 0.23 seconds
[0m16:26:23.049114 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:26:23.049305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103debc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057feb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105531e50>]}
[0m16:26:23.049534 [debug] [MainThread]: Flushing usage events
[0m19:19:10.208173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112532590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a4d50>]}


============================== 19:19:10.210534 | 02700718-2b1d-41a8-829e-d8a8eed3de9f ==============================
[0m19:19:10.210534 [info ] [MainThread]: Running with dbt=1.7.8
[0m19:19:10.210850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:10.348003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02700718-2b1d-41a8-829e-d8a8eed3de9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bbc50>]}
[0m19:19:10.405295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02700718-2b1d-41a8-829e-d8a8eed3de9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112561090>]}
[0m19:19:10.406006 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m19:19:10.414703 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m19:19:10.428780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:10.429061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:10.429559 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m19:19:10.432556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02700718-2b1d-41a8-829e-d8a8eed3de9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257c610>]}
[0m19:19:10.438578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02700718-2b1d-41a8-829e-d8a8eed3de9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11332f290>]}
[0m19:19:10.438899 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:19:10.439082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02700718-2b1d-41a8-829e-d8a8eed3de9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125da710>]}
[0m19:19:10.440108 [info ] [MainThread]: 
[0m19:19:10.440569 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:19:10.441191 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m19:19:10.447076 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m19:19:10.447419 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m19:19:10.447605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:10.454788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:10.455050 [debug] [MainThread]: Connection 'list_dev_database' was properly closed.
[0m19:19:10.455355 [info ] [MainThread]: 
[0m19:19:10.455560 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.01 seconds (0.01s).
[0m19:19:10.455842 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/raajassode/dev/climate_works_dbt/./dev_database.duckdb": Conflicting lock is held in /usr/local/bin/node (PID 80050) by user raajassode. However, you would be able to open this database in read-only mode, e.g. by using the -readonly parameter in the CLI. See also https://duckdb.org/docs/connect/concurrency
[0m19:19:10.457280 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2845019, "process_user_time": 1.066966, "process_kernel_time": 0.109106, "process_mem_max_rss": "130629632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:19:10.457679 [debug] [MainThread]: Command `dbt run` failed at 19:19:10.457612 after 0.28 seconds
[0m19:19:10.457898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11256e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdd1d0>]}
[0m19:19:10.458100 [debug] [MainThread]: Flushing usage events
[0m19:19:39.246418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa6d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aa7fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa4f10>]}


============================== 19:19:39.248585 | 73787244-b96b-46cd-8f36-ba90cf68d6d4 ==============================
[0m19:19:39.248585 [info ] [MainThread]: Running with dbt=1.7.8
[0m19:19:39.248897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters+', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:19:39.388689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae2bdd0>]}
[0m19:19:39.446341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adab810>]}
[0m19:19:39.447819 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m19:19:39.459261 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m19:19:39.473665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:39.473971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:39.474465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m19:19:39.477448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aad4b10>]}
[0m19:19:39.483087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aefca90>]}
[0m19:19:39.483371 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:19:39.483562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b849410>]}
[0m19:19:39.484599 [info ] [MainThread]: 
[0m19:19:39.485124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:19:39.485782 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m19:19:39.491242 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m19:19:39.491618 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m19:19:39.491878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:39.507830 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.508973 [debug] [ThreadPool]: On list_dev_database: Close
[0m19:19:39.510740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m19:19:39.511116 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m19:19:39.513523 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:19:39.513694 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m19:19:39.513831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:39.517812 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.518011 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:19:39.518161 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m19:19:39.518688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.519171 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m19:19:39.519328 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:19:39.519454 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m19:19:39.519722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.519869 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m19:19:39.521607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m19:19:39.524509 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m19:19:39.524664 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m19:19:39.524788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:39.527970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.528147 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m19:19:39.528302 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m19:19:39.545763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:19:39.549167 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m19:19:39.549886 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m19:19:39.550052 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m19:19:39.552001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8e1310>]}
[0m19:19:39.552249 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:39.552383 [debug] [MainThread]: On master: BEGIN
[0m19:19:39.552507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:39.555728 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:39.555913 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.556052 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:39.556177 [debug] [MainThread]: On master: COMMIT
[0m19:19:39.556343 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:39.556482 [debug] [MainThread]: On master: Close
[0m19:19:39.557525 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m19:19:39.557690 [info ] [MainThread]: 
[0m19:19:39.559105 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:19:39.559351 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m19:19:39.559670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m19:19:39.559840 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:19:39.563604 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:39.564260 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 19:19:39.559938 => 19:19:39.564117
[0m19:19:39.564485 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:19:39.580263 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:39.580814 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:39.580992 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m19:19:39.581150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:39.584648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:39.584878 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:39.585088 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m19:19:45.209908 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m19:19:45.215029 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:45.215251 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m19:19:45.216351 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:45.217824 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:45.218023 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m19:19:45.218305 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:45.227142 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m19:19:45.227344 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:45.227507 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m19:19:46.534406 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m19:19:46.537315 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:19:46.537522 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m19:19:46.546723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.547712 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 19:19:39.564596 => 19:19:46.547551
[0m19:19:46.547948 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m19:19:46.845329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b92aed0>]}
[0m19:19:46.845932 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 7.29s]
[0m19:19:46.846257 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:19:46.846906 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:19:46.847174 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m19:19:46.847522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m19:19:46.847687 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:19:46.849274 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.850005 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 19:19:46.847788 => 19:19:46.849900
[0m19:19:46.850171 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:19:46.858708 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.859266 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.859443 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m19:19:46.859607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:46.863633 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.863942 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.864206 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m19:19:46.864897 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.866603 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.866787 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m19:19:46.867081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.869400 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.869606 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m19:19:46.869883 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.870731 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m19:19:46.870900 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.871081 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m19:19:46.871619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.872782 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:19:46.872952 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m19:19:46.873282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.873887 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 19:19:46.850267 => 19:19:46.873789
[0m19:19:46.874055 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m19:19:46.938853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb20310>]}
[0m19:19:46.939315 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m19:19:46.939608 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:19:46.939976 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:19:46.940255 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m19:19:46.940613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m19:19:46.940788 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:19:46.942428 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.943183 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 19:19:46.940904 => 19:19:46.943061
[0m19:19:46.943362 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:19:46.945227 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.945546 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.945709 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m19:19:46.945865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:46.949961 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.950240 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.950449 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m19:19:46.952303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.953983 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.954164 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m19:19:46.954448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.955737 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.955920 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m19:19:46.956206 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.957057 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m19:19:46.957227 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.957376 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m19:19:46.957849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.959283 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:19:46.959547 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m19:19:46.960013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:46.960721 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 19:19:46.943464 => 19:19:46.960622
[0m19:19:46.960890 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m19:19:47.030840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b979050>]}
[0m19:19:47.031260 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.09s]
[0m19:19:47.031551 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:19:47.031950 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:19:47.032205 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m19:19:47.032546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m19:19:47.032724 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:19:47.034333 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.034953 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 19:19:47.032822 => 19:19:47.034847
[0m19:19:47.035124 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:19:47.036873 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.037178 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.037341 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m19:19:47.037498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:47.041728 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.042031 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.042231 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
)

select * from source
    );
  
  
[0m19:19:47.368293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.369959 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.370148 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m19:19:47.370485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.371749 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.371980 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m19:19:47.372237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.373154 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m19:19:47.373309 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.373459 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m19:19:47.374375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.375598 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:19:47.375777 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m19:19:47.376113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:19:47.376737 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 19:19:47.035223 => 19:19:47.376629
[0m19:19:47.376907 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m19:19:47.478766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73787244-b96b-46cd-8f36-ba90cf68d6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb288d0>]}
[0m19:19:47.479180 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.45s]
[0m19:19:47.479458 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:19:47.480290 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:47.480438 [debug] [MainThread]: On master: BEGIN
[0m19:19:47.480565 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:47.484196 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:47.484388 [debug] [MainThread]: On master: COMMIT
[0m19:19:47.484528 [debug] [MainThread]: Using duckdb connection "master"
[0m19:19:47.484658 [debug] [MainThread]: On master: COMMIT
[0m19:19:47.484826 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:19:47.484962 [debug] [MainThread]: On master: Close
[0m19:19:47.486167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:47.486355 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m19:19:47.486561 [info ] [MainThread]: 
[0m19:19:47.486741 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 8.00 seconds (8.00s).
[0m19:19:47.487371 [debug] [MainThread]: Command end result
[0m19:19:47.530826 [info ] [MainThread]: 
[0m19:19:47.531086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:47.531249 [info ] [MainThread]: 
[0m19:19:47.531402 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:19:47.532627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.321573, "process_user_time": 47.939686, "process_kernel_time": 2.421998, "process_mem_max_rss": "3430957056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:19:47.532886 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:47.532832 after 8.32 seconds
[0m19:19:47.533070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3d8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd62d0>]}
[0m19:19:47.533251 [debug] [MainThread]: Flushing usage events
[0m05:56:57.333825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555a290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105511210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df3b10>]}


============================== 05:56:57.337361 | 8ac8ab49-8b36-4fce-b936-ca3e5239793a ==============================
[0m05:56:57.337361 [info ] [MainThread]: Running with dbt=1.7.8
[0m05:56:57.337764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:56:57.555137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105729210>]}
[0m05:56:57.617154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055da290>]}
[0m05:56:57.618491 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m05:56:57.628155 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m05:56:57.633337 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m05:56:57.633642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a06710>]}
[0m05:56:58.182386 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m05:56:58.184834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c3fd50>]}
[0m05:56:58.190497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea5850>]}
[0m05:56:58.190818 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m05:56:58.191015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac8ab49-8b36-4fce-b936-ca3e5239793a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc40d0>]}
[0m05:56:58.191959 [info ] [MainThread]: 
[0m05:56:58.192345 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:56:58.193024 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_climate_works_dev_sode'
[0m05:56:58.197941 [debug] [ThreadPool]: Using duckdb connection "list_climate_works_dev_sode"
[0m05:56:58.198217 [debug] [ThreadPool]: On list_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works_dev_sode"} */
select
      'climate_works' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'climate_works'
  
[0m05:56:58.198384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:57:00.571706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:57:00.571981 [debug] [MainThread]: Connection 'list_climate_works_dev_sode' was properly closed.
[0m05:57:00.572256 [error] [MainThread]: Encountered an error:
Runtime Error
  Invalid Input Error: Initialization function "motherduck_init" from file "/Users/raajassode/.duckdb/extensions/v0.10.0/osx_arm64/motherduck.duckdb_extension" threw an exception: "
  It looks like you're using an unsupported version of DuckDB (0.10.0). MotherDuck currently only supports DuckDB 0.9.2. Please downgrade DuckDB to 0.9.2 to use MotherDuck.
   
  For more information go to https://motherduck.com/docs/getting-started/connect-query-from-duckdb-cli"
[0m05:57:00.573608 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 3.2790306, "process_user_time": 1.674035, "process_kernel_time": 0.168123, "process_mem_max_rss": "143736832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:57:00.573938 [debug] [MainThread]: Command `dbt compile` failed at 05:57:00.573872 after 3.28 seconds
[0m05:57:00.574141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105593b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f6c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ec4f90>]}
[0m05:57:00.574346 [debug] [MainThread]: Flushing usage events
[0m05:58:26.505344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1fd90>]}


============================== 05:58:26.507548 | f65dfad2-4d3b-4402-8acf-6b5f5d260055 ==============================
[0m05:58:26.507548 [info ] [MainThread]: Running with dbt=1.7.8
[0m05:58:26.507868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:58:27.225535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecd990>]}
[0m05:58:27.287421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e157d0>]}
[0m05:58:27.287842 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m05:58:27.297089 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m05:58:27.311862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:58:27.312184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:58:27.313015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m05:58:27.317149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cb590>]}
[0m05:58:27.324815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7cb90>]}
[0m05:58:27.325263 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m05:58:27.325518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0d550>]}
[0m05:58:27.326976 [info ] [MainThread]: 
[0m05:58:27.327509 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:58:27.328424 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_climate_works_dev_sode'
[0m05:58:27.334077 [debug] [ThreadPool]: Using duckdb connection "list_climate_works_dev_sode"
[0m05:58:27.334375 [debug] [ThreadPool]: On list_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works_dev_sode"} */
select
      'climate_works' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'climate_works'
  
[0m05:58:27.334566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:58:32.144094 [debug] [ThreadPool]: SQL status: OK in 5.0 seconds
[0m05:58:32.149856 [debug] [ThreadPool]: On list_climate_works_dev_sode: Close
[0m05:58:32.150682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f65dfad2-4d3b-4402-8acf-6b5f5d260055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df6e50>]}
[0m05:58:32.151054 [info ] [MainThread]: Concurrency: 1 threads (target='cw_md_dev')
[0m05:58:32.151221 [info ] [MainThread]: 
[0m05:58:32.153997 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m05:58:32.154419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_climate_works_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m05:58:32.154613 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m05:58:32.158311 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m05:58:32.158578 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 05:58:32.154727 => 05:58:32.158469
[0m05:58:32.158752 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_climate__stations
[0m05:58:32.158949 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (execute): 05:58:32.158849 => 05:58:32.158860
[0m05:58:32.159359 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m05:58:32.159550 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:58:32.160077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m05:58:32.160336 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:58:32.162566 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m05:58:32.163475 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 05:58:32.160452 => 05:58:32.163309
[0m05:58:32.163685 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:58:32.163882 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 05:58:32.163787 => 05:58:32.163793
[0m05:58:32.164326 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:58:32.164530 [debug] [Thread-1 (]: Began running node seed.climate_works_dbt.2022
[0m05:58:32.165000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now seed.climate_works_dbt.2022)
[0m05:58:32.165255 [debug] [Thread-1 (]: Began compiling node seed.climate_works_dbt.2022
[0m05:58:32.166294 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2022 (compile): 05:58:32.165393 => 05:58:32.166188
[0m05:58:32.166459 [debug] [Thread-1 (]: Began executing node seed.climate_works_dbt.2022
[0m05:58:32.166640 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2022 (execute): 05:58:32.166553 => 05:58:32.166557
[0m05:58:32.167034 [debug] [Thread-1 (]: Finished running node seed.climate_works_dbt.2022
[0m05:58:32.167217 [debug] [Thread-1 (]: Began running node seed.climate_works_dbt.2023
[0m05:58:32.167779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.climate_works_dbt.2022, now seed.climate_works_dbt.2023)
[0m05:58:32.168072 [debug] [Thread-1 (]: Began compiling node seed.climate_works_dbt.2023
[0m05:58:32.169046 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2023 (compile): 05:58:32.168193 => 05:58:32.168900
[0m05:58:32.169267 [debug] [Thread-1 (]: Began executing node seed.climate_works_dbt.2023
[0m05:58:32.169478 [debug] [Thread-1 (]: Timing info for seed.climate_works_dbt.2023 (execute): 05:58:32.169377 => 05:58:32.169381
[0m05:58:32.169900 [debug] [Thread-1 (]: Finished running node seed.climate_works_dbt.2023
[0m05:58:32.170091 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m05:58:32.170375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.climate_works_dbt.2023, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m05:58:32.170534 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m05:58:32.171942 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m05:58:32.172521 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 05:58:32.170630 => 05:58:32.172351
[0m05:58:32.172767 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m05:58:32.172986 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 05:58:32.172887 => 05:58:32.172891
[0m05:58:32.173438 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m05:58:32.173819 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m05:58:32.174198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m05:58:32.174400 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m05:58:32.176089 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m05:58:32.176647 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 05:58:32.174520 => 05:58:32.176546
[0m05:58:32.176817 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m05:58:32.177006 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 05:58:32.176916 => 05:58:32.176919
[0m05:58:32.177389 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m05:58:32.177703 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m05:58:32.178136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m05:58:32.178366 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m05:58:32.179919 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m05:58:32.180441 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 05:58:32.178484 => 05:58:32.180338
[0m05:58:32.180629 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m05:58:32.180817 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 05:58:32.180728 => 05:58:32.180732
[0m05:58:32.181200 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m05:58:32.181674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:58:32.181830 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m05:58:32.182372 [debug] [MainThread]: Command end result
[0m05:58:32.187569 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.7159705, "process_user_time": 1.498535, "process_kernel_time": 0.258661, "process_mem_max_rss": "290586624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:58:32.187889 [debug] [MainThread]: Command `dbt compile` succeeded at 05:58:32.187832 after 5.72 seconds
[0m05:58:32.188093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b6e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103151150>]}
[0m05:58:32.188286 [debug] [MainThread]: Flushing usage events
[0m05:59:37.353833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a34f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7f6d0>]}


============================== 05:59:37.358155 | 12e23610-b5d0-4199-8e6f-bfc06b42b14a ==============================
[0m05:59:37.358155 [info ] [MainThread]: Running with dbt=1.7.8
[0m05:59:37.358958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:59:37.513593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7c750>]}
[0m05:59:37.574967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7cc10>]}
[0m05:59:37.575439 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m05:59:37.584842 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m05:59:37.599721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:59:37.599993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:59:37.600436 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m05:59:37.603593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0790>]}
[0m05:59:37.608678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f738d0>]}
[0m05:59:37.609004 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m05:59:37.609196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7ec10>]}
[0m05:59:37.610015 [info ] [MainThread]: 
[0m05:59:37.610423 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m05:59:37.611134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_climate_works'
[0m05:59:37.616906 [debug] [ThreadPool]: Using duckdb connection "list_climate_works"
[0m05:59:37.617142 [debug] [ThreadPool]: On list_climate_works: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"climate_works"'
    
  
  
[0m05:59:37.617299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:59:39.507889 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m05:59:39.508963 [debug] [ThreadPool]: On list_climate_works: Close
[0m05:59:39.509687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_works, now create_climate_works_dev_sode)
[0m05:59:39.510086 [debug] [ThreadPool]: Creating schema "database: "climate_works"
schema: "dev_sode"
"
[0m05:59:39.512950 [debug] [ThreadPool]: Using duckdb connection "create_climate_works_dev_sode"
[0m05:59:39.513142 [debug] [ThreadPool]: On create_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "create_climate_works_dev_sode"} */
create schema if not exists "climate_works"."dev_sode"
[0m05:59:39.513291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:39.938614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:59:39.941801 [debug] [ThreadPool]: On create_climate_works_dev_sode: Close
[0m05:59:39.943401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_climate_works_dev_sode, now list_climate_works_dev_sode)
[0m05:59:39.946630 [debug] [ThreadPool]: Using duckdb connection "list_climate_works_dev_sode"
[0m05:59:39.946827 [debug] [ThreadPool]: On list_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works_dev_sode"} */
select
      'climate_works' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'climate_works'
  
[0m05:59:39.946994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:59:39.969018 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m05:59:39.973203 [debug] [ThreadPool]: On list_climate_works_dev_sode: Close
[0m05:59:39.973766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee2a10>]}
[0m05:59:39.974021 [debug] [MainThread]: Using duckdb connection "master"
[0m05:59:39.974168 [debug] [MainThread]: On master: BEGIN
[0m05:59:39.974301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:59:39.974520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:59:39.974654 [debug] [MainThread]: On master: COMMIT
[0m05:59:39.974784 [debug] [MainThread]: Using duckdb connection "master"
[0m05:59:39.974910 [debug] [MainThread]: On master: COMMIT
[0m05:59:39.975059 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:59:39.975187 [debug] [MainThread]: On master: Close
[0m05:59:39.975492 [info ] [MainThread]: Concurrency: 1 threads (target='cw_md_dev')
[0m05:59:39.975654 [info ] [MainThread]: 
[0m05:59:39.977111 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:59:39.977368 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m05:59:39.977799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_climate_works_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m05:59:39.977986 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:59:39.981720 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m05:59:39.982163 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 05:59:39.978093 => 05:59:39.982055
[0m05:59:39.982342 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:59:39.998542 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m05:59:39.999068 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m05:59:39.999290 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m05:59:39.999491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:59:40.000361 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 05:59:39.982456 => 05:59:40.000250
[0m05:59:40.000538 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m05:59:40.005070 [debug] [Thread-1 (]: Runtime Error in model stg_daily_climate_parameters_vertical_raw (models/staging/stg_daily_climate_parameters_vertical_raw.sql)
  Binder Error: Catalog "dev_database" does not exist!
[0m05:59:40.005404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e23610-b5d0-4199-8e6f-bfc06b42b14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078338d0>]}
[0m05:59:40.005742 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[31mERROR[0m in 0.03s]
[0m05:59:40.006097 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m05:59:40.007003 [debug] [MainThread]: Using duckdb connection "master"
[0m05:59:40.007203 [debug] [MainThread]: On master: BEGIN
[0m05:59:40.007340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:59:40.007609 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:59:40.007747 [debug] [MainThread]: On master: COMMIT
[0m05:59:40.007876 [debug] [MainThread]: Using duckdb connection "master"
[0m05:59:40.007999 [debug] [MainThread]: On master: COMMIT
[0m05:59:40.008151 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m05:59:40.008279 [debug] [MainThread]: On master: Close
[0m05:59:40.008554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:59:40.008678 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m05:59:40.008820 [info ] [MainThread]: 
[0m05:59:40.008979 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m05:59:40.009270 [debug] [MainThread]: Command end result
[0m05:59:40.013018 [info ] [MainThread]: 
[0m05:59:40.013221 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:59:40.013365 [info ] [MainThread]: 
[0m05:59:40.013511 [error] [MainThread]:   Runtime Error in model stg_daily_climate_parameters_vertical_raw (models/staging/stg_daily_climate_parameters_vertical_raw.sql)
  Binder Error: Catalog "dev_database" does not exist!
[0m05:59:40.013653 [info ] [MainThread]: 
[0m05:59:40.013811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:59:40.014717 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.6987743, "process_user_time": 1.39713, "process_kernel_time": 0.152838, "process_mem_max_rss": "153010176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:59:40.015027 [debug] [MainThread]: Command `dbt run` failed at 05:59:40.014970 after 2.70 seconds
[0m05:59:40.015225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa0f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a83990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100750cd0>]}
[0m05:59:40.015398 [debug] [MainThread]: Flushing usage events
[0m06:08:58.004597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088682d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e0e10>]}


============================== 06:08:58.007562 | cb261a07-b2a0-41b3-aa2d-1831661c8a95 ==============================
[0m06:08:58.007562 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:08:58.007961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:08:58.221432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10882dc10>]}
[0m06:08:58.282530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088aa5d0>]}
[0m06:08:58.283809 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m06:08:58.293862 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m06:08:58.317546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:08:58.317816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:08:58.318255 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m06:08:58.321108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1db150>]}
[0m06:08:58.326542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10ea10>]}
[0m06:08:58.326840 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m06:08:58.327082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d6fc90>]}
[0m06:08:58.327935 [info ] [MainThread]: 
[0m06:08:58.328354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:08:58.328917 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_climate_works'
[0m06:08:58.334539 [debug] [ThreadPool]: Using duckdb connection "list_climate_works"
[0m06:08:58.334764 [debug] [ThreadPool]: On list_climate_works: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"climate_works"'
    
  
  
[0m06:08:58.334928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:09:00.778198 [debug] [ThreadPool]: SQL status: OK in 2.0 seconds
[0m06:09:00.779878 [debug] [ThreadPool]: On list_climate_works: Close
[0m06:09:00.780491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_works, now create_climate_works_dev_sode)
[0m06:09:00.780825 [debug] [ThreadPool]: Creating schema "database: "climate_works"
schema: "dev_sode"
"
[0m06:09:00.783545 [debug] [ThreadPool]: Using duckdb connection "create_climate_works_dev_sode"
[0m06:09:00.783750 [debug] [ThreadPool]: On create_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "create_climate_works_dev_sode"} */
create schema if not exists "climate_works"."dev_sode"
[0m06:09:00.783906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:09:01.201261 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:09:01.203195 [debug] [ThreadPool]: On create_climate_works_dev_sode: Close
[0m06:09:01.206275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_climate_works_dev_sode, now list_climate_works_dev_sode)
[0m06:09:01.213674 [debug] [ThreadPool]: Using duckdb connection "list_climate_works_dev_sode"
[0m06:09:01.213985 [debug] [ThreadPool]: On list_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works_dev_sode"} */
select
      'climate_works' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'climate_works'
  
[0m06:09:01.214154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:09:01.235816 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m06:09:01.240174 [debug] [ThreadPool]: On list_climate_works_dev_sode: Close
[0m06:09:01.240784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a048d10>]}
[0m06:09:01.241076 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:01.241231 [debug] [MainThread]: On master: BEGIN
[0m06:09:01.241370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:09:01.241606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:01.241754 [debug] [MainThread]: On master: COMMIT
[0m06:09:01.241894 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:01.242021 [debug] [MainThread]: On master: COMMIT
[0m06:09:01.242182 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:01.242321 [debug] [MainThread]: On master: Close
[0m06:09:01.242659 [info ] [MainThread]: Concurrency: 1 threads (target='cw_md_dev')
[0m06:09:01.242895 [info ] [MainThread]: 
[0m06:09:01.244420 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m06:09:01.244714 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m06:09:01.245062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_climate_works_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m06:09:01.245244 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m06:09:01.249159 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m06:09:01.249955 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 06:09:01.245351 => 06:09:01.249790
[0m06:09:01.250181 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m06:09:01.266268 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m06:09:01.266795 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m06:09:01.267042 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m06:09:01.267249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:09:26.730504 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m06:09:26.735399 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m06:09:26.735659 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m06:09:27.538352 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m06:09:27.551663 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m06:09:27.551922 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m06:09:28.175021 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m06:09:28.178093 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 06:09:01.250288 => 06:09:28.177883
[0m06:09:28.178370 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m06:09:28.178868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb261a07-b2a0-41b3-aa2d-1831661c8a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a114990>]}
[0m06:09:28.179239 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 26.93s]
[0m06:09:28.179539 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m06:09:28.180635 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:28.180888 [debug] [MainThread]: On master: BEGIN
[0m06:09:28.181038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:09:28.181317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:28.181462 [debug] [MainThread]: On master: COMMIT
[0m06:09:28.181592 [debug] [MainThread]: Using duckdb connection "master"
[0m06:09:28.181717 [debug] [MainThread]: On master: COMMIT
[0m06:09:28.181871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m06:09:28.182001 [debug] [MainThread]: On master: Close
[0m06:09:28.182303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:09:28.182432 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m06:09:28.182585 [info ] [MainThread]: 
[0m06:09:28.182744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 29.85 seconds (29.85s).
[0m06:09:28.183028 [debug] [MainThread]: Command end result
[0m06:09:28.186906 [info ] [MainThread]: 
[0m06:09:28.187128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:09:28.187284 [info ] [MainThread]: 
[0m06:09:28.187454 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:09:28.188723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.220856, "process_user_time": 1.457935, "process_kernel_time": 0.263362, "process_mem_max_rss": "152944640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:09:28.189137 [debug] [MainThread]: Command `dbt run` succeeded at 06:09:28.189037 after 30.22 seconds
[0m06:09:28.189584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10305d310>]}
[0m06:09:28.189808 [debug] [MainThread]: Flushing usage events
[0m09:44:06.614475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11044b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110433110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11047f6d0>]}


============================== 09:44:06.617484 | 2c8260c1-03a4-4063-8e97-6678bcbc8038 ==============================
[0m09:44:06.617484 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:44:06.617950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw+', 'send_anonymous_usage_stats': 'True'}
[0m09:44:06.813761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11046fe50>]}
[0m09:44:06.874881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ce050>]}
[0m09:44:06.875768 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m09:44:06.885440 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:44:06.907536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:44:06.907815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:44:06.908272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m09:44:06.911242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104dfd10>]}
[0m09:44:06.916750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c9250>]}
[0m09:44:06.917016 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m09:44:06.917202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076c450>]}
[0m09:44:06.918068 [info ] [MainThread]: 
[0m09:44:06.918499 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:44:06.919140 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m09:44:06.925156 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m09:44:06.925438 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m09:44:06.925615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:44:06.935240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.936884 [debug] [ThreadPool]: On list_dev_database: Close
[0m09:44:06.938751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m09:44:06.939172 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m09:44:06.941772 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:44:06.941978 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m09:44:06.942123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:06.945087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.945266 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:44:06.945409 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m09:44:06.945671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.946128 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:44:06.946272 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:44:06.946401 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:44:06.946567 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.946699 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m09:44:06.948498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m09:44:06.951867 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:44:06.952078 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m09:44:06.952212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:44:06.955061 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.955223 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:44:06.955370 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m09:44:06.967671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:44:06.970910 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m09:44:06.971761 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m09:44:06.971943 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m09:44:06.973754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c9090>]}
[0m09:44:06.974051 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:06.974203 [debug] [MainThread]: On master: BEGIN
[0m09:44:06.974333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:44:06.976823 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:06.976986 [debug] [MainThread]: On master: COMMIT
[0m09:44:06.977115 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:06.977236 [debug] [MainThread]: On master: COMMIT
[0m09:44:06.977381 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:06.977508 [debug] [MainThread]: On master: Close
[0m09:44:06.978619 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m09:44:06.978885 [info ] [MainThread]: 
[0m09:44:06.980314 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:44:06.980561 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m09:44:06.980932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m09:44:06.981128 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:44:06.985126 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:06.985913 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 09:44:06.981235 => 09:44:06.985757
[0m09:44:06.986124 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:44:07.002177 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:07.002711 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:07.002891 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m09:44:07.003055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:07.005831 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:07.006021 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:07.006218 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m09:44:13.092854 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m09:44:13.097629 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:13.097857 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m09:44:13.098682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:13.107319 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:44:13.107543 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:13.107716 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:44:19.967639 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:44:19.970837 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:44:19.971078 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m09:44:19.971630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:19.972634 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 09:44:06.986225 => 09:44:19.972496
[0m09:44:19.972859 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m09:44:20.199898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110874e90>]}
[0m09:44:20.200386 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 13.22s]
[0m09:44:20.200686 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:44:20.201351 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:44:20.201696 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m09:44:20.202124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m09:44:20.202309 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:44:20.203923 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.205560 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 09:44:20.202416 => 09:44:20.205424
[0m09:44:20.205764 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:44:20.216458 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.217197 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.217464 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m09:44:20.217642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:20.220767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.220976 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.221171 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m09:44:20.221684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.223404 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.223596 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m09:44:20.223852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.224625 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:44:20.224786 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.224938 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:44:20.225899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.227128 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:44:20.227306 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m09:44:20.227535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.228151 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 09:44:20.205970 => 09:44:20.228054
[0m09:44:20.228320 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m09:44:20.288877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aca5d0>]}
[0m09:44:20.289283 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m09:44:20.289562 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:44:20.290024 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:44:20.290354 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m09:44:20.290747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m09:44:20.290931 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:44:20.293549 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.294470 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 09:44:20.291033 => 09:44:20.294356
[0m09:44:20.294652 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:44:20.296682 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.297103 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.297275 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m09:44:20.297427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:20.300485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.300718 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.300916 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m09:44:20.303005 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.304730 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.304954 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m09:44:20.305260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.306182 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:44:20.306405 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.306579 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:44:20.306972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.308332 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:44:20.308518 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m09:44:20.308755 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.309399 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 09:44:20.294757 => 09:44:20.309299
[0m09:44:20.309572 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m09:44:20.367801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1fdd0>]}
[0m09:44:20.368212 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m09:44:20.368490 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:44:20.369001 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:44:20.369425 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m09:44:20.369827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m09:44:20.370009 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:44:20.371701 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.372865 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 09:44:20.370174 => 09:44:20.372723
[0m09:44:20.373083 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:44:20.374972 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.375312 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.375492 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m09:44:20.375650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:20.380326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.380582 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.380783 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m09:44:20.840376 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.842145 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.842340 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m09:44:20.842637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.843465 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:44:20.843629 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.843780 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:44:20.844687 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.845931 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:44:20.846114 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m09:44:20.846342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:44:20.846983 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 09:44:20.373189 => 09:44:20.846876
[0m09:44:20.847161 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m09:44:20.942326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c8260c1-03a4-4063-8e97-6678bcbc8038', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1e210>]}
[0m09:44:20.942743 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.57s]
[0m09:44:20.943069 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:44:20.943937 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:20.944094 [debug] [MainThread]: On master: BEGIN
[0m09:44:20.944230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:44:20.948167 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:20.948375 [debug] [MainThread]: On master: COMMIT
[0m09:44:20.948521 [debug] [MainThread]: Using duckdb connection "master"
[0m09:44:20.948655 [debug] [MainThread]: On master: COMMIT
[0m09:44:20.948814 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:44:20.948948 [debug] [MainThread]: On master: Close
[0m09:44:20.950252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:44:20.950442 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m09:44:20.950696 [info ] [MainThread]: 
[0m09:44:20.950873 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.03 seconds (14.03s).
[0m09:44:20.951539 [debug] [MainThread]: Command end result
[0m09:44:20.959950 [info ] [MainThread]: 
[0m09:44:20.960222 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:44:20.960427 [info ] [MainThread]: 
[0m09:44:20.960606 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:44:20.962410 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.384536, "process_user_time": 46.64957, "process_kernel_time": 3.13874, "process_mem_max_rss": "3425124352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:44:20.962845 [debug] [MainThread]: Command `dbt run` succeeded at 09:44:20.962772 after 14.39 seconds
[0m09:44:20.963081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110901990>]}
[0m09:44:20.963274 [debug] [MainThread]: Flushing usage events
[0m09:53:07.651610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a4b10>]}


============================== 09:53:07.654330 | 0042dfaf-e57f-40b6-ba74-25a87b6a589a ==============================
[0m09:53:07.654330 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:53:07.654715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:07.823703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627fc10>]}
[0m09:53:07.885513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f40d0>]}
[0m09:53:07.886352 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m09:53:07.896041 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:53:07.918887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:07.919159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:07.919617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m09:53:07.922646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626a590>]}
[0m09:53:07.928127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f7250>]}
[0m09:53:07.928396 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m09:53:07.928600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106501c50>]}
[0m09:53:07.929799 [info ] [MainThread]: 
[0m09:53:07.930245 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:53:07.930937 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m09:53:07.936503 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m09:53:07.936745 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m09:53:07.936909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:53:07.941266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.942203 [debug] [ThreadPool]: On list_dev_database: Close
[0m09:53:07.943777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m09:53:07.944189 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m09:53:07.946689 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:53:07.946904 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m09:53:07.947058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.950294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.950481 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:53:07.950629 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m09:53:07.950821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.951259 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:53:07.951405 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:53:07.951535 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:53:07.951701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.951835 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m09:53:07.953783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m09:53:07.957325 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:53:07.957522 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m09:53:07.957656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:53:07.960428 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.960596 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:53:07.960753 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m09:53:07.971716 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:53:07.974862 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m09:53:07.975662 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m09:53:07.975822 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m09:53:07.977837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105247f50>]}
[0m09:53:07.978077 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.978218 [debug] [MainThread]: On master: BEGIN
[0m09:53:07.978344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:53:07.981720 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:53:07.981936 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.982085 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:07.982223 [debug] [MainThread]: On master: COMMIT
[0m09:53:07.982392 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:53:07.982528 [debug] [MainThread]: On master: Close
[0m09:53:07.983679 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m09:53:07.983875 [info ] [MainThread]: 
[0m09:53:07.985337 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m09:53:07.985571 [info ] [Thread-1 (]: 1 of 5 START sql ephermeral model dev_sode.int_climate__stations ............... [RUN]
[0m09:53:07.985905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m09:53:07.986075 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m09:53:07.989563 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m09:53:07.989860 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 09:53:07.986180 => 09:53:07.989752
[0m09:53:07.990048 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_climate__stations
[0m09:53:07.991059 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (execute): 09:53:07.990149 => 09:53:07.990934
[0m09:53:07.992441 [debug] [Thread-1 (]: Compilation Error in model int_climate__stations (models/Intermediate/int_climate__stations.sql)
  No materialization 'ephermeral' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m09:53:07.992706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106750ad0>]}
[0m09:53:07.993095 [error] [Thread-1 (]: 1 of 5 ERROR creating sql ephermeral model dev_sode.int_climate__stations ...... [[31mERROR[0m in 0.01s]
[0m09:53:07.993462 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m09:53:07.993677 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:53:07.994033 [info ] [Thread-1 (]: 2 of 5 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m09:53:07.994386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m09:53:07.994562 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:53:07.996242 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:07.997054 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 09:53:07.994661 => 09:53:07.996915
[0m09:53:07.997264 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:53:08.012951 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:08.013447 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:08.013623 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m09:53:08.013780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:08.016787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:08.016984 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:08.017180 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m09:53:14.838157 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:53:14.843518 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:14.843805 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m09:53:14.844167 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:14.845681 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:14.845880 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m09:53:14.846147 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:14.856211 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:53:14.856461 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:14.856630 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:53:21.891135 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:53:21.894110 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:53:21.894364 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m09:53:21.901710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:21.902806 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 09:53:07.997365 => 09:53:21.902664
[0m09:53:21.903105 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m09:53:22.192324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f00d0>]}
[0m09:53:22.192779 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 14.20s]
[0m09:53:22.193087 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:53:22.194458 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:53:22.195299 [info ] [Thread-1 (]: 3 of 5 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m09:53:22.196615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m09:53:22.197409 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:53:22.199220 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.201515 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 09:53:22.197647 => 09:53:22.201079
[0m09:53:22.202143 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:53:22.214389 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.215420 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.215808 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m09:53:22.216037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:22.219343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.219551 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.219750 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m09:53:22.220262 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.221929 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.222121 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m09:53:22.222377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.224001 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.224195 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m09:53:22.224443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.225275 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:53:22.225448 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.225599 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:53:22.226095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.227228 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:53:22.227413 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m09:53:22.227712 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.228325 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 09:53:22.202554 => 09:53:22.228227
[0m09:53:22.228496 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m09:53:22.290871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f0750>]}
[0m09:53:22.291278 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m09:53:22.291557 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:53:22.292231 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:53:22.292437 [info ] [Thread-1 (]: 4 of 5 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m09:53:22.292750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m09:53:22.292919 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:53:22.294966 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.296487 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 09:53:22.293037 => 09:53:22.295967
[0m09:53:22.297110 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:53:22.299098 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.299440 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.299613 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m09:53:22.299770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:22.303235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.303473 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.303671 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m09:53:22.304626 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.306219 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.306569 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m09:53:22.306892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.308346 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.308566 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m09:53:22.308808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.309645 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:53:22.309819 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.309986 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:53:22.310352 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.311528 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:53:22.311705 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m09:53:22.312085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.312739 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 09:53:22.297237 => 09:53:22.312636
[0m09:53:22.312922 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m09:53:22.376879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672bcd0>]}
[0m09:53:22.377293 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m09:53:22.377582 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:53:22.378419 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:53:22.378627 [info ] [Thread-1 (]: 5 of 5 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m09:53:22.378951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m09:53:22.379120 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:53:22.380719 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.381561 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 09:53:22.379218 => 09:53:22.381377
[0m09:53:22.381901 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:53:22.383771 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.384120 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.384280 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m09:53:22.384430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:53:22.387995 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.388194 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.388370 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m09:53:22.909661 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m09:53:22.911377 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.911575 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m09:53:22.911877 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.913126 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.914284 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m09:53:22.914522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.915440 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:53:22.915602 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.915755 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:53:22.916946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.949560 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:53:22.949851 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m09:53:22.950375 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:53:22.951097 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 09:53:22.382015 => 09:53:22.950996
[0m09:53:22.951275 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m09:53:23.052003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0042dfaf-e57f-40b6-ba74-25a87b6a589a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064679d0>]}
[0m09:53:23.052460 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.67s]
[0m09:53:23.052864 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:53:23.053823 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:23.054042 [debug] [MainThread]: On master: BEGIN
[0m09:53:23.054195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:53:23.058320 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:53:23.058530 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.058679 [debug] [MainThread]: Using duckdb connection "master"
[0m09:53:23.058819 [debug] [MainThread]: On master: COMMIT
[0m09:53:23.058982 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:53:23.059114 [debug] [MainThread]: On master: Close
[0m09:53:23.061174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:53:23.061386 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m09:53:23.061580 [info ] [MainThread]: 
[0m09:53:23.061746 [info ] [MainThread]: Finished running 1 ephermeral model, 2 table models, 2 view models in 0 hours 0 minutes and 15.13 seconds (15.13s).
[0m09:53:23.062235 [debug] [MainThread]: Command end result
[0m09:53:23.066875 [info ] [MainThread]: 
[0m09:53:23.067249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:53:23.067420 [info ] [MainThread]: 
[0m09:53:23.067567 [error] [MainThread]:   Compilation Error in model int_climate__stations (models/Intermediate/int_climate__stations.sql)
  No materialization 'ephermeral' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m09:53:23.067720 [info ] [MainThread]: 
[0m09:53:23.067870 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:53:23.068941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.456485, "process_user_time": 46.213955, "process_kernel_time": 3.434904, "process_mem_max_rss": "3764682752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:53:23.069273 [debug] [MainThread]: Command `dbt run` failed at 09:53:23.069206 after 15.46 seconds
[0m09:53:23.069483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106269350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106269c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100818850>]}
[0m09:53:23.069674 [debug] [MainThread]: Flushing usage events
[0m09:59:20.542766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107733750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a0d10>]}


============================== 09:59:20.545524 | d97d4937-b34c-40e6-b2be-4cf81452590e ==============================
[0m09:59:20.545524 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:59:20.545886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:20.701631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ed950>]}
[0m09:59:20.761635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a3b90>]}
[0m09:59:20.763065 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m09:59:20.772309 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:59:20.785607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:20.785887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:20.786359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m09:59:20.789374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdba10>]}
[0m09:59:20.794351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb5750>]}
[0m09:59:20.794652 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m09:59:20.794836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c4a90>]}
[0m09:59:20.795853 [info ] [MainThread]: 
[0m09:59:20.796256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:59:20.796977 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m09:59:20.802976 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m09:59:20.803200 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m09:59:20.803385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:20.808087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.809039 [debug] [ThreadPool]: On list_dev_database: Close
[0m09:59:20.810864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m09:59:20.811401 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m09:59:20.813883 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:20.814080 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m09:59:20.814215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:20.817467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.817658 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:20.817809 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m09:59:20.818019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.818515 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:59:20.818672 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:20.818806 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:59:20.818976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.819111 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m09:59:20.821435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m09:59:20.824696 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:59:20.824882 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m09:59:20.825023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:20.828529 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.828717 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:59:20.828862 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m09:59:20.839563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:20.842684 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m09:59:20.843528 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m09:59:20.843686 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m09:59:20.845905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be0d90>]}
[0m09:59:20.846181 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:20.846317 [debug] [MainThread]: On master: BEGIN
[0m09:59:20.846443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:20.849306 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:20.849473 [debug] [MainThread]: On master: COMMIT
[0m09:59:20.849603 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:20.849725 [debug] [MainThread]: On master: COMMIT
[0m09:59:20.849872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:20.849999 [debug] [MainThread]: On master: Close
[0m09:59:20.851334 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m09:59:20.851551 [info ] [MainThread]: 
[0m09:59:20.853167 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m09:59:20.853416 [info ] [Thread-1 (]: 1 of 5 START sql ephermeral model dev_sode.int_climate__stations ............... [RUN]
[0m09:59:20.853813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m09:59:20.854039 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m09:59:20.857888 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m09:59:20.858345 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 09:59:20.854182 => 09:59:20.858233
[0m09:59:20.858528 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_climate__stations
[0m09:59:20.859441 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (execute): 09:59:20.858626 => 09:59:20.859345
[0m09:59:20.860510 [debug] [Thread-1 (]: Compilation Error in model int_climate__stations (models/Intermediate/int_climate__stations.sql)
  No materialization 'ephermeral' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m09:59:20.860725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fd90>]}
[0m09:59:20.861015 [error] [Thread-1 (]: 1 of 5 ERROR creating sql ephermeral model dev_sode.int_climate__stations ...... [[31mERROR[0m in 0.01s]
[0m09:59:20.861285 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m09:59:20.861485 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:20.861883 [info ] [Thread-1 (]: 2 of 5 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m09:59:20.862325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m09:59:20.862527 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:20.864221 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:20.864587 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 09:59:20.862627 => 09:59:20.864487
[0m09:59:20.864754 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:20.880519 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:20.881011 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:20.881187 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m09:59:20.881348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:20.884643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:20.884866 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:20.885077 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m09:59:27.815676 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:59:27.824510 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:27.824759 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m09:59:27.825149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:27.826630 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:27.826818 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m09:59:27.827072 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:27.836264 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:59:27.836463 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:27.836622 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:59:34.932371 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:59:34.935714 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:34.935933 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m09:59:34.944182 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:34.945306 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 09:59:20.864849 => 09:59:34.945090
[0m09:59:34.945564 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m09:59:35.224884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbc790>]}
[0m09:59:35.225479 [info ] [Thread-1 (]: 2 of 5 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 14.36s]
[0m09:59:35.225819 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:35.226782 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:35.227178 [info ] [Thread-1 (]: 3 of 5 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m09:59:35.227711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m09:59:35.227952 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:35.229539 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.230028 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 09:59:35.228073 => 09:59:35.229920
[0m09:59:35.230207 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:35.240178 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.240982 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.241437 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m09:59:35.241729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:35.245184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.245411 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.245612 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m09:59:35.246146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.247950 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.248139 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m09:59:35.248396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.249708 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.249878 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m09:59:35.250107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.250924 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:59:35.251098 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.251248 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:59:35.251692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.253185 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:35.253393 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m09:59:35.253765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.254551 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 09:59:35.230308 => 09:59:35.254437
[0m09:59:35.254746 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m09:59:35.315681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a0b10>]}
[0m09:59:35.316097 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m09:59:35.316439 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:35.316861 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:35.317121 [info ] [Thread-1 (]: 4 of 5 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m09:59:35.317444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m09:59:35.317620 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:35.319419 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.319886 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 09:59:35.317725 => 09:59:35.319771
[0m09:59:35.320070 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:35.322042 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.322359 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.322527 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m09:59:35.322684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:35.327453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.327742 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.327947 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m09:59:35.328990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.330659 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.330853 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m09:59:35.331104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.332428 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.332616 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m09:59:35.332842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.333652 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:59:35.333814 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.333965 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:59:35.334404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.335850 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:35.336085 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m09:59:35.336453 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.337208 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 09:59:35.320173 => 09:59:35.337097
[0m09:59:35.337416 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m09:59:35.396788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e02750>]}
[0m09:59:35.397217 [info ] [Thread-1 (]: 4 of 5 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m09:59:35.397489 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:35.398047 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:35.398392 [info ] [Thread-1 (]: 5 of 5 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m09:59:35.398825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m09:59:35.399015 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:35.400832 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.401879 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 09:59:35.399121 => 09:59:35.401747
[0m09:59:35.402064 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:35.404183 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.404609 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.404780 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m09:59:35.404936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:35.409930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.410170 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.410350 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m09:59:35.928716 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m09:59:35.930421 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.930617 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m09:59:35.930923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.932188 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.933399 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m09:59:35.933653 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.934558 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:59:35.934718 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.934867 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:59:35.935942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.972397 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:35.972690 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m09:59:35.973317 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:35.974276 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 09:59:35.402164 => 09:59:35.974167
[0m09:59:35.974476 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m09:59:36.093338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd97d4937-b34c-40e6-b2be-4cf81452590e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfa090>]}
[0m09:59:36.093862 [info ] [Thread-1 (]: 5 of 5 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.69s]
[0m09:59:36.094329 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:36.095431 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:36.095597 [debug] [MainThread]: On master: BEGIN
[0m09:59:36.095736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:36.099093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:36.099312 [debug] [MainThread]: On master: COMMIT
[0m09:59:36.099447 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:36.099572 [debug] [MainThread]: On master: COMMIT
[0m09:59:36.099724 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:36.099855 [debug] [MainThread]: On master: Close
[0m09:59:36.101278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:36.101449 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m09:59:36.101638 [info ] [MainThread]: 
[0m09:59:36.101923 [info ] [MainThread]: Finished running 1 ephermeral model, 2 table models, 2 view models in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m09:59:36.102433 [debug] [MainThread]: Command end result
[0m09:59:36.112473 [info ] [MainThread]: 
[0m09:59:36.112769 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:59:36.112916 [info ] [MainThread]: 
[0m09:59:36.113066 [error] [MainThread]:   Compilation Error in model int_climate__stations (models/Intermediate/int_climate__stations.sql)
  No materialization 'ephermeral' was found for adapter duckdb! (searched types 'default' and 'duckdb')
[0m09:59:36.113212 [info ] [MainThread]: 
[0m09:59:36.113365 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:59:36.114755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.608587, "process_user_time": 46.958855, "process_kernel_time": 3.777846, "process_mem_max_rss": "3204038656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:36.115076 [debug] [MainThread]: Command `dbt run` failed at 09:59:36.115009 after 15.61 seconds
[0m09:59:36.115281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ba0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791af90>]}
[0m09:59:36.115471 [debug] [MainThread]: Flushing usage events
[0m09:59:39.705158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120119910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d64b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12017f850>]}


============================== 09:59:39.707951 | 438e8053-0584-461a-ba7a-d71fd3042499 ==============================
[0m09:59:39.707951 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:59:39.708286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:39.861391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201e95d0>]}
[0m09:59:39.924054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201a4290>]}
[0m09:59:39.925491 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m09:59:39.934964 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:59:39.949015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:39.949304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:39.949772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m09:59:39.953168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207cf390>]}
[0m09:59:39.959973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206ca190>]}
[0m09:59:39.960367 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m09:59:39.960713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201ec5d0>]}
[0m09:59:39.961837 [info ] [MainThread]: 
[0m09:59:39.962296 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:59:39.962951 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m09:59:39.969368 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m09:59:39.969627 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m09:59:39.969787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:39.975360 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:39.976339 [debug] [ThreadPool]: On list_dev_database: Close
[0m09:59:39.978168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m09:59:39.978668 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m09:59:39.981532 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:39.981739 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m09:59:39.981871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:39.985341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:39.985528 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:39.985676 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m09:59:39.985872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:39.986337 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:59:39.986499 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m09:59:39.986636 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m09:59:39.986800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:39.986932 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m09:59:39.989332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m09:59:39.992725 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:59:39.992947 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m09:59:39.993080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:39.996377 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:39.996555 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m09:59:39.996706 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m09:59:40.007761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m09:59:40.010532 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m09:59:40.011478 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m09:59:40.011712 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m09:59:40.013880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204bd250>]}
[0m09:59:40.014150 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:40.014305 [debug] [MainThread]: On master: BEGIN
[0m09:59:40.014443 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:40.017999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:40.018186 [debug] [MainThread]: On master: COMMIT
[0m09:59:40.018325 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:40.018464 [debug] [MainThread]: On master: COMMIT
[0m09:59:40.018626 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:40.018763 [debug] [MainThread]: On master: Close
[0m09:59:40.020115 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m09:59:40.020347 [info ] [MainThread]: 
[0m09:59:40.022096 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m09:59:40.022468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m09:59:40.022651 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m09:59:40.026269 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m09:59:40.026693 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 09:59:40.022755 => 09:59:40.026582
[0m09:59:40.027108 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m09:59:40.027320 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:40.027653 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m09:59:40.028084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m09:59:40.028308 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:40.029858 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:40.030195 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 09:59:40.028403 => 09:59:40.030096
[0m09:59:40.030361 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:40.046266 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:40.046779 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:40.046958 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m09:59:40.047115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:40.050839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:40.051059 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:40.051267 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m09:59:46.600343 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:59:46.605021 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:46.605252 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m09:59:46.605574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:46.607068 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:46.607251 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m09:59:46.607491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:46.616441 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:59:46.616649 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:46.616814 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m09:59:53.639713 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m09:59:53.642492 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m09:59:53.642691 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m09:59:53.650229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.651045 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 09:59:40.030461 => 09:59:53.650938
[0m09:59:53.651254 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m09:59:53.939795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120669090>]}
[0m09:59:53.940213 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 13.91s]
[0m09:59:53.940485 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m09:59:53.941010 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:53.941368 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m09:59:53.941726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m09:59:53.941905 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:53.943468 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.943945 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 09:59:53.942011 => 09:59:53.943805
[0m09:59:53.944142 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:53.953666 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.954237 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.954438 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m09:59:53.954617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:53.958071 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.958277 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.958473 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m09:59:53.958978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.961711 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.961933 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m09:59:53.962212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.963667 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.963851 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m09:59:53.964096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.964920 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:59:53.965081 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.965231 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m09:59:53.965678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.967136 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m09:59:53.967326 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m09:59:53.967721 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:53.968504 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 09:59:53.944252 => 09:59:53.968392
[0m09:59:53.968697 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m09:59:54.030019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201cd150>]}
[0m09:59:54.030418 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m09:59:54.030689 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m09:59:54.031188 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:54.031560 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m09:59:54.031985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m09:59:54.032171 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:54.033786 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.034157 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 09:59:54.032273 => 09:59:54.034058
[0m09:59:54.034320 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:54.036218 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.036518 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.036679 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m09:59:54.036830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:54.040171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.040392 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.040594 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m09:59:54.041705 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.043406 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.043599 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m09:59:54.043856 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.045184 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.045364 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m09:59:54.045606 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.046438 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:59:54.046618 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.046770 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m09:59:54.047154 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.048356 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m09:59:54.048523 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m09:59:54.048905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.049714 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 09:59:54.034415 => 09:59:54.049609
[0m09:59:54.049908 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m09:59:54.110081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208fa450>]}
[0m09:59:54.110500 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m09:59:54.110776 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m09:59:54.111288 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:54.111495 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m09:59:54.111999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m09:59:54.112298 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:54.114018 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.114446 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 09:59:54.112412 => 09:59:54.114340
[0m09:59:54.114618 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:54.116469 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.116778 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.116936 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m09:59:54.117091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:54.120538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.120759 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.120945 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m09:59:54.542682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.544428 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.544626 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m09:59:54.544942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.546248 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.546579 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m09:59:54.546861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.547890 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:59:54.548069 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.548228 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m09:59:54.549327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.551650 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m09:59:54.551845 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m09:59:54.552272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m09:59:54.552916 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 09:59:54.114741 => 09:59:54.552815
[0m09:59:54.553096 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m09:59:54.645429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '438e8053-0584-461a-ba7a-d71fd3042499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201cd150>]}
[0m09:59:54.645856 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.53s]
[0m09:59:54.646249 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m09:59:54.647185 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:54.647348 [debug] [MainThread]: On master: BEGIN
[0m09:59:54.647485 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:54.651619 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:54.651867 [debug] [MainThread]: On master: COMMIT
[0m09:59:54.652015 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:54.652153 [debug] [MainThread]: On master: COMMIT
[0m09:59:54.652318 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m09:59:54.652460 [debug] [MainThread]: On master: Close
[0m09:59:54.654107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:54.654284 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m09:59:54.654466 [info ] [MainThread]: 
[0m09:59:54.654638 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.69 seconds (14.69s).
[0m09:59:54.655091 [debug] [MainThread]: Command end result
[0m09:59:54.692234 [info ] [MainThread]: 
[0m09:59:54.692495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:54.692646 [info ] [MainThread]: 
[0m09:59:54.692796 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:59:54.694021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.025142, "process_user_time": 48.174187, "process_kernel_time": 3.689683, "process_mem_max_rss": "3813588992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:59:54.694459 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:54.694357 after 15.03 seconds
[0m09:59:54.694714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102642190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10270c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10271a990>]}
[0m09:59:54.694904 [debug] [MainThread]: Flushing usage events
[0m10:26:43.403173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11893a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189bbd90>]}


============================== 10:26:43.406200 | c1756e8c-e4a3-4d3a-86eb-e5a0db0de124 ==============================
[0m10:26:43.406200 [info ] [MainThread]: Running with dbt=1.7.8
[0m10:26:43.406540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:43.588850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a17ed0>]}
[0m10:26:43.650627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118ca3a90>]}
[0m10:26:43.652065 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m10:26:43.662252 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m10:26:43.685816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:26:43.686105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:26:43.686624 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m10:26:43.689665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f96310>]}
[0m10:26:43.695522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a12dd0>]}
[0m10:26:43.695785 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m10:26:43.695961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f9d190>]}
[0m10:26:43.696931 [info ] [MainThread]: 
[0m10:26:43.697318 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:26:43.698031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m10:26:43.703740 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m10:26:43.703998 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m10:26:43.704166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:43.708948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.709876 [debug] [ThreadPool]: On list_dev_database: Close
[0m10:26:43.711668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m10:26:43.712096 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m10:26:43.714586 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:26:43.714758 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m10:26:43.714919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:43.718206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.718417 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:26:43.718565 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m10:26:43.718760 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.719207 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:26:43.719354 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m10:26:43.719485 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m10:26:43.719650 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.719813 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m10:26:43.721945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m10:26:43.725233 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:26:43.725429 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m10:26:43.725560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:43.728532 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.728699 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m10:26:43.728847 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m10:26:43.739506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:26:43.742175 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m10:26:43.743189 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m10:26:43.743420 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m10:26:43.745625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118980b50>]}
[0m10:26:43.745883 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:43.746025 [debug] [MainThread]: On master: BEGIN
[0m10:26:43.746154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:26:43.749574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:26:43.749753 [debug] [MainThread]: On master: COMMIT
[0m10:26:43.749897 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:43.750029 [debug] [MainThread]: On master: COMMIT
[0m10:26:43.750194 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:26:43.750328 [debug] [MainThread]: On master: Close
[0m10:26:43.751727 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m10:26:43.751983 [info ] [MainThread]: 
[0m10:26:43.753516 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m10:26:43.753863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m10:26:43.754031 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m10:26:43.757607 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m10:26:43.758457 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 10:26:43.754136 => 10:26:43.758336
[0m10:26:43.759051 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m10:26:43.759283 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m10:26:43.759599 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m10:26:43.759987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m10:26:43.760213 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m10:26:43.761978 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:43.762575 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 10:26:43.760337 => 10:26:43.762435
[0m10:26:43.762771 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m10:26:43.778072 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:43.778561 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:43.778738 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m10:26:43.778896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:43.782222 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:43.782454 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:43.782669 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m10:26:51.444185 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m10:26:51.452928 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:51.453178 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m10:26:51.453542 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:51.455046 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:51.455233 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m10:26:51.455474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:51.465339 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m10:26:51.465647 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:51.465843 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m10:26:58.424137 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m10:26:58.427695 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m10:26:58.427909 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m10:26:58.435981 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.437110 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 10:26:43.762870 => 10:26:58.436902
[0m10:26:58.437347 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m10:26:58.725710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f5dd90>]}
[0m10:26:58.726377 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 14.97s]
[0m10:26:58.726727 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m10:26:58.727469 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m10:26:58.727837 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m10:26:58.728505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m10:26:58.728797 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m10:26:58.730806 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.731463 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 10:26:58.728933 => 10:26:58.731331
[0m10:26:58.731651 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m10:26:58.740404 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.740812 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.740996 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m10:26:58.741181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:58.745315 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.745571 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.745787 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m10:26:58.746356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.749117 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.749301 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m10:26:58.749548 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.750831 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.750998 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m10:26:58.751219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.752384 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m10:26:58.752567 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.752716 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m10:26:58.753049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.754190 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m10:26:58.754353 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m10:26:58.754702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.755570 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 10:26:58.731751 => 10:26:58.755463
[0m10:26:58.755943 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m10:26:58.819051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192b2ed0>]}
[0m10:26:58.819436 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m10:26:58.819710 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m10:26:58.820189 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:26:58.820528 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m10:26:58.820930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m10:26:58.821119 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:26:58.822795 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.823400 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 10:26:58.821225 => 10:26:58.823288
[0m10:26:58.823586 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:26:58.825574 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.826083 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.826305 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m10:26:58.826571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:58.831571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.831843 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.832040 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m10:26:58.833004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.834795 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.834985 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m10:26:58.835230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.836565 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.836747 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m10:26:58.836969 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.837774 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m10:26:58.837938 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.838087 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m10:26:58.838441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.839562 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m10:26:58.839731 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m10:26:58.840089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.841024 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 10:26:58.823690 => 10:26:58.840912
[0m10:26:58.841276 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m10:26:58.899039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a28ad0>]}
[0m10:26:58.899426 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m10:26:58.899697 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m10:26:58.900190 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m10:26:58.900538 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m10:26:58.900994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m10:26:58.901186 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m10:26:58.902792 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:58.903654 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 10:26:58.901284 => 10:26:58.903493
[0m10:26:58.903863 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m10:26:58.906010 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:58.906363 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:58.906526 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m10:26:58.906677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:58.911437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:58.911680 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:58.911862 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m10:26:59.377210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:59.378966 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:59.379165 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m10:26:59.379485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:59.380839 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:59.381116 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m10:26:59.381382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:59.382392 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m10:26:59.382566 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:59.382722 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m10:26:59.383474 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:59.385671 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m10:26:59.385853 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m10:26:59.386185 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:26:59.386808 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 10:26:58.903978 => 10:26:59.386710
[0m10:26:59.386981 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m10:26:59.492732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1756e8c-e4a3-4d3a-86eb-e5a0db0de124', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11936d890>]}
[0m10:26:59.493166 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.59s]
[0m10:26:59.493572 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m10:26:59.494589 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:59.494756 [debug] [MainThread]: On master: BEGIN
[0m10:26:59.494887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:26:59.498233 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:26:59.498410 [debug] [MainThread]: On master: COMMIT
[0m10:26:59.498541 [debug] [MainThread]: Using duckdb connection "master"
[0m10:26:59.498664 [debug] [MainThread]: On master: COMMIT
[0m10:26:59.498812 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:26:59.498952 [debug] [MainThread]: On master: Close
[0m10:26:59.500981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:59.501175 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m10:26:59.501394 [info ] [MainThread]: 
[0m10:26:59.501570 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.80 seconds (15.80s).
[0m10:26:59.502029 [debug] [MainThread]: Command end result
[0m10:26:59.543360 [info ] [MainThread]: 
[0m10:26:59.543718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:59.543973 [info ] [MainThread]: 
[0m10:26:59.544225 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:26:59.545371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.181534, "process_user_time": 46.76155, "process_kernel_time": 3.728919, "process_mem_max_rss": "3434627072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:26:59.545647 [debug] [MainThread]: Command `dbt run` succeeded at 10:26:59.545585 after 16.18 seconds
[0m10:26:59.545838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10309e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031688d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103176990>]}
[0m10:26:59.546016 [debug] [MainThread]: Flushing usage events
[0m13:39:03.277139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11131bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a0c90>]}


============================== 13:39:03.279869 | 3d1159d7-aabb-463b-b28a-74d74e7d6325 ==============================
[0m13:39:03.279869 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:39:03.280307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:03.455035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136e050>]}
[0m13:39:03.516242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111361790>]}
[0m13:39:03.517549 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m13:39:03.527474 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:39:03.551266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:03.551545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:03.551989 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:39:03.554856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118eae90>]}
[0m13:39:03.561637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119030d0>]}
[0m13:39:03.561925 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:39:03.562107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2fd0>]}
[0m13:39:03.563010 [info ] [MainThread]: 
[0m13:39:03.563521 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:03.564463 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m13:39:03.571066 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m13:39:03.571346 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m13:39:03.571516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:03.575706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.577655 [debug] [ThreadPool]: On list_dev_database: Close
[0m13:39:03.579230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m13:39:03.579625 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m13:39:03.582137 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:39:03.582368 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m13:39:03.582504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:03.585435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.585631 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:39:03.585783 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m13:39:03.586687 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.587383 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:39:03.587593 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m13:39:03.587737 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m13:39:03.587945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.588087 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m13:39:03.589917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m13:39:03.593171 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:39:03.593343 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m13:39:03.593483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:03.596317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.596515 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m13:39:03.596664 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m13:39:03.608614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:39:03.611801 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m13:39:03.612338 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m13:39:03.612519 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m13:39:03.614335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117cd350>]}
[0m13:39:03.614609 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:03.614743 [debug] [MainThread]: On master: BEGIN
[0m13:39:03.614867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:03.617449 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:03.617609 [debug] [MainThread]: On master: COMMIT
[0m13:39:03.617739 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:03.617860 [debug] [MainThread]: On master: COMMIT
[0m13:39:03.618009 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:03.618137 [debug] [MainThread]: On master: Close
[0m13:39:03.619306 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m13:39:03.619519 [info ] [MainThread]: 
[0m13:39:03.621179 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:39:03.621444 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m13:39:03.621834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:39:03.622078 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:39:03.625903 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:03.626893 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:39:03.622198 => 13:39:03.626742
[0m13:39:03.627176 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:39:03.643502 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:03.644039 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:03.644224 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m13:39:03.644394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:03.647359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:03.647622 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:03.647864 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m13:39:10.586684 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m13:39:10.592901 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:10.593151 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:39:10.593940 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:10.602804 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:39:10.603037 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:10.603204 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m13:39:17.495177 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m13:39:17.498556 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:39:17.498809 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:39:17.499671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.500731 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:39:03.627309 => 13:39:17.500538
[0m13:39:17.500992 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:39:17.766394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119caa10>]}
[0m13:39:17.766903 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 14.14s]
[0m13:39:17.767213 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:39:17.767855 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:39:17.768083 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m13:39:17.768689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m13:39:17.768924 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:39:17.770724 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.772027 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 13:39:17.769047 => 13:39:17.771892
[0m13:39:17.772224 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:39:17.781884 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.782429 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.782622 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m13:39:17.782788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:17.786732 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.786996 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.787204 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m13:39:17.787737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.789526 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.789732 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m13:39:17.789994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.790758 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:39:17.791071 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.791250 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m13:39:17.791680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.793118 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m13:39:17.793323 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m13:39:17.793587 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.794320 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 13:39:17.772335 => 13:39:17.794204
[0m13:39:17.794533 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m13:39:17.855255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a4f090>]}
[0m13:39:17.855641 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.09s]
[0m13:39:17.855919 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m13:39:17.856313 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:39:17.856623 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m13:39:17.857093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m13:39:17.857292 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:39:17.860198 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.861261 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 13:39:17.857400 => 13:39:17.861109
[0m13:39:17.861465 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:39:17.863518 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.863909 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.864080 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m13:39:17.864237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:17.867374 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.867585 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.867784 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m13:39:17.870118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.871789 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.871972 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m13:39:17.872250 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.873000 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:39:17.873168 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.873323 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m13:39:17.873793 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.875156 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m13:39:17.875340 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m13:39:17.875589 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.876237 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 13:39:17.861567 => 13:39:17.876140
[0m13:39:17.876411 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m13:39:17.935194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1fa90>]}
[0m13:39:17.935594 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m13:39:17.935866 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m13:39:17.936495 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m13:39:17.936797 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m13:39:17.937165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m13:39:17.937361 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m13:39:17.939027 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:17.940167 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 13:39:17.937460 => 13:39:17.940037
[0m13:39:17.940367 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m13:39:17.942215 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:17.942542 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:17.942703 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m13:39:17.942853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:17.945804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:17.945990 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:17.946165 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m13:39:18.378849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:18.381003 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:18.381204 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m13:39:18.381519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:18.382393 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m13:39:18.382565 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:18.382721 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m13:39:18.384450 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:18.385726 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m13:39:18.385919 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m13:39:18.386176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:39:18.386858 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 13:39:17.940467 => 13:39:18.386749
[0m13:39:18.387040 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m13:39:18.482764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d1159d7-aabb-463b-b28a-74d74e7d6325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b03190>]}
[0m13:39:18.483213 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.55s]
[0m13:39:18.483564 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m13:39:18.484414 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:18.484589 [debug] [MainThread]: On master: BEGIN
[0m13:39:18.484730 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:18.487960 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:18.488142 [debug] [MainThread]: On master: COMMIT
[0m13:39:18.488280 [debug] [MainThread]: Using duckdb connection "master"
[0m13:39:18.488410 [debug] [MainThread]: On master: COMMIT
[0m13:39:18.488574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:39:18.488707 [debug] [MainThread]: On master: Close
[0m13:39:18.489982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:18.490238 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m13:39:18.490440 [info ] [MainThread]: 
[0m13:39:18.490675 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 14.93 seconds (14.93s).
[0m13:39:18.491256 [debug] [MainThread]: Command end result
[0m13:39:18.499888 [info ] [MainThread]: 
[0m13:39:18.500229 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:18.500481 [info ] [MainThread]: 
[0m13:39:18.500663 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:39:18.502156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.266953, "process_user_time": 44.579823, "process_kernel_time": 3.18638, "process_mem_max_rss": "3776561152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:39:18.502498 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:18.502435 after 15.27 seconds
[0m13:39:18.502710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a2d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102959010>]}
[0m13:39:18.502899 [debug] [MainThread]: Flushing usage events
[0m13:57:11.952226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c47610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8a50>]}


============================== 13:57:11.955631 | 49d380cb-346f-4eed-9038-1a1029646ecf ==============================
[0m13:57:11.955631 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:57:11.956130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw --target cw_md_dev', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.959427 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'MOTHERDUCK_TOKEN'
[0m13:57:11.960600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.049159333, "process_user_time": 0.95745, "process_kernel_time": 0.124463, "process_mem_max_rss": "105578496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:57:11.960943 [debug] [MainThread]: Command `dbt run` failed at 13:57:11.960869 after 0.05 seconds
[0m13:57:11.961262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024afa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10235d150>]}
[0m13:57:11.961501 [debug] [MainThread]: Flushing usage events
[0m13:57:39.487633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eedd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa0dd0>]}


============================== 13:57:39.490508 | 2ca5c3fd-d590-4c56-bf0a-20509c7d8c34 ==============================
[0m13:57:39.490508 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:57:39.490854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw --target cw_md_dev', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:39.645058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113269750>]}
[0m13:57:39.704839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bbd90>]}
[0m13:57:39.705784 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m13:57:39.715738 [debug] [MainThread]: checksum: 3d8897dceebab31c867fb6f5ec7a3794929621bfa5fe7cf3102e279748b9b56b, vars: {}, profile: , target: cw_md_dev, version: 1.7.8
[0m13:57:39.721458 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:57:39.721731 [debug] [MainThread]: previous checksum: 3d8897dceebab31c867fb6f5ec7a3794929621bfa5fe7cf3102e279748b9b56b, current checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5
[0m13:57:39.721884 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m13:57:39.722061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134e1c10>]}
[0m13:57:40.298530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m13:57:40.301207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429fa50>]}
[0m13:57:40.306543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144846d0>]}
[0m13:57:40.306849 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m13:57:40.307047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142b9010>]}
[0m13:57:40.307799 [info ] [MainThread]: 
[0m13:57:40.308215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:57:40.308826 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_climate_works'
[0m13:57:40.314806 [debug] [ThreadPool]: Using duckdb connection "list_climate_works"
[0m13:57:40.315229 [debug] [ThreadPool]: On list_climate_works: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"climate_works"'
    
  
  
[0m13:57:40.315513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:43.430202 [debug] [ThreadPool]: SQL status: OK in 3.0 seconds
[0m13:57:43.431183 [debug] [ThreadPool]: On list_climate_works: Close
[0m13:57:43.431919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_climate_works, now create_climate_works_dev_sode)
[0m13:57:43.432337 [debug] [ThreadPool]: Creating schema "database: "climate_works"
schema: "dev_sode"
"
[0m13:57:43.434576 [debug] [ThreadPool]: Using duckdb connection "create_climate_works_dev_sode"
[0m13:57:43.434766 [debug] [ThreadPool]: On create_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "create_climate_works_dev_sode"} */
create schema if not exists "climate_works"."dev_sode"
[0m13:57:43.434912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:43.936410 [debug] [ThreadPool]: SQL status: OK in 1.0 seconds
[0m13:57:43.938088 [debug] [ThreadPool]: On create_climate_works_dev_sode: Close
[0m13:57:43.940837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_climate_works_dev_sode, now list_climate_works_dev_sode)
[0m13:57:43.944219 [debug] [ThreadPool]: Using duckdb connection "list_climate_works_dev_sode"
[0m13:57:43.944565 [debug] [ThreadPool]: On list_climate_works_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "connection_name": "list_climate_works_dev_sode"} */
select
      'climate_works' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'climate_works'
  
[0m13:57:43.944770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:43.963593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:57:43.968612 [debug] [ThreadPool]: On list_climate_works_dev_sode: Close
[0m13:57:43.969529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134326d0>]}
[0m13:57:43.969863 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:43.970024 [debug] [MainThread]: On master: BEGIN
[0m13:57:43.970165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:43.970427 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:43.970569 [debug] [MainThread]: On master: COMMIT
[0m13:57:43.970700 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:43.970830 [debug] [MainThread]: On master: COMMIT
[0m13:57:43.970987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:43.971119 [debug] [MainThread]: On master: Close
[0m13:57:43.971458 [info ] [MainThread]: Concurrency: 1 threads (target='cw_md_dev')
[0m13:57:43.971700 [info ] [MainThread]: 
[0m13:57:43.974032 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:43.974401 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m13:57:43.974775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_climate_works_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m13:57:43.974955 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:43.978684 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:43.979657 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 13:57:43.975059 => 13:57:43.979480
[0m13:57:43.979908 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:57:44.003810 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:44.004495 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:57:44.004776 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m13:57:44.005006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:13.751711 [debug] [Thread-1 (]: SQL status: OK in 30.0 seconds
[0m13:58:13.756994 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:58:13.757254 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m13:58:14.479395 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:58:14.484542 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:58:14.484881 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m13:58:15.263918 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:58:15.277721 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m13:58:15.278000 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_md_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "climate_works"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m13:58:16.154406 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m13:58:16.157175 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 13:57:43.980020 => 13:58:16.156821
[0m13:58:16.157491 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m13:58:16.157946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ca5c3fd-d590-4c56-bf0a-20509c7d8c34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d8fd0>]}
[0m13:58:16.158269 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 32.18s]
[0m13:58:16.158594 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m13:58:16.159673 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:16.159851 [debug] [MainThread]: On master: BEGIN
[0m13:58:16.159995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:16.160242 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:58:16.160381 [debug] [MainThread]: On master: COMMIT
[0m13:58:16.160512 [debug] [MainThread]: Using duckdb connection "master"
[0m13:58:16.160640 [debug] [MainThread]: On master: COMMIT
[0m13:58:16.160795 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:58:16.161160 [debug] [MainThread]: On master: Close
[0m13:58:16.161578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:16.161724 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m13:58:16.161889 [info ] [MainThread]: 
[0m13:58:16.162048 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 35.85 seconds (35.85s).
[0m13:58:16.162332 [debug] [MainThread]: Command end result
[0m13:58:16.166574 [info ] [MainThread]: 
[0m13:58:16.166816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:16.167081 [info ] [MainThread]: 
[0m13:58:16.167269 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:58:16.168211 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.714977, "process_user_time": 2.016814, "process_kernel_time": 0.236516, "process_mem_max_rss": "160612352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:58:16.168508 [debug] [MainThread]: Command `dbt run` succeeded at 13:58:16.168447 after 36.72 seconds
[0m13:58:16.168706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e0f990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9a3d0>]}
[0m13:58:16.168900 [debug] [MainThread]: Flushing usage events
[0m14:10:56.968011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060aad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bbd90>]}


============================== 14:10:56.971414 | 0d74eaf6-c1ed-4477-90a8-fd13d5fa6996 ==============================
[0m14:10:56.971414 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:10:56.971788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select /Users/raajassode/dev/climate_works_dbt/models/staging', 'send_anonymous_usage_stats': 'True'}
[0m14:10:57.154587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606cd50>]}
[0m14:10:57.219423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a7d90>]}
[0m14:10:57.220898 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:10:57.231135 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:10:57.237592 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:10:57.237911 [debug] [MainThread]: previous checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, current checksum: 3d8897dceebab31c867fb6f5ec7a3794929621bfa5fe7cf3102e279748b9b56b
[0m14:10:57.238068 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m14:10:57.238247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ebd50>]}
[0m14:10:57.814162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:10:57.816938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e92650>]}
[0m14:10:57.822348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f61850>]}
[0m14:10:57.822657 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:10:57.822846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d74eaf6-c1ed-4477-90a8-fd13d5fa6996', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc4990>]}
[0m14:10:57.823166 [error] [MainThread]: Encountered an error:
Non-relative patterns are unsupported
[0m14:10:57.826538 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/requires.py", line 278, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/cli/main.py", line 625, in run
    results = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 454, in run
    self._runtime_initialize()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/compile.py", line 147, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
                     ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/task/runnable.py", line 140, in get_graph_queue
    return selector.get_graph_queue(spec)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 318, in get_graph_queue
    selected_nodes = self.get_selected(spec)
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 309, in get_selected
    selected_nodes, indirect_only = self.select_nodes(spec)
                                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 158, in select_nodes
    direct_nodes, indirect_nodes = self.select_nodes_recursively(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in select_nodes_recursively
    bundles = [self.select_nodes_recursively(component) for component in spec]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 130, in <listcomp>
    bundles = [self.select_nodes_recursively(component) for component in spec]
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 128, in select_nodes_recursively
    direct_nodes, indirect_nodes = self.get_nodes_from_criteria(spec)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 82, in get_nodes_from_criteria
    collected = self.select_included(nodes, spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector.py", line 68, in select_included
    return set(method.search(included_nodes, spec.value))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in search
    paths = set(p.relative_to(root) for p in root.glob(selector))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/dbt/graph/selector_methods.py", line 413, in <genexpr>
    paths = set(p.relative_to(root) for p in root.glob(selector))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.7_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/pathlib.py", line 949, in glob
    raise NotImplementedError("Non-relative patterns are unsupported")
NotImplementedError: Non-relative patterns are unsupported

[0m14:10:57.828590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.89959276, "process_user_time": 1.723574, "process_kernel_time": 0.167613, "process_mem_max_rss": "136740864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:10:57.829014 [debug] [MainThread]: Command `dbt run` failed at 14:10:57.828938 after 0.90 seconds
[0m14:10:57.829245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100930b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008890d0>]}
[0m14:10:57.829463 [debug] [MainThread]: Flushing usage events
[0m14:11:19.979999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10563cd10>]}


============================== 14:11:19.982736 | ab4e26ec-8d1f-46e5-828e-f847fcc40e92 ==============================
[0m14:11:19.982736 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:11:19.983047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_daily_climate_parameters_vertical_raw', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:20.131393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571bd10>]}
[0m14:11:20.195009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571bd10>]}
[0m14:11:20.195555 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:11:20.205324 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:11:20.219546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:20.219832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:20.220319 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:11:20.223375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10341c890>]}
[0m14:11:20.229824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bf650>]}
[0m14:11:20.230298 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:11:20.230574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105675190>]}
[0m14:11:20.232164 [info ] [MainThread]: 
[0m14:11:20.232710 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:20.233427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:11:20.240917 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:11:20.241217 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:11:20.241392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:20.246697 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.247657 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:11:20.250034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:11:20.250495 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:11:20.253215 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:20.253406 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:11:20.253556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:20.256880 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.257293 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:20.257490 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:11:20.257723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.258213 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:11:20.258362 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:20.258495 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:11:20.258670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.258808 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:11:20.261124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:11:20.264177 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:11:20.264516 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:11:20.264886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:20.268421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.268671 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:11:20.268830 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:11:20.279606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:20.282493 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:11:20.283593 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:11:20.283846 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:11:20.285853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105950e10>]}
[0m14:11:20.286127 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:20.286278 [debug] [MainThread]: On master: BEGIN
[0m14:11:20.286419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:20.289244 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:20.289473 [debug] [MainThread]: On master: COMMIT
[0m14:11:20.289627 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:20.289765 [debug] [MainThread]: On master: COMMIT
[0m14:11:20.289958 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:20.290104 [debug] [MainThread]: On master: Close
[0m14:11:20.291501 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:11:20.291751 [info ] [MainThread]: 
[0m14:11:20.293515 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:20.293817 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m14:11:20.294242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m14:11:20.294464 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:20.298682 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:20.299785 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 14:11:20.294579 => 14:11:20.299592
[0m14:11:20.300053 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:20.316607 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:20.317180 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:20.317363 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m14:11:20.317530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:20.320522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:11:20.320858 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:20.321100 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m14:11:28.180770 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m14:11:28.185301 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:28.185546 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m14:11:28.185905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:11:28.194923 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:11:28.195202 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:28.195509 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:11:35.192346 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m14:11:35.196088 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:35.196347 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m14:11:35.196668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:11:35.197418 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 14:11:20.300164 => 14:11:35.197311
[0m14:11:35.197613 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m14:11:35.474092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab4e26ec-8d1f-46e5-828e-f847fcc40e92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105681150>]}
[0m14:11:35.474723 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 15.18s]
[0m14:11:35.475142 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:35.476095 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:35.476310 [debug] [MainThread]: On master: BEGIN
[0m14:11:35.476460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:35.479912 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:35.480119 [debug] [MainThread]: On master: COMMIT
[0m14:11:35.480271 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:35.480410 [debug] [MainThread]: On master: COMMIT
[0m14:11:35.480573 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:35.480716 [debug] [MainThread]: On master: Close
[0m14:11:35.482846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:35.483046 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw' was properly closed.
[0m14:11:35.483227 [info ] [MainThread]: 
[0m14:11:35.483397 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m14:11:35.483709 [debug] [MainThread]: Command end result
[0m14:11:35.489733 [info ] [MainThread]: 
[0m14:11:35.490065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:35.490510 [info ] [MainThread]: 
[0m14:11:35.490810 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:11:35.492233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.552139, "process_user_time": 44.037697, "process_kernel_time": 2.798388, "process_mem_max_rss": "3800465408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:35.492593 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:35.492526 after 15.55 seconds
[0m14:11:35.492813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105614510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101089310>]}
[0m14:11:35.493013 [debug] [MainThread]: Flushing usage events
[0m14:11:57.014893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128edb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a0c90>]}


============================== 14:11:57.018512 | 91ab65a2-35e8-4f83-96fe-166bd5c5e4a7 ==============================
[0m14:11:57.018512 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:11:57.018849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:57.169828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129e84d0>]}
[0m14:11:57.233563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ee950>]}
[0m14:11:57.234184 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:11:57.243853 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:11:57.257954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:57.258237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:57.258714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:11:57.262845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139cf950>]}
[0m14:11:57.270070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11382c210>]}
[0m14:11:57.270402 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:11:57.270597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383b2d0>]}
[0m14:11:57.271531 [info ] [MainThread]: 
[0m14:11:57.271993 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:11:57.272644 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:11:57.278395 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:11:57.278628 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:11:57.278799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:57.283751 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.284796 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:11:57.287639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:11:57.288599 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:11:57.291529 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:57.291765 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:11:57.291912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:57.295299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.295555 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:57.295715 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:11:57.295932 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.296459 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:11:57.296617 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:11:57.296755 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:11:57.296947 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.297091 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:11:57.299529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:11:57.302521 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:11:57.302723 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:11:57.302860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:57.306023 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.306254 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:11:57.306414 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:11:57.317322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:11:57.320184 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:11:57.321232 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:11:57.321424 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:11:57.323805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297fad0>]}
[0m14:11:57.324248 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:57.324401 [debug] [MainThread]: On master: BEGIN
[0m14:11:57.324539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:57.327534 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:57.327731 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.327873 [debug] [MainThread]: Using duckdb connection "master"
[0m14:11:57.328006 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.328169 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:11:57.328312 [debug] [MainThread]: On master: Close
[0m14:11:57.329708 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:11:57.329918 [info ] [MainThread]: 
[0m14:11:57.331743 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:57.332032 [info ] [Thread-1 (]: 1 of 2 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m14:11:57.332377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m14:11:57.332555 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:57.336383 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:57.337175 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 14:11:57.332660 => 14:11:57.336943
[0m14:11:57.337457 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:11:57.353905 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:57.354626 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:57.355132 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m14:11:57.355394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:57.359108 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:11:57.359373 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:11:57.359601 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m14:12:05.274547 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m14:12:05.282454 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:12:05.282745 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m14:12:05.283126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:05.284663 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:12:05.284866 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m14:12:05.285144 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:05.294783 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:12:05.295077 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:12:05.295256 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:12:12.195340 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m14:12:12.199054 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:12:12.199332 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m14:12:12.207397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.208575 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 14:11:57.337646 => 14:12:12.208353
[0m14:12:12.208864 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m14:12:12.572142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297c1d0>]}
[0m14:12:12.572625 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 15.24s]
[0m14:12:12.572938 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:12:12.573646 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:12:12.574040 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m14:12:12.574507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m14:12:12.574724 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:12:12.576662 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.579073 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 14:12:12.574907 => 14:12:12.578903
[0m14:12:12.579396 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:12:12.591014 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.591836 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.592142 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m14:12:12.592324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:12.598128 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.598430 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.598649 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m14:12:12.599268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.602011 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.602226 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m14:12:12.602508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.603253 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:12:12.603444 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.603610 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:12:12.604032 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.605514 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:12:12.605787 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m14:12:12.606162 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:12:12.607013 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 14:12:12.579557 => 14:12:12.606908
[0m14:12:12.607203 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m14:12:12.669904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91ab65a2-35e8-4f83-96fe-166bd5c5e4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1ca10>]}
[0m14:12:12.670356 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.10s]
[0m14:12:12.670670 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:12:12.671592 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:12.671952 [debug] [MainThread]: On master: BEGIN
[0m14:12:12.672340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:12.675781 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:12.675978 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.676119 [debug] [MainThread]: Using duckdb connection "master"
[0m14:12:12.676253 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.676404 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:12:12.676541 [debug] [MainThread]: On master: Close
[0m14:12:12.678683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:12.678846 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m14:12:12.679015 [info ] [MainThread]: 
[0m14:12:12.679181 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 15.41 seconds (15.41s).
[0m14:12:12.679527 [debug] [MainThread]: Command end result
[0m14:12:12.690746 [info ] [MainThread]: 
[0m14:12:12.691507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:12.691927 [info ] [MainThread]: 
[0m14:12:12.692160 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:12:12.694706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.719953, "process_user_time": 44.233902, "process_kernel_time": 2.842414, "process_mem_max_rss": "3818717184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:12:12.695173 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:12.695103 after 15.72 seconds
[0m14:12:12.695401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a0ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104904a50>]}
[0m14:12:12.695604 [debug] [MainThread]: Flushing usage events
[0m14:13:44.560897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107554710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107554cd0>]}


============================== 14:13:44.563579 | 036ae7e0-a4b8-4671-b4c8-5008418b71e4 ==============================
[0m14:13:44.563579 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:13:44.563906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_daily_climate_params_pivoted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:44.759111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107533d10>]}
[0m14:13:44.822071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a1f90>]}
[0m14:13:44.822622 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:13:44.832447 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:13:44.847029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:44.847298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:44.847777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:13:44.850771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107582950>]}
[0m14:13:44.856718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757cd90>]}
[0m14:13:44.857048 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:13:44.857252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a12d0>]}
[0m14:13:44.858190 [info ] [MainThread]: 
[0m14:13:44.858658 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:13:44.859294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:13:44.865741 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:13:44.866037 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:13:44.866219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:44.871320 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.872385 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:13:44.874265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:13:44.874866 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:13:44.878120 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:13:44.878382 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:13:44.878523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:44.881965 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.882153 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:13:44.882307 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:13:44.882533 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.883027 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:13:44.883187 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:13:44.883326 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:13:44.883505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.883648 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:13:44.886542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:13:44.889606 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:13:44.889824 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:13:44.889968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:44.893892 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.894148 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:13:44.894307 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:13:44.905699 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:13:44.908588 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:13:44.909653 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:13:44.909950 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:13:44.912249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c78d0>]}
[0m14:13:44.912525 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:44.912669 [debug] [MainThread]: On master: BEGIN
[0m14:13:44.912820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:44.916218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:44.916437 [debug] [MainThread]: On master: COMMIT
[0m14:13:44.916588 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:44.916728 [debug] [MainThread]: On master: COMMIT
[0m14:13:44.916898 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:44.917045 [debug] [MainThread]: On master: Close
[0m14:13:44.918455 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:13:44.918659 [info ] [MainThread]: 
[0m14:13:44.920805 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:13:44.921187 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m14:13:44.921610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m14:13:44.921821 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:13:44.925872 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.926657 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 14:13:44.921934 => 14:13:44.926529
[0m14:13:44.926854 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:13:44.942951 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.943558 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.943744 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m14:13:44.943907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:44.947547 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:44.947784 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.947994 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by record_id,reading_date, source_flag, measurement_flag
    )
)



select 
    
    record_id,
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m14:13:44.949044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:44.952411 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.952677 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m14:13:44.953006 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:44.960288 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m14:13:44.960566 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.960732 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m14:13:44.961318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:44.964073 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:13:44.964283 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m14:13:44.964537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:13:44.965239 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 14:13:44.926963 => 14:13:44.965136
[0m14:13:44.965421 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m14:13:45.026813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '036ae7e0-a4b8-4671-b4c8-5008418b71e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d1dd0>]}
[0m14:13:45.027303 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.11s]
[0m14:13:45.027607 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:13:45.028603 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:45.028849 [debug] [MainThread]: On master: BEGIN
[0m14:13:45.029053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:45.032487 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:45.032695 [debug] [MainThread]: On master: COMMIT
[0m14:13:45.032848 [debug] [MainThread]: Using duckdb connection "master"
[0m14:13:45.032992 [debug] [MainThread]: On master: COMMIT
[0m14:13:45.033159 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:13:45.033310 [debug] [MainThread]: On master: Close
[0m14:13:45.034980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:45.035208 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m14:13:45.035386 [info ] [MainThread]: 
[0m14:13:45.035560 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:13:45.035878 [debug] [MainThread]: Command end result
[0m14:13:45.039656 [info ] [MainThread]: 
[0m14:13:45.039875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:45.040021 [info ] [MainThread]: 
[0m14:13:45.040189 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:45.041081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5202309, "process_user_time": 1.311886, "process_kernel_time": 0.141317, "process_mem_max_rss": "156975104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:13:45.041395 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:45.041335 after 0.52 seconds
[0m14:13:45.041605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107530a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e16950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fa5310>]}
[0m14:13:45.041792 [debug] [MainThread]: Flushing usage events
[0m14:15:36.518764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebb6d0>]}


============================== 14:15:36.521900 | 0f9e19e7-2cfc-4b0e-947f-288b5dbfd838 ==============================
[0m14:15:36.521900 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:15:36.522440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fact_daily_climate_parameters', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:15:36.709660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23ffd0>]}
[0m14:15:36.776059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1aa910>]}
[0m14:15:36.777605 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:15:36.788975 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:15:36.815788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:36.816098 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:36.816587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:15:36.819610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e1390>]}
[0m14:15:36.826324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a32f110>]}
[0m14:15:36.826734 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:15:36.827152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eab710>]}
[0m14:15:36.828103 [info ] [MainThread]: 
[0m14:15:36.828545 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:15:36.829507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:15:36.838540 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:15:36.838816 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:15:36.838995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:36.844044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.845050 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:15:36.846912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:15:36.847338 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:15:36.850203 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:15:36.850410 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:15:36.850558 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:36.854169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.854400 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:15:36.854551 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:15:36.854764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.855250 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:15:36.855409 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:15:36.855542 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:15:36.855727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.855874 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:15:36.859720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:15:36.862849 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:15:36.863037 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:15:36.863177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:36.866493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.866672 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:15:36.866828 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:15:36.877615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:15:36.880502 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:15:36.881522 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:15:36.881774 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:15:36.884371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4d9750>]}
[0m14:15:36.884632 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:36.884781 [debug] [MainThread]: On master: BEGIN
[0m14:15:36.885030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:36.888979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:36.889224 [debug] [MainThread]: On master: COMMIT
[0m14:15:36.889377 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:36.889515 [debug] [MainThread]: On master: COMMIT
[0m14:15:36.889683 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:36.889824 [debug] [MainThread]: On master: Close
[0m14:15:36.891227 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:15:36.891405 [info ] [MainThread]: 
[0m14:15:36.893397 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:15:36.893724 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m14:15:36.894133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m14:15:36.894334 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:15:36.898179 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:36.899100 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 14:15:36.894447 => 14:15:36.898937
[0m14:15:36.899695 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:15:36.915863 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:36.916617 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:36.916871 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m14:15:36.917049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:36.920523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:36.920789 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:36.920982 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m14:15:37.888929 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m14:15:37.892558 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:37.892773 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m14:15:37.893118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.905044 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m14:15:37.905329 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:37.905506 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m14:15:37.976635 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.980238 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:15:37.980509 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m14:15:37.980845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:15:37.981602 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 14:15:36.899826 => 14:15:37.981495
[0m14:15:37.981795 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m14:15:38.072143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f9e19e7-2cfc-4b0e-947f-288b5dbfd838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a24cb10>]}
[0m14:15:38.072594 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 1.18s]
[0m14:15:38.072888 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:15:38.075176 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:38.075405 [debug] [MainThread]: On master: BEGIN
[0m14:15:38.075559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:38.080574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:38.080784 [debug] [MainThread]: On master: COMMIT
[0m14:15:38.080929 [debug] [MainThread]: Using duckdb connection "master"
[0m14:15:38.081066 [debug] [MainThread]: On master: COMMIT
[0m14:15:38.081221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:15:38.081364 [debug] [MainThread]: On master: Close
[0m14:15:38.086501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:38.086716 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m14:15:38.086893 [info ] [MainThread]: 
[0m14:15:38.087068 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m14:15:38.087370 [debug] [MainThread]: Command end result
[0m14:15:38.094657 [info ] [MainThread]: 
[0m14:15:38.094913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:38.095064 [info ] [MainThread]: 
[0m14:15:38.095238 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:15:38.096843 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6191941, "process_user_time": 5.476033, "process_kernel_time": 0.625059, "process_mem_max_rss": "1739046912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:15:38.097380 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:38.097276 after 1.62 seconds
[0m14:15:38.097724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbf8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dbf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c23d0>]}
[0m14:15:38.098108 [debug] [MainThread]: Flushing usage events
[0m14:19:40.817234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e336d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e55090>]}


============================== 14:19:40.820395 | 553bdd35-9ea4-45b4-a793-9084567ab24b ==============================
[0m14:19:40.820395 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:19:40.820749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:41.010885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e83a50>]}
[0m14:19:41.074993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea0910>]}
[0m14:19:41.076548 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:19:41.086078 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:19:41.099589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:41.099852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:41.100303 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:19:41.103195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e33e90>]}
[0m14:19:41.110516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109009690>]}
[0m14:19:41.110846 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:19:41.111040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e230d0>]}
[0m14:19:41.112023 [info ] [MainThread]: 
[0m14:19:41.112443 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:19:41.113108 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:19:41.119041 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:19:41.119316 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:19:41.119494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:41.124449 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.125394 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:19:41.127788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:19:41.128293 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:19:41.131070 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:19:41.131259 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:19:41.131406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:41.134893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.135087 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:19:41.135232 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:19:41.135433 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.135916 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:19:41.136063 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:19:41.136194 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:19:41.136357 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.136492 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:19:41.138937 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:19:41.142018 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:19:41.142203 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:19:41.142344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:41.145661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.145853 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:19:41.146004 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:19:41.156997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:19:41.159957 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:19:41.161049 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:19:41.161277 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:19:41.163619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a6290>]}
[0m14:19:41.163865 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:41.164010 [debug] [MainThread]: On master: BEGIN
[0m14:19:41.164168 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:41.168448 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:41.168703 [debug] [MainThread]: On master: COMMIT
[0m14:19:41.168879 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:41.169018 [debug] [MainThread]: On master: COMMIT
[0m14:19:41.169183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:41.169323 [debug] [MainThread]: On master: Close
[0m14:19:41.170871 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:19:41.171119 [info ] [MainThread]: 
[0m14:19:41.172913 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:19:41.173193 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m14:19:41.173709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m14:19:41.173969 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:19:41.177956 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:41.179311 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 14:19:41.174093 => 14:19:41.179002
[0m14:19:41.179527 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:19:41.196177 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:41.196735 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:41.196926 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m14:19:41.197095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:41.200619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:41.200839 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:41.201046 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m14:19:49.488716 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m14:19:49.492681 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:49.492932 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m14:19:49.493295 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:49.495113 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:49.495435 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m14:19:49.496066 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:49.505674 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:19:49.505963 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:49.506141 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:19:56.744537 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m14:19:56.749092 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:19:56.749344 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m14:19:56.756887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:56.758134 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 14:19:41.179637 => 14:19:56.757971
[0m14:19:56.758362 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m14:19:57.046140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e9510>]}
[0m14:19:57.046862 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 15.87s]
[0m14:19:57.047446 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:19:57.048272 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:19:57.048642 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m14:19:57.049079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m14:19:57.049272 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:19:57.050982 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.052904 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 14:19:57.049382 => 14:19:57.052764
[0m14:19:57.053200 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:19:57.064331 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.065109 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.065357 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m14:19:57.065535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:57.073100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.073381 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.073591 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m14:19:57.074121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.076866 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.077059 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m14:19:57.077328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.078707 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.078890 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m14:19:57.079130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.079984 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:19:57.080152 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.080306 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:19:57.080818 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.082284 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:19:57.082534 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m14:19:57.082938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.083686 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 14:19:57.053456 => 14:19:57.083581
[0m14:19:57.083878 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m14:19:57.149128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6650>]}
[0m14:19:57.149533 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.10s]
[0m14:19:57.149823 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:19:57.150298 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:19:57.150657 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m14:19:57.151068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m14:19:57.151273 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:19:57.152949 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:19:57.154281 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 14:19:57.151376 => 14:19:57.154139
[0m14:19:57.154477 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:19:57.156416 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:19:57.157069 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:19:57.157315 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m14:19:57.157655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:57.161669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:19:57.161955 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:19:57.162170 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    record_id,
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m14:19:57.165972 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 14:19:57.154578 => 14:19:57.165794
[0m14:19:57.166223 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: ROLLBACK
[0m14:19:57.171571 [debug] [Thread-1 (]: Failed to rollback 'model.climate_works_dbt.int_daily_climate_params_pivoted'
[0m14:19:57.171855 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m14:19:57.174392 [debug] [Thread-1 (]: Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "record_id" not found in FROM clause!
  Candidate bindings: "pivoted.PRCP"
[0m14:19:57.174638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '553bdd35-9ea4-45b4-a793-9084567ab24b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939b110>]}
[0m14:19:57.174927 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model dev_sode.int_daily_climate_params_pivoted . [[31mERROR[0m in 0.02s]
[0m14:19:57.175198 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:19:57.175683 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:19:57.176019 [info ] [Thread-1 (]: 4 of 4 SKIP relation dev_sode.fact_daily_climate_parameters .................... [[33mSKIP[0m]
[0m14:19:57.176292 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:19:57.177887 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:57.178154 [debug] [MainThread]: On master: BEGIN
[0m14:19:57.178406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:57.181787 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:57.181986 [debug] [MainThread]: On master: COMMIT
[0m14:19:57.182130 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:57.182267 [debug] [MainThread]: On master: COMMIT
[0m14:19:57.182425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:19:57.182570 [debug] [MainThread]: On master: Close
[0m14:19:57.184852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:57.185056 [debug] [MainThread]: Connection 'model.climate_works_dbt.int_daily_climate_params_pivoted' was properly closed.
[0m14:19:57.185256 [info ] [MainThread]: 
[0m14:19:57.185494 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 16.07 seconds (16.07s).
[0m14:19:57.186045 [debug] [MainThread]: Command end result
[0m14:19:57.192117 [info ] [MainThread]: 
[0m14:19:57.192404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:57.192561 [info ] [MainThread]: 
[0m14:19:57.192710 [error] [MainThread]:   Runtime Error in model int_daily_climate_params_pivoted (models/Intermediate/int_daily_climate_params_pivoted.sql)
  Binder Error: Referenced column "record_id" not found in FROM clause!
  Candidate bindings: "pivoted.PRCP"
[0m14:19:57.192862 [info ] [MainThread]: 
[0m14:19:57.193030 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:19:57.194149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.41681, "process_user_time": 44.50105, "process_kernel_time": 2.644116, "process_mem_max_rss": "3266789376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:19:57.194455 [debug] [MainThread]: Command `dbt run` failed at 14:19:57.194398 after 16.42 seconds
[0m14:19:57.194663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e30a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ab690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fcb10>]}
[0m14:19:57.194848 [debug] [MainThread]: Flushing usage events
[0m14:20:18.254394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b34c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ba4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ba4ad0>]}


============================== 14:20:18.257567 | 9a49e133-0f4c-4041-b005-f3c01c9123d7 ==============================
[0m14:20:18.257567 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:20:18.257967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'send_anonymous_usage_stats': 'True'}
[0m14:20:18.407696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120af2990>]}
[0m14:20:18.472960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fbbc50>]}
[0m14:20:18.474444 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:20:18.483902 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:20:18.497976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:18.498238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:18.498709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:20:18.501718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ba4cd0>]}
[0m14:20:18.507189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f0f390>]}
[0m14:20:18.507729 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:20:18.507940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e65790>]}
[0m14:20:18.508925 [info ] [MainThread]: 
[0m14:20:18.509331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:20:18.510068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:20:18.516108 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:20:18.516407 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:20:18.516571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:18.521361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.522380 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:20:18.524831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:20:18.525423 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:20:18.528303 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:20:18.528519 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:20:18.528654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:18.532288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.532505 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:20:18.532677 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:20:18.532904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.533398 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:20:18.533546 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:20:18.533674 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:20:18.533841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.533975 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:20:18.536011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:20:18.539053 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:20:18.539280 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:20:18.539426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:18.542934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.543150 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:20:18.543317 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:20:18.553842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:20:18.556862 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:20:18.557819 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:20:18.558012 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:20:18.560322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120edd250>]}
[0m14:20:18.560630 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:18.560828 [debug] [MainThread]: On master: BEGIN
[0m14:20:18.560971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:18.564485 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:20:18.564697 [debug] [MainThread]: On master: COMMIT
[0m14:20:18.564841 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:18.564972 [debug] [MainThread]: On master: COMMIT
[0m14:20:18.565131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:20:18.565268 [debug] [MainThread]: On master: Close
[0m14:20:18.567121 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:20:18.567325 [info ] [MainThread]: 
[0m14:20:18.569187 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:20:18.569445 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m14:20:18.569775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m14:20:18.569946 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:20:18.573676 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:18.574098 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 14:20:18.570048 => 14:20:18.573983
[0m14:20:18.574281 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:20:18.590562 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:18.591129 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:18.591316 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m14:20:18.591484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:18.595494 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:18.595784 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:18.596007 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m14:20:26.001307 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m14:20:26.007247 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:26.007507 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m14:20:26.007903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:26.009337 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:26.009522 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m14:20:26.009764 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:26.019554 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:20:26.019826 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:26.020004 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:20:32.949112 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m14:20:32.952705 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:20:32.952959 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m14:20:32.960281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:32.961336 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 14:20:18.574377 => 14:20:32.961183
[0m14:20:32.961560 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m14:20:33.272984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fd4910>]}
[0m14:20:33.273514 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 14.70s]
[0m14:20:33.273965 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:20:33.274580 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:20:33.274799 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m14:20:33.275188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m14:20:33.275396 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:20:33.277276 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.279625 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 14:20:33.275513 => 14:20:33.279418
[0m14:20:33.279851 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:20:33.289041 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.289838 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.290033 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m14:20:33.290210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:33.293699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.293924 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.294127 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m14:20:33.294678 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.297535 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.297760 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m14:20:33.298051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.299379 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.299555 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m14:20:33.300056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.301322 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:20:33.301623 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.301813 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:20:33.302269 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.303859 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:20:33.304129 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m14:20:33.304593 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.305369 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 14:20:33.279966 => 14:20:33.305263
[0m14:20:33.305571 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m14:20:33.372885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12120fe90>]}
[0m14:20:33.373436 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.10s]
[0m14:20:33.373910 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:20:33.374406 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:20:33.374733 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m14:20:33.375099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m14:20:33.375272 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:20:33.376900 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.378145 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 14:20:33.375371 => 14:20:33.377815
[0m14:20:33.378496 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:20:33.381098 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.381593 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.381783 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m14:20:33.381950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:33.385580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.385858 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.386071 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m14:20:33.387174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.389154 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.389442 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted" rename to "int_daily_climate_params_pivoted__dbt_backup"
[0m14:20:33.389782 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.391341 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.391565 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m14:20:33.391860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.392722 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m14:20:33.392889 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.393042 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m14:20:33.393463 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.394990 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m14:20:33.395665 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m14:20:33.396136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.396978 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 14:20:33.378612 => 14:20:33.396863
[0m14:20:33.397198 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m14:20:33.459584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211e4a50>]}
[0m14:20:33.460007 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.08s]
[0m14:20:33.460288 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m14:20:33.460984 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:20:33.461246 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m14:20:33.461593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m14:20:33.461774 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:20:33.463500 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.464702 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 14:20:33.461886 => 14:20:33.464510
[0m14:20:33.464952 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:20:33.467014 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.467392 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.467566 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m14:20:33.467724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:33.471268 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.471563 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.471754 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m14:20:33.950405 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.952207 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.952401 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters" rename to "fact_daily_climate_parameters__dbt_backup"
[0m14:20:33.952702 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.954042 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.954331 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m14:20:33.954640 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.955898 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m14:20:33.956080 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.956232 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m14:20:33.959563 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.962488 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m14:20:33.962787 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m14:20:33.963624 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:20:33.964533 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 14:20:33.465064 => 14:20:33.964415
[0m14:20:33.964737 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m14:20:34.074442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a49e133-0f4c-4041-b005-f3c01c9123d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212702d0>]}
[0m14:20:34.074900 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.61s]
[0m14:20:34.075296 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m14:20:34.076295 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:34.076479 [debug] [MainThread]: On master: BEGIN
[0m14:20:34.076622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:34.080419 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:20:34.080670 [debug] [MainThread]: On master: COMMIT
[0m14:20:34.080822 [debug] [MainThread]: Using duckdb connection "master"
[0m14:20:34.080951 [debug] [MainThread]: On master: COMMIT
[0m14:20:34.081103 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:20:34.081237 [debug] [MainThread]: On master: Close
[0m14:20:34.084371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:34.084621 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m14:20:34.084827 [info ] [MainThread]: 
[0m14:20:34.085008 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 15.58 seconds (15.58s).
[0m14:20:34.085473 [debug] [MainThread]: Command end result
[0m14:20:34.131819 [info ] [MainThread]: 
[0m14:20:34.132100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:34.132259 [info ] [MainThread]: 
[0m14:20:34.132423 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:20:34.133794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.916198, "process_user_time": 46.21182, "process_kernel_time": 2.87198, "process_mem_max_rss": "2964701184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:34.134129 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:34.134063 after 15.92 seconds
[0m14:20:34.134331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100606290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006d0b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006dea90>]}
[0m14:20:34.134520 [debug] [MainThread]: Flushing usage events
[0m14:51:06.824050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12064b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12064b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12067f6d0>]}


============================== 14:51:06.828116 | edd8c73c-16bc-404c-afd1-3638cf14f0cf ==============================
[0m14:51:06.828116 [info ] [MainThread]: Running with dbt=1.7.8
[0m14:51:06.828530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:51:07.043656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a047d0>]}
[0m14:51:07.123977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120606190>]}
[0m14:51:07.125563 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m14:51:07.137093 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m14:51:07.169091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:07.169438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:07.170007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m14:51:07.173611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b6af50>]}
[0m14:51:07.180989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206e8e10>]}
[0m14:51:07.181378 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m14:51:07.181611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a7b550>]}
[0m14:51:07.182817 [info ] [MainThread]: 
[0m14:51:07.183350 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:51:07.184242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m14:51:07.192452 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m14:51:07.192806 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m14:51:07.193050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:07.198208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.199410 [debug] [ThreadPool]: On list_dev_database: Close
[0m14:51:07.201599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m14:51:07.202176 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m14:51:07.205646 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:51:07.205897 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m14:51:07.206072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:07.210113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.210422 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:51:07.210619 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m14:51:07.210900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.211528 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:51:07.211713 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m14:51:07.211880 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m14:51:07.212093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.212264 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m14:51:07.214731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m14:51:07.219177 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:51:07.219447 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m14:51:07.219621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:07.223326 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.223590 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m14:51:07.223788 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m14:51:07.238002 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:51:07.242030 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m14:51:07.243117 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m14:51:07.243318 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m14:51:07.245630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bb5910>]}
[0m14:51:07.245916 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:07.246092 [debug] [MainThread]: On master: BEGIN
[0m14:51:07.246253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:07.250248 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:51:07.250545 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.250732 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:07.250901 [debug] [MainThread]: On master: COMMIT
[0m14:51:07.251101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:51:07.251273 [debug] [MainThread]: On master: Close
[0m14:51:07.252719 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m14:51:07.252977 [info ] [MainThread]: 
[0m14:51:07.254848 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:51:07.255221 [info ] [Thread-1 (]: 1 of 2 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m14:51:07.255656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m14:51:07.255884 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:51:07.260757 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:07.262004 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 14:51:07.256014 => 14:51:07.261783
[0m14:51:07.262338 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:51:07.283914 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:07.285241 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:07.285494 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m14:51:07.285702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:07.289126 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:07.289364 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:07.289622 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m14:51:15.790121 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m14:51:15.794968 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:15.795252 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m14:51:15.795647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:15.806597 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:51:15.806983 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:15.807207 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m14:51:24.440277 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m14:51:24.444146 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m14:51:24.444499 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m14:51:24.444910 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.445854 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 14:51:07.262495 => 14:51:24.445722
[0m14:51:24.446091 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m14:51:24.743102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120bfde90>]}
[0m14:51:24.743676 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 17.49s]
[0m14:51:24.744054 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m14:51:24.744504 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:51:24.744768 [info ] [Thread-1 (]: 2 of 2 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m14:51:24.745560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m14:51:24.745797 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:51:24.747896 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.748515 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 14:51:24.745924 => 14:51:24.748375
[0m14:51:24.748755 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:51:24.761663 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.762304 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.762531 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m14:51:24.762731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:24.769397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.769745 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.770010 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m14:51:24.770675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.772728 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.772966 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m14:51:24.773277 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.774213 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:51:24.774441 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.774638 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m14:51:24.775202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.778467 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m14:51:24.778768 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m14:51:24.779109 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:51:24.779986 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 14:51:24.748893 => 14:51:24.779861
[0m14:51:24.780214 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m14:51:24.854073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'edd8c73c-16bc-404c-afd1-3638cf14f0cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120dffdd0>]}
[0m14:51:24.854594 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m14:51:24.854959 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m14:51:24.856115 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:24.856415 [debug] [MainThread]: On master: BEGIN
[0m14:51:24.856600 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:24.860763 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:51:24.861052 [debug] [MainThread]: On master: COMMIT
[0m14:51:24.861245 [debug] [MainThread]: Using duckdb connection "master"
[0m14:51:24.861416 [debug] [MainThread]: On master: COMMIT
[0m14:51:24.861623 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:51:24.861813 [debug] [MainThread]: On master: Close
[0m14:51:24.863393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:24.863607 [debug] [MainThread]: Connection 'model.climate_works_dbt.stg_daily_climate_parameters' was properly closed.
[0m14:51:24.863815 [info ] [MainThread]: 
[0m14:51:24.864021 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 17.68 seconds (17.68s).
[0m14:51:24.864631 [debug] [MainThread]: Command end result
[0m14:51:24.871320 [info ] [MainThread]: 
[0m14:51:24.871665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:24.871856 [info ] [MainThread]: 
[0m14:51:24.872050 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:51:24.873677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.10035, "process_user_time": 54.1832, "process_kernel_time": 2.750222, "process_mem_max_rss": "3808788480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:51:24.874095 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:24.874023 after 18.10 seconds
[0m14:51:24.874338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1206a6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101139350>]}
[0m14:51:24.874560 [debug] [MainThread]: Flushing usage events
[0m17:10:11.872994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e7fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea5110>]}


============================== 17:10:11.876012 | 42c84106-49b3-4493-bf38-a812cbff5947 ==============================
[0m17:10:11.876012 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:10:11.876440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:12.067081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6dd10>]}
[0m17:10:12.145867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b1710>]}
[0m17:10:12.147319 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:10:12.157427 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:10:12.180980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:12.181302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:12.181849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m17:10:12.185575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed9410>]}
[0m17:10:12.191417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113506c90>]}
[0m17:10:12.191735 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:10:12.191955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e54210>]}
[0m17:10:12.193047 [info ] [MainThread]: 
[0m17:10:12.193535 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:12.194436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m17:10:12.201412 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m17:10:12.201683 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m17:10:12.201882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:12.207469 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.208497 [debug] [ThreadPool]: On list_dev_database: Close
[0m17:10:12.210482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m17:10:12.211085 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m17:10:12.214382 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:10:12.214615 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m17:10:12.214787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:12.218507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.218755 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:10:12.218948 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m17:10:12.219197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.219758 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:10:12.219943 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:10:12.220109 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:10:12.220339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.220508 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m17:10:12.222794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m17:10:12.226271 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:10:12.226503 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m17:10:12.226675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:12.230421 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.230667 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:10:12.230861 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m17:10:12.243906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:12.247208 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m17:10:12.248305 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m17:10:12.248595 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m17:10:12.251018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6da50>]}
[0m17:10:12.251329 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:12.251513 [debug] [MainThread]: On master: BEGIN
[0m17:10:12.251684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:12.255100 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:12.255312 [debug] [MainThread]: On master: COMMIT
[0m17:10:12.255484 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:12.255644 [debug] [MainThread]: On master: COMMIT
[0m17:10:12.255838 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:12.256004 [debug] [MainThread]: On master: Close
[0m17:10:12.257401 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m17:10:12.257606 [info ] [MainThread]: 
[0m17:10:12.259393 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:10:12.259736 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m17:10:12.260178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m17:10:12.260405 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:10:12.265301 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:12.265916 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 17:10:12.260535 => 17:10:12.265766
[0m17:10:12.266154 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:10:12.286406 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:12.287027 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:12.287255 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m17:10:12.287474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:12.291580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:12.291840 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:12.292099 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m17:10:19.709828 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m17:10:19.727443 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:19.727812 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw" rename to "stg_daily_climate_parameters_vertical_raw__dbt_backup"
[0m17:10:19.728275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:19.730184 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:19.730444 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m17:10:19.730756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:19.743423 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:10:19.743774 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:19.743990 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:10:28.370111 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m17:10:28.373607 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:10:28.373862 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m17:10:28.382204 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.383638 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 17:10:12.266281 => 17:10:28.383372
[0m17:10:28.383970 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m17:10:28.681862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135333d0>]}
[0m17:10:28.682647 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 16.42s]
[0m17:10:28.683176 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:10:28.684117 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:10:28.684388 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m17:10:28.684812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m17:10:28.685037 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:10:28.687242 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.688380 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 17:10:28.685170 => 17:10:28.688241
[0m17:10:28.688665 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:10:28.700746 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.701406 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.701634 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m17:10:28.701871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:28.705971 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.706217 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.706465 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m17:10:28.707103 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.710460 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.710714 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters" rename to "stg_daily_climate_parameters__dbt_backup"
[0m17:10:28.711045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.712733 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.712950 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m17:10:28.713237 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.714279 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:10:28.714501 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.714692 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:10:28.715218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.717124 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:10:28.717369 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m17:10:28.717789 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.718665 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 17:10:28.688813 => 17:10:28.718536
[0m17:10:28.718890 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m17:10:28.794338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370ff90>]}
[0m17:10:28.794848 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m17:10:28.795402 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:10:28.796035 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:10:28.796465 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m17:10:28.796961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m17:10:28.797194 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:10:28.799185 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.800109 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 17:10:28.797325 => 17:10:28.799948
[0m17:10:28.800399 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:10:28.802983 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.803497 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.803712 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m17:10:28.803906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:28.808292 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.808602 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.808856 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m17:10:28.810264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.812367 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.812638 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m17:10:28.812997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.813938 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:10:28.814151 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.814345 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:10:28.814787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.816440 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:10:28.816702 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m17:10:28.817017 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.817913 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 17:10:28.800615 => 17:10:28.817785
[0m17:10:28.818144 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m17:10:28.894661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e1650>]}
[0m17:10:28.895237 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m17:10:28.895573 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:10:28.896194 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:10:28.896632 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m17:10:28.897116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m17:10:28.897389 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:10:28.899569 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:28.900922 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 17:10:28.897539 => 17:10:28.900785
[0m17:10:28.901144 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:10:28.903605 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:28.904101 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:28.904322 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m17:10:28.904519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:28.908784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:28.909077 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:28.909310 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m17:10:29.398316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.400416 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:29.400658 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m17:10:29.401026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.402086 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:10:29.402304 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:29.402499 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:10:29.404514 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.406237 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:10:29.406478 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m17:10:29.406817 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:10:29.407720 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 17:10:28.901273 => 17:10:29.407591
[0m17:10:29.408042 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m17:10:29.524501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c84106-49b3-4493-bf38-a812cbff5947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132f2cd0>]}
[0m17:10:29.525027 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.63s]
[0m17:10:29.525553 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:10:29.526801 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:29.527007 [debug] [MainThread]: On master: BEGIN
[0m17:10:29.527182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:29.531212 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:29.531433 [debug] [MainThread]: On master: COMMIT
[0m17:10:29.531608 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:29.531771 [debug] [MainThread]: On master: COMMIT
[0m17:10:29.531969 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:29.532144 [debug] [MainThread]: On master: Close
[0m17:10:29.534921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:29.535165 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m17:10:29.535417 [info ] [MainThread]: 
[0m17:10:29.535647 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 17.34 seconds (17.34s).
[0m17:10:29.536221 [debug] [MainThread]: Command end result
[0m17:10:29.586621 [info ] [MainThread]: 
[0m17:10:29.586999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:29.587284 [info ] [MainThread]: 
[0m17:10:29.587524 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:10:29.589109 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.76044, "process_user_time": 56.37947, "process_kernel_time": 3.409808, "process_mem_max_rss": "2910158848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:29.589474 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:29.589393 after 17.76 seconds
[0m17:10:29.589715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5a2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b24b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b32a90>]}
[0m17:10:29.589943 [debug] [MainThread]: Flushing usage events
[0m17:10:29.599207 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m17:43:53.027637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106137b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a8e50>]}


============================== 17:43:53.030924 | f1bb1e4e-560e-4432-8bac-574d147afebd ==============================
[0m17:43:53.030924 [info ] [MainThread]: Running with dbt=1.7.8
[0m17:43:53.031511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/staging+', 'send_anonymous_usage_stats': 'True'}
[0m17:43:53.240637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f1190>]}
[0m17:43:53.319462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589eb90>]}
[0m17:43:53.320965 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m17:43:53.332716 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m17:43:53.359849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:53.360171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:53.360709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m17:43:53.364245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a08d0>]}
[0m17:43:53.371123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669dd10>]}
[0m17:43:53.371467 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m17:43:53.371691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061cf890>]}
[0m17:43:53.373076 [info ] [MainThread]: 
[0m17:43:53.373625 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:53.374662 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m17:43:53.383018 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m17:43:53.383357 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m17:43:53.383568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:53.389135 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.390283 [debug] [ThreadPool]: On list_dev_database: Close
[0m17:43:53.392877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m17:43:53.393363 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m17:43:53.396664 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:43:53.396887 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m17:43:53.397064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:53.400563 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.400799 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:43:53.400980 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m17:43:53.401227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.401806 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:43:53.401991 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m17:43:53.402157 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m17:43:53.402371 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.402552 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m17:43:53.405135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m17:43:53.408673 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:43:53.408890 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m17:43:53.409055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:53.412216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.412426 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m17:43:53.412610 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m17:43:53.426160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:53.429533 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m17:43:53.430450 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m17:43:53.430642 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m17:43:53.432695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f36d0>]}
[0m17:43:53.432989 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:53.433168 [debug] [MainThread]: On master: BEGIN
[0m17:43:53.433332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:53.436884 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:53.437117 [debug] [MainThread]: On master: COMMIT
[0m17:43:53.437300 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:53.437466 [debug] [MainThread]: On master: COMMIT
[0m17:43:53.437666 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:53.437837 [debug] [MainThread]: On master: Close
[0m17:43:53.439276 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m17:43:53.439548 [info ] [MainThread]: 
[0m17:43:53.441373 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:43:53.441728 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m17:43:53.442166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m17:43:53.442393 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:43:53.447136 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:43:53.447996 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 17:43:53.442528 => 17:43:53.447769
[0m17:43:53.448289 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:43:53.467843 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:43:53.468496 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:43:53.468724 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m17:43:53.468927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:53.472406 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:53.472649 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:43:53.472907 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m17:44:02.912886 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m17:44:02.918161 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:44:02.918443 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m17:44:02.918839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:02.929529 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:44:02.929831 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:44:02.930049 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m17:44:11.455153 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m17:44:11.458621 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m17:44:11.458887 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m17:44:11.459255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.460212 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 17:43:53.448460 => 17:44:11.460068
[0m17:44:11.460464 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m17:44:11.725605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066eba90>]}
[0m17:44:11.726160 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 18.28s]
[0m17:44:11.726635 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m17:44:11.727261 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:44:11.727635 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m17:44:11.728140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m17:44:11.728362 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:44:11.730358 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.731016 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 17:44:11.728493 => 17:44:11.730866
[0m17:44:11.731249 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:44:11.743243 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.743805 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.744042 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m17:44:11.744248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:11.749618 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.749903 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.750162 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m17:44:11.750813 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.752789 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.753015 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m17:44:11.753312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.754230 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:44:11.754437 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.754629 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m17:44:11.755070 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.757561 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m17:44:11.757804 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m17:44:11.758085 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.758855 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 17:44:11.731383 => 17:44:11.758734
[0m17:44:11.759073 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m17:44:11.834467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a10310>]}
[0m17:44:11.834968 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m17:44:11.835468 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m17:44:11.836093 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:44:11.836549 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m17:44:11.837033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m17:44:11.837285 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:44:11.839288 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.840019 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 17:44:11.837424 => 17:44:11.839887
[0m17:44:11.840235 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:44:11.842795 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.843311 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.843534 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m17:44:11.843738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:11.847433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.847675 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.847921 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m17:44:11.849106 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.851097 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.851364 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m17:44:11.851726 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.852762 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:44:11.853025 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.853226 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m17:44:11.853681 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.855258 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m17:44:11.855487 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m17:44:11.855780 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.856562 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 17:44:11.840360 => 17:44:11.856444
[0m17:44:11.856775 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m17:44:11.930377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ffb10>]}
[0m17:44:11.930850 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.09s]
[0m17:44:11.931316 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m17:44:11.931946 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:44:11.932307 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m17:44:11.932813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m17:44:11.933108 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:44:11.935146 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:11.936073 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 17:44:11.933247 => 17:44:11.935902
[0m17:44:11.936341 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:44:11.938848 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:11.939288 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:11.939497 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m17:44:11.939690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:11.943499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:11.943758 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:11.943994 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m17:44:12.428191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:12.430348 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:12.430589 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m17:44:12.430957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:12.432004 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:44:12.432219 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:12.432415 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m17:44:12.433731 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:12.435274 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m17:44:12.435509 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m17:44:12.435800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:44:12.436610 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 17:44:11.936474 => 17:44:12.436485
[0m17:44:12.436854 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m17:44:12.542719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bb1e4e-560e-4432-8bac-574d147afebd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a05950>]}
[0m17:44:12.543214 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.61s]
[0m17:44:12.543773 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m17:44:12.544807 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:12.545052 [debug] [MainThread]: On master: BEGIN
[0m17:44:12.545233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:12.550231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:44:12.550472 [debug] [MainThread]: On master: COMMIT
[0m17:44:12.550653 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:12.550822 [debug] [MainThread]: On master: COMMIT
[0m17:44:12.551018 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:44:12.551187 [debug] [MainThread]: On master: Close
[0m17:44:12.552745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:12.553016 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m17:44:12.553252 [info ] [MainThread]: 
[0m17:44:12.553509 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 19.18 seconds (19.18s).
[0m17:44:12.554145 [debug] [MainThread]: Command end result
[0m17:44:12.559660 [info ] [MainThread]: 
[0m17:44:12.559937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:12.560192 [info ] [MainThread]: 
[0m17:44:12.560436 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:44:12.561743 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.579971, "process_user_time": 55.976246, "process_kernel_time": 3.922554, "process_mem_max_rss": "3816390656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:44:12.562144 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:12.562069 after 19.58 seconds
[0m17:44:12.562386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061aaa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1009f6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c2a10>]}
[0m17:44:12.562618 [debug] [MainThread]: Flushing usage events
[0m19:02:20.373732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e48390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ea1090>]}


============================== 19:02:20.376984 | f17417dd-1e2a-40da-9888-1460ef668180 ==============================
[0m19:02:20.376984 [info ] [MainThread]: Running with dbt=1.7.8
[0m19:02:20.377583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +int_daily_climate_params_pivoted+', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:20.590485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109154190>]}
[0m19:02:20.671447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840f8d0>]}
[0m19:02:20.672986 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m19:02:20.684572 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m19:02:20.713193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:20.713530 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:20.714193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m19:02:20.717811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ef850>]}
[0m19:02:20.725008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109294590>]}
[0m19:02:20.725337 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m19:02:20.725564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e19d0>]}
[0m19:02:20.726651 [info ] [MainThread]: 
[0m19:02:20.727139 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:02:20.727984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m19:02:20.735257 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m19:02:20.735555 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m19:02:20.735768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:20.742639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.744889 [debug] [ThreadPool]: On list_dev_database: Close
[0m19:02:20.746647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m19:02:20.747248 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m19:02:20.750507 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:02:20.750725 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m19:02:20.750900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:20.755003 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.755229 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:02:20.755418 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m19:02:20.756375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.757144 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m19:02:20.757367 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m19:02:20.757531 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m19:02:20.757754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.757926 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m19:02:20.760109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m19:02:20.763582 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m19:02:20.763863 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m19:02:20.764025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:20.767289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.767494 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m19:02:20.767678 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m19:02:20.783746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m19:02:20.787887 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m19:02:20.788828 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m19:02:20.789021 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m19:02:20.791358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091634d0>]}
[0m19:02:20.791710 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:20.791898 [debug] [MainThread]: On master: BEGIN
[0m19:02:20.792067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:02:20.795676 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:02:20.795898 [debug] [MainThread]: On master: COMMIT
[0m19:02:20.796075 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:20.796242 [debug] [MainThread]: On master: COMMIT
[0m19:02:20.796441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:02:20.796608 [debug] [MainThread]: On master: Close
[0m19:02:20.797971 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m19:02:20.798205 [info ] [MainThread]: 
[0m19:02:20.799978 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:02:20.800355 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m19:02:20.800829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m19:02:20.801080 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:02:20.805860 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:20.806972 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 19:02:20.801221 => 19:02:20.806751
[0m19:02:20.807257 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:02:20.826541 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:20.827483 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:20.827742 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m19:02:20.827949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:20.831535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:20.831807 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:20.832066 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m19:02:30.341269 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m19:02:30.347870 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:30.348190 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m19:02:30.349522 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:30.360134 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m19:02:30.360408 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:30.360627 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m19:02:39.143901 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m19:02:39.147417 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m19:02:39.147695 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m19:02:39.148307 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.149378 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 19:02:20.807394 => 19:02:39.149170
[0m19:02:39.149716 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m19:02:39.453029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109239fd0>]}
[0m19:02:39.453649 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 18.65s]
[0m19:02:39.454195 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m19:02:39.454907 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:02:39.455301 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m19:02:39.455840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m19:02:39.456085 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:02:39.458090 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.459871 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 19:02:39.456225 => 19:02:39.459738
[0m19:02:39.460098 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:02:39.473529 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.474322 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.474562 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m19:02:39.474807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:39.478727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.478986 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.479244 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m19:02:39.479886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.481877 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.482105 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m19:02:39.482425 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.483522 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m19:02:39.483781 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.484130 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m19:02:39.484704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.487719 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m19:02:39.488013 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m19:02:39.488336 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.489190 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 19:02:39.460242 => 19:02:39.489062
[0m19:02:39.489415 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m19:02:39.563590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096051d0>]}
[0m19:02:39.564079 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m19:02:39.564428 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m19:02:39.565031 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:02:39.565402 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m19:02:39.565823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m19:02:39.566033 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:02:39.567994 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.569011 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 19:02:39.566160 => 19:02:39.568837
[0m19:02:39.569270 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:02:39.571923 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.572712 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.572998 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m19:02:39.573321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:39.577254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.577536 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.577785 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m19:02:39.580528 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.582606 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.582858 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m19:02:39.583184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.584119 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m19:02:39.584327 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.584526 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m19:02:39.585034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.586933 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m19:02:39.587194 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m19:02:39.587498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.588306 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 19:02:39.569402 => 19:02:39.588178
[0m19:02:39.588527 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m19:02:39.660428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960dbd0>]}
[0m19:02:39.660966 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.09s]
[0m19:02:39.661310 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m19:02:39.661899 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:02:39.662287 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m19:02:39.662779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m19:02:39.663029 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:02:39.665004 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:39.666303 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 19:02:39.663164 => 19:02:39.666086
[0m19:02:39.666584 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:02:39.669233 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:39.669970 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:39.670241 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m19:02:39.670442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:39.674320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:39.674609 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:39.674845 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m19:02:40.186344 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m19:02:40.188453 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:40.188690 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m19:02:40.189059 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:40.190111 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m19:02:40.190320 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:40.190513 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m19:02:40.191722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:40.193431 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m19:02:40.193666 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m19:02:40.193984 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m19:02:40.194834 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 19:02:39.666781 => 19:02:40.194709
[0m19:02:40.195058 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m19:02:40.329518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f17417dd-1e2a-40da-9888-1460ef668180', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a850>]}
[0m19:02:40.330041 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.67s]
[0m19:02:40.330392 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m19:02:40.335845 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:40.336139 [debug] [MainThread]: On master: BEGIN
[0m19:02:40.336306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:02:40.340253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:02:40.340501 [debug] [MainThread]: On master: COMMIT
[0m19:02:40.340676 [debug] [MainThread]: Using duckdb connection "master"
[0m19:02:40.340837 [debug] [MainThread]: On master: COMMIT
[0m19:02:40.341032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m19:02:40.341202 [debug] [MainThread]: On master: Close
[0m19:02:40.344632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:40.344936 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m19:02:40.345341 [info ] [MainThread]: 
[0m19:02:40.345587 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 19.62 seconds (19.62s).
[0m19:02:40.346166 [debug] [MainThread]: Command end result
[0m19:02:40.355428 [info ] [MainThread]: 
[0m19:02:40.355804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:40.356031 [info ] [MainThread]: 
[0m19:02:40.356244 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:02:40.357548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.02863, "process_user_time": 56.711876, "process_kernel_time": 4.349759, "process_mem_max_rss": "3700490240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:02:40.357931 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:40.357858 after 20.03 seconds
[0m19:02:40.358179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a2e2d0>]}
[0m19:02:40.358402 [debug] [MainThread]: Flushing usage events
[0m16:12:16.061337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125639e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12569f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12569f5d0>]}


============================== 16:12:16.064783 | 316a4408-a8a5-4a1d-840c-34efc78061c6 ==============================
[0m16:12:16.064783 [info ] [MainThread]: Running with dbt=1.7.8
[0m16:12:16.065200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:16.352959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256dc050>]}
[0m16:12:16.431790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125956790>]}
[0m16:12:16.432697 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m16:12:17.027498 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m16:12:17.052684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:12:17.052995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:12:17.053533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m16:12:17.057166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12569da90>]}
[0m16:12:17.064582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125b2ae50>]}
[0m16:12:17.064912 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m16:12:17.065137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125611950>]}
[0m16:12:17.066331 [info ] [MainThread]: 
[0m16:12:17.066839 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:12:17.067872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m16:12:17.075461 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m16:12:17.075773 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m16:12:17.075979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:17.085930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.087500 [debug] [ThreadPool]: On list_dev_database: Close
[0m16:12:17.089745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m16:12:17.090223 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m16:12:17.093723 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:12:17.093966 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m16:12:17.094152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:17.097951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.098208 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:12:17.098390 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m16:12:17.098726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.099317 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:12:17.099563 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m16:12:17.099787 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m16:12:17.100047 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.100233 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m16:12:17.102577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m16:12:17.106045 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:12:17.106258 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m16:12:17.106421 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:17.109864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.110072 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m16:12:17.110261 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m16:12:17.124372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:12:17.128326 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m16:12:17.129248 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m16:12:17.129434 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m16:12:17.131614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256e9610>]}
[0m16:12:17.131908 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:17.132078 [debug] [MainThread]: On master: BEGIN
[0m16:12:17.132238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:12:17.135825 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:12:17.136043 [debug] [MainThread]: On master: COMMIT
[0m16:12:17.136214 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:17.136375 [debug] [MainThread]: On master: COMMIT
[0m16:12:17.136572 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:12:17.136740 [debug] [MainThread]: On master: Close
[0m16:12:17.138107 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m16:12:17.138346 [info ] [MainThread]: 
[0m16:12:17.143814 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_climate__stations
[0m16:12:17.144267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.int_climate__stations)
[0m16:12:17.144495 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_climate__stations
[0m16:12:17.148983 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_climate__stations"
[0m16:12:17.150589 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_climate__stations (compile): 16:12:17.144626 => 16:12:17.150398
[0m16:12:17.151219 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_climate__stations
[0m16:12:17.151484 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:12:17.151820 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m16:12:17.152212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_climate__stations, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m16:12:17.152424 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:12:17.154531 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:17.155305 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 16:12:17.152546 => 16:12:17.155136
[0m16:12:17.155565 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:12:17.175907 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:17.176729 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:17.176975 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m16:12:17.177191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:17.181212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:17.181526 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:17.181798 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m16:12:24.009198 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m16:12:24.014761 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:24.015030 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m16:12:24.015841 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:24.026336 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:12:24.026598 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:24.026812 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m16:12:32.635749 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m16:12:32.639239 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m16:12:32.639504 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m16:12:32.640131 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.641349 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 16:12:17.155708 => 16:12:32.641099
[0m16:12:32.641632 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m16:12:32.882196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125bb7b50>]}
[0m16:12:32.882956 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 15.73s]
[0m16:12:32.883384 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m16:12:32.884221 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:12:32.884702 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m16:12:32.885205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m16:12:32.885429 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:12:32.887704 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.888994 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 16:12:32.885565 => 16:12:32.888842
[0m16:12:32.889222 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:12:32.901257 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.902164 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.902414 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m16:12:32.902657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:32.907056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.907423 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.907700 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m16:12:32.908477 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.912125 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.912431 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m16:12:32.912836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.913822 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:12:32.914053 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.914249 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m16:12:32.915245 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.917019 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m16:12:32.917265 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m16:12:32.917598 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:32.918455 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 16:12:32.889354 => 16:12:32.918329
[0m16:12:32.918677 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m16:12:32.991749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125a3c210>]}
[0m16:12:32.992242 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m16:12:32.992607 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m16:12:32.993165 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:12:32.993567 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m16:12:32.994005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m16:12:32.994249 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:12:32.996383 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:32.997557 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 16:12:32.994383 => 16:12:32.997419
[0m16:12:32.997782 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:12:33.000304 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.001158 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.001484 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m16:12:33.001717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:33.005907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.006238 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.006505 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m16:12:33.008965 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.011248 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.011584 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m16:12:33.011962 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.012940 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:12:33.013169 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.013385 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m16:12:33.013885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.015589 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m16:12:33.015822 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m16:12:33.016166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.017022 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 16:12:32.997915 => 16:12:33.016891
[0m16:12:33.017247 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m16:12:33.089036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e357d0>]}
[0m16:12:33.089546 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m16:12:33.089903 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m16:12:33.090384 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:12:33.090692 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m16:12:33.091128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m16:12:33.091356 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:12:33.093319 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.094112 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 16:12:33.091489 => 16:12:33.093980
[0m16:12:33.094333 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:12:33.096644 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.097121 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.097338 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m16:12:33.097530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:33.101921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.102260 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.102497 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m16:12:33.508153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.510262 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.510509 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m16:12:33.510873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.511943 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m16:12:33.512163 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.512359 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m16:12:33.513448 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.514885 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m16:12:33.515097 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m16:12:33.515368 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:12:33.516145 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 16:12:33.094463 => 16:12:33.516019
[0m16:12:33.516362 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m16:12:33.638120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '316a4408-a8a5-4a1d-840c-34efc78061c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125c09910>]}
[0m16:12:33.638618 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.55s]
[0m16:12:33.638961 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m16:12:33.639952 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:33.640176 [debug] [MainThread]: On master: BEGIN
[0m16:12:33.640355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:33.644180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:12:33.644406 [debug] [MainThread]: On master: COMMIT
[0m16:12:33.644576 [debug] [MainThread]: Using duckdb connection "master"
[0m16:12:33.644736 [debug] [MainThread]: On master: COMMIT
[0m16:12:33.644926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:12:33.645099 [debug] [MainThread]: On master: Close
[0m16:12:33.648180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:33.648453 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m16:12:33.648730 [info ] [MainThread]: 
[0m16:12:33.648965 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 16.58 seconds (16.58s).
[0m16:12:33.649784 [debug] [MainThread]: Command end result
[0m16:12:33.660105 [info ] [MainThread]: 
[0m16:12:33.660447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:33.660654 [info ] [MainThread]: 
[0m16:12:33.660875 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:12:33.683256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.667854, "process_user_time": 56.04655, "process_kernel_time": 1.851578, "process_mem_max_rss": "2946826240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:33.683890 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:33.683802 after 17.67 seconds
[0m16:12:33.684185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046019d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104601890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104559ed0>]}
[0m16:12:33.684419 [debug] [MainThread]: Flushing usage events
[0m15:06:04.142076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a5110>]}


============================== 15:06:04.145971 | d876a1a9-a410-4d28-b6d0-34b3d656d20e ==============================
[0m15:06:04.145971 [info ] [MainThread]: Running with dbt=1.7.8
[0m15:06:04.146398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/raajassode/dev/climate_works_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/raajassode/dev/climate_works_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select +stg_daily_climate_parameters_vertical_raw+', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:05.031806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617b3d0>]}
[0m15:06:05.109845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061390d0>]}
[0m15:06:05.110664 [info ] [MainThread]: Registered adapter: duckdb=1.7.0
[0m15:06:05.139427 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m15:06:05.164958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:05.165265 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:05.165812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.climate_works_dbt.example
[0m15:06:05.169402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e8c10>]}
[0m15:06:05.178318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a06d0>]}
[0m15:06:05.178704 [info ] [MainThread]: Found 5 models, 2 seeds, 2 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m15:06:05.178962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106514a10>]}
[0m15:06:05.180170 [info ] [MainThread]: 
[0m15:06:05.180675 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:06:05.181460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_database'
[0m15:06:05.188906 [debug] [ThreadPool]: Using duckdb connection "list_dev_database"
[0m15:06:05.189250 [debug] [ThreadPool]: On list_dev_database: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev_database"'
    
  
  
[0m15:06:05.189463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:05.196559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.197836 [debug] [ThreadPool]: On list_dev_database: Close
[0m15:06:05.199739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_database, now create_dev_database_dev_sode)
[0m15:06:05.200206 [debug] [ThreadPool]: Creating schema "database: "dev_database"
schema: "dev_sode"
"
[0m15:06:05.203721 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:05.204060 [debug] [ThreadPool]: On create_dev_database_dev_sode: BEGIN
[0m15:06:05.204236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:05.207807 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.208043 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:05.208236 [debug] [ThreadPool]: On create_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "create_dev_database_dev_sode"} */
create schema if not exists "dev_database"."dev_sode"
[0m15:06:05.208565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.209155 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:06:05.209337 [debug] [ThreadPool]: Using duckdb connection "create_dev_database_dev_sode"
[0m15:06:05.209631 [debug] [ThreadPool]: On create_dev_database_dev_sode: COMMIT
[0m15:06:05.209973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.210182 [debug] [ThreadPool]: On create_dev_database_dev_sode: Close
[0m15:06:05.212480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_database_dev_sode, now list_dev_database_dev_sode)
[0m15:06:05.216787 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:06:05.217207 [debug] [ThreadPool]: On list_dev_database_dev_sode: BEGIN
[0m15:06:05.217415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:05.221804 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.222131 [debug] [ThreadPool]: Using duckdb connection "list_dev_database_dev_sode"
[0m15:06:05.222367 [debug] [ThreadPool]: On list_dev_database_dev_sode: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "connection_name": "list_dev_database_dev_sode"} */
select
      'dev_database' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'dev_sode'
    and table_catalog = 'dev_database'
  
[0m15:06:05.236772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:06:05.240451 [debug] [ThreadPool]: On list_dev_database_dev_sode: ROLLBACK
[0m15:06:05.241439 [debug] [ThreadPool]: Failed to rollback 'list_dev_database_dev_sode'
[0m15:06:05.241641 [debug] [ThreadPool]: On list_dev_database_dev_sode: Close
[0m15:06:05.243831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106375510>]}
[0m15:06:05.244124 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:05.244304 [debug] [MainThread]: On master: BEGIN
[0m15:06:05.244467 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:05.248324 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:05.248601 [debug] [MainThread]: On master: COMMIT
[0m15:06:05.248804 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:05.248985 [debug] [MainThread]: On master: COMMIT
[0m15:06:05.249189 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:05.249363 [debug] [MainThread]: On master: Close
[0m15:06:05.250747 [info ] [MainThread]: Concurrency: 1 threads (target='cw_dev')
[0m15:06:05.250992 [info ] [MainThread]: 
[0m15:06:05.252618 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:05.252922 [info ] [Thread-1 (]: 1 of 4 START sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [RUN]
[0m15:06:05.253341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_database_dev_sode, now model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw)
[0m15:06:05.253557 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:05.258448 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:05.259803 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (compile): 15:06:05.253699 => 15:06:05.259590
[0m15:06:05.260104 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:05.280601 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:05.281737 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:05.282034 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: BEGIN
[0m15:06:05.282255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:05.285845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:05.286099 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:05.286359 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp"
  
    as (
      
with source as (

    SELECT
    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2022"


    UNION ALL

    SELECT

    ID          ::varchar   as record_id,
    DATE        ::varchar   as reading_date,
    ELEMENT     ::varchar   as reading_type,
    DATA_VALUE  ::numeric   as reading_value,
    M_FLAG      ::varchar   as measurement_flag,
    Q_FLAG      ::varchar   as quality_flag,
    S_FLAG      ::varchar   as source_flag,
    OBS_TIME    ::varchar   as obs_recorded_at

    from "dev_database"."dev_sode"."noaa_ghcn_2023"
)

select * from source
    );
  
  
[0m15:06:14.490525 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m15:06:14.501130 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:14.501481 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
alter table "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_tmp" rename to "stg_daily_climate_parameters_vertical_raw"
[0m15:06:14.502061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:14.513479 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:06:14.513811 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:14.514034 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: COMMIT
[0m15:06:24.901340 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m15:06:24.909837 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"
[0m15:06:24.910207 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw"} */
drop table if exists "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw__dbt_backup" cascade
[0m15:06:24.910665 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:24.912689 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw (execute): 15:06:05.260244 => 15:06:24.912424
[0m15:06:24.913017 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw: Close
[0m15:06:25.221500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cf310>]}
[0m15:06:25.222384 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dev_sode.stg_daily_climate_parameters_vertical_raw  [[32mOK[0m in 19.97s]
[0m15:06:25.222953 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw
[0m15:06:25.223915 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:06:25.224653 [info ] [Thread-1 (]: 2 of 4 START sql view model dev_sode.stg_daily_climate_parameters .............. [RUN]
[0m15:06:25.225175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters_vertical_raw, now model.climate_works_dbt.stg_daily_climate_parameters)
[0m15:06:25.225403 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:06:25.227732 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.228394 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (compile): 15:06:25.225553 => 15:06:25.228215
[0m15:06:25.228642 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:06:25.241309 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.241959 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.242187 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: BEGIN
[0m15:06:25.242429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:25.246855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.247124 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.247379 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */

  
  create view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" as (
    with source as
    (

        select
            record_id ::varchar as record_id,
            array_slice(reading_date,1,4)::INTEGER as year,
            array_slice(reading_date, 5,6) ::INTEGER as month,
            array_slice(reading_date, 7,8) ::INTEGER as day,
            reading_type,
            reading_value,
            measurement_flag,
            quality_flag,
            source_flag,
            obs_recorded_at

    from "dev_database"."dev_sode"."stg_daily_climate_parameters_vertical_raw"

),

final as
(

  select
        record_id,
        make_date(year,month,day)::timestamp as reading_date,
        reading_type,
        reading_value,
        measurement_flag,
        quality_flag,
        source_flag,
        obs_recorded_at

     from source WHERE reading_type in ('PRCP','SNOW','SNWD','TMAX','TMIN') and quality_flag is null and measurement_flag != 'T'
)

select *
from final
  );

[0m15:06:25.248112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.250256 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.250498 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
alter view "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_tmp" rename to "stg_daily_climate_parameters"
[0m15:06:25.250825 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.251807 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:06:25.252024 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.252224 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: COMMIT
[0m15:06:25.252828 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.256203 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.stg_daily_climate_parameters"
[0m15:06:25.256546 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.stg_daily_climate_parameters"} */
drop view if exists "dev_database"."dev_sode"."stg_daily_climate_parameters__dbt_backup" cascade
[0m15:06:25.256924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.257860 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.stg_daily_climate_parameters (execute): 15:06:25.228788 => 15:06:25.257731
[0m15:06:25.258095 [debug] [Thread-1 (]: On model.climate_works_dbt.stg_daily_climate_parameters: Close
[0m15:06:25.332409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106806410>]}
[0m15:06:25.332913 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dev_sode.stg_daily_climate_parameters ......... [[32mOK[0m in 0.11s]
[0m15:06:25.333296 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.stg_daily_climate_parameters
[0m15:06:25.333948 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:06:25.335375 [info ] [Thread-1 (]: 3 of 4 START sql view model dev_sode.int_daily_climate_params_pivoted .......... [RUN]
[0m15:06:25.335866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.stg_daily_climate_parameters, now model.climate_works_dbt.int_daily_climate_params_pivoted)
[0m15:06:25.336258 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:06:25.338461 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.342437 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (compile): 15:06:25.336452 => 15:06:25.342246
[0m15:06:25.342959 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:06:25.345520 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.347144 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.347551 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: BEGIN
[0m15:06:25.347788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:25.351765 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.352031 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.352281 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */

  
  create view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" as (
    
with source as (

    SELECT
      record_id,
      reading_date,
      reading_type,
      reading_value,
      source_flag,
      measurement_flag


    from "dev_database"."dev_sode"."stg_daily_climate_parameters"
),

pivoted as (
  select 
    *

    from (
      PIVOT source on reading_type IN ('PRCP','SNOW','SNWD','TMAX','TMIN') using first(reading_value) group by reading_date, source_flag, measurement_flag
    )
)



select 
    
    reading_date,
    source_flag,
    measurement_flag,
    PRCP/10 ::DECIMAL as precipitation_mm,
    TMAX/10 ::DECIMAL as daily_max_temperature_celsius,
    TMIN/10 ::DECIMAL as daily_min_temperature_celsius,
    SNWD    ::DECIMAL as snow_depth_mm,
    SNOW    ::DECIMAL as snow_fall_mm

    
     from pivoted
  );

[0m15:06:25.353623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.355707 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.355964 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
alter view "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_tmp" rename to "int_daily_climate_params_pivoted"
[0m15:06:25.356291 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.357401 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:06:25.357712 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.357927 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: COMMIT
[0m15:06:25.358467 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.360129 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.int_daily_climate_params_pivoted"
[0m15:06:25.360368 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.int_daily_climate_params_pivoted"} */
drop view if exists "dev_database"."dev_sode"."int_daily_climate_params_pivoted__dbt_backup" cascade
[0m15:06:25.360672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.361559 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.int_daily_climate_params_pivoted (execute): 15:06:25.343115 => 15:06:25.361434
[0m15:06:25.361781 [debug] [Thread-1 (]: On model.climate_works_dbt.int_daily_climate_params_pivoted: Close
[0m15:06:25.435803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106805bd0>]}
[0m15:06:25.436307 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dev_sode.int_daily_climate_params_pivoted ..... [[32mOK[0m in 0.10s]
[0m15:06:25.436654 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.int_daily_climate_params_pivoted
[0m15:06:25.437259 [debug] [Thread-1 (]: Began running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:06:25.437713 [info ] [Thread-1 (]: 4 of 4 START sql table model dev_sode.fact_daily_climate_parameters ............ [RUN]
[0m15:06:25.438206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.climate_works_dbt.int_daily_climate_params_pivoted, now model.climate_works_dbt.fact_daily_climate_parameters)
[0m15:06:25.438443 [debug] [Thread-1 (]: Began compiling node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:06:25.440623 [debug] [Thread-1 (]: Writing injected SQL for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.441615 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (compile): 15:06:25.438597 => 15:06:25.441387
[0m15:06:25.441870 [debug] [Thread-1 (]: Began executing node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:06:25.444313 [debug] [Thread-1 (]: Writing runtime sql for node "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.444789 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.445003 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: BEGIN
[0m15:06:25.445197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:25.449193 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.449461 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.449694 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */

  
    
    

    create  table
      "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp"
  
    as (
      

with source as (
    select
    reading_date,
    source_flag,
    measurement_flag,
    precipitation_mm,
    daily_max_temperature_celsius,
    daily_min_temperature_celsius,
    snow_fall_mm,
    snow_depth_mm

    from "dev_database"."dev_sode"."int_daily_climate_params_pivoted"
    order by reading_date desc
)

select * from source
    );
  
  
[0m15:06:25.918849 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.921270 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.921541 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
alter table "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_tmp" rename to "fact_daily_climate_parameters"
[0m15:06:25.921926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.923170 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:06:25.923412 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.923617 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: COMMIT
[0m15:06:25.924567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.926097 [debug] [Thread-1 (]: Using duckdb connection "model.climate_works_dbt.fact_daily_climate_parameters"
[0m15:06:25.926327 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "climate_works_dbt", "target_name": "cw_dev", "node_id": "model.climate_works_dbt.fact_daily_climate_parameters"} */
drop table if exists "dev_database"."dev_sode"."fact_daily_climate_parameters__dbt_backup" cascade
[0m15:06:25.926608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:06:25.927439 [debug] [Thread-1 (]: Timing info for model.climate_works_dbt.fact_daily_climate_parameters (execute): 15:06:25.441998 => 15:06:25.927311
[0m15:06:25.927672 [debug] [Thread-1 (]: On model.climate_works_dbt.fact_daily_climate_parameters: Close
[0m15:06:26.052285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd876a1a9-a410-4d28-b6d0-34b3d656d20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106811710>]}
[0m15:06:26.052806 [info ] [Thread-1 (]: 4 of 4 OK created sql table model dev_sode.fact_daily_climate_parameters ....... [[32mOK[0m in 0.61s]
[0m15:06:26.053182 [debug] [Thread-1 (]: Finished running node model.climate_works_dbt.fact_daily_climate_parameters
[0m15:06:26.054426 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:26.054802 [debug] [MainThread]: On master: BEGIN
[0m15:06:26.055016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:26.058936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:26.059203 [debug] [MainThread]: On master: COMMIT
[0m15:06:26.059405 [debug] [MainThread]: Using duckdb connection "master"
[0m15:06:26.059587 [debug] [MainThread]: On master: COMMIT
[0m15:06:26.059791 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:06:26.059968 [debug] [MainThread]: On master: Close
[0m15:06:26.062176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:26.062442 [debug] [MainThread]: Connection 'model.climate_works_dbt.fact_daily_climate_parameters' was properly closed.
[0m15:06:26.062730 [info ] [MainThread]: 
[0m15:06:26.062995 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 20.88 seconds (20.88s).
[0m15:06:26.063612 [debug] [MainThread]: Command end result
[0m15:06:26.072095 [info ] [MainThread]: 
[0m15:06:26.072593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:26.072821 [info ] [MainThread]: 
[0m15:06:26.073071 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:06:26.096730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.004398, "process_user_time": 56.355347, "process_kernel_time": 2.692156, "process_mem_max_rss": "1875558400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:06:26.097309 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:26.097222 after 22.01 seconds
[0m15:06:26.097622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100812850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100812790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10069e2d0>]}
[0m15:06:26.097858 [debug] [MainThread]: Flushing usage events
